var starter=function(r){"use strict";var n=["Failure",-2],t=["Invalid_argument",-3],e=["Division_by_zero",-5],u=["Not_found",-6],a=["Match_failure",-7],i=["Assert_failure",-10];function c(r,n,t){for(var e=new Array(t),u=0,a=n;u<t;)e[u]=r[a],u=u+1|0,a=a+1|0;return e}function o(r,n,e){if(n<0||n>=r.length)throw[t,"index out of bounds"];return r[n]=e,0}function f(r,n){if(n<0||n>=r.length)throw[t,"index out of bounds"];return r[n]}function s(r,n){for(var t=new Array(r),e=0,u=r-1|0;e<=u;++e)t[e]=n;return t}function v(r,n){for(;;){var t=n,e=r,u=e.length,a=u||1,i=a-t.length|0;if(i){if(i<0){n=c(t,a,0|-i),r=e.apply(null,c(t,0,a));continue}return function(r,n){return function(t){return v(r,n.concat([t]))}}(e,t)}return e.apply(null,t)}}function l(r,n){var t=r.length;return 1===t?r(n):function(r,n,t){if(t>7||t<0)return v(r,[n]);switch(t){case 0:case 1:return r(n);case 2:return function(t){return r(n,t)};case 3:return function(t,e){return r(n,t,e)};case 4:return function(t,e,u){return r(n,t,e,u)};case 5:return function(t,e,u,a){return r(n,t,e,u,a)};case 6:return function(t,e,u,a,i){return r(n,t,e,u,a,i)};case 7:return function(t,e,u,a,i,c){return r(n,t,e,u,a,i,c)}}}(r,n,t)}function h(r,n,t){var e=r.length;return 2===e?r(n,t):function(r,n,t,e){if(e>7||e<0)return v(r,[n,t]);switch(e){case 0:case 1:return v(r(n),[t]);case 2:return r(n,t);case 3:return function(e){return r(n,t,e)};case 4:return function(e,u){return r(n,t,e,u)};case 5:return function(e,u,a){return r(n,t,e,u,a)};case 6:return function(e,u,a,i){return r(n,t,e,u,a,i)};case 7:return function(e,u,a,i,c){return r(n,t,e,u,a,i,c)}}}(r,n,t,e)}function g(r,n,t,e){var u=r.length;return 3===u?r(n,t,e):function(r,n,t,e,u){var a=0;if(u>7||u<0)return v(r,[n,t,e]);switch(u){case 0:case 1:a=1;break;case 2:return v(r(n,t),[e]);case 3:return r(n,t,e);case 4:return function(u){return r(n,t,e,u)};case 5:return function(u,a){return r(n,t,e,u,a)};case 6:return function(u,a,i){return r(n,t,e,u,a,i)};case 7:return function(u,a,i,c){return r(n,t,e,u,a,i,c)}}return 1===a?v(r(n),[t,e]):void 0}(r,n,t,e,u)}function m(r,n,t,e,u){var a=r.length;return 4===a?r(n,t,e,u):function(r,n,t,e,u,a){var i=0;if(a>7||a<0)return v(r,[n,t,e,u]);switch(a){case 0:case 1:i=1;break;case 2:return v(r(n,t),[e,u]);case 3:return v(r(n,t,e),[u]);case 4:return r(n,t,e,u);case 5:return function(a){return r(n,t,e,u,a)};case 6:return function(a,i){return r(n,t,e,u,a,i)};case 7:return function(a,i,c){return r(n,t,e,u,a,i,c)}}return 1===i?v(r(n),[t,e,u]):void 0}(r,n,t,e,u,a)}function b(r,n,t,e,u,a){var i=r.length;return 5===i?r(n,t,e,u,a):function(r,n,t,e,u,a,i){var c=0;if(i>7||i<0)return v(r,[n,t,e,u,a]);switch(i){case 0:case 1:c=1;break;case 2:return v(r(n,t),[e,u,a]);case 3:return v(r(n,t,e),[u,a]);case 4:return v(r(n,t,e,u),[a]);case 5:return r(n,t,e,u,a);case 6:return function(i){return r(n,t,e,u,a,i)};case 7:return function(i,c){return r(n,t,e,u,a,i,c)}}return 1===c?v(r(n),[t,e,u,a]):void 0}(r,n,t,e,u,a,i)}function w(r,n,t,e,u,a,i){var c=r.length;return 6===c?r(n,t,e,u,a,i):function(r,n,t,e,u,a,i,c){var o=0;if(c>7||c<0)return v(r,[n,t,e,u,a,i]);switch(c){case 0:case 1:o=1;break;case 2:return v(r(n,t),[e,u,a,i]);case 3:return v(r(n,t,e),[u,a,i]);case 4:return v(r(n,t,e,u),[a,i]);case 5:return v(r(n,t,e,u,a),[i]);case 6:return r(n,t,e,u,a,i);case 7:return function(c){return r(n,t,e,u,a,i,c)}}return 1===o?v(r(n),[t,e,u,a,i]):void 0}(r,n,t,e,u,a,i,c)}function p(r,n,t,e,u,a,i,c){var o=r.length;return 7===o?r(n,t,e,u,a,i,c):function(r,n,t,e,u,a,i,c,o){var f=0;if(o>7||o<0)return v(r,[n,t,e,u,a,i,c]);switch(o){case 0:case 1:f=1;break;case 2:return v(r(n,t),[e,u,a,i,c]);case 3:return v(r(n,t,e),[u,a,i,c]);case 4:return v(r(n,t,e,u),[a,i,c]);case 5:return v(r(n,t,e,u,a),[i,c]);case 6:return v(r(n,t,e,u,a,i),[c]);case 7:return r(n,t,e,u,a,i,c)}return 1===f?v(r(n),[t,e,u,a,i,c]):void 0}(r,n,t,e,u,a,i,c,o)}function d(r,n,t,e,u,a,i,c,o){var f=r.length;return 8===f?r(n,t,e,u,a,i,c,o):function(r,n,t,e,u,a,i,c,o,f){var s=0;if(f>7||f<0)return v(r,[n,t,e,u,a,i,c,o]);switch(f){case 0:case 1:s=1;break;case 2:return v(r(n,t),[e,u,a,i,c,o]);case 3:return v(r(n,t,e),[u,a,i,c,o]);case 4:return v(r(n,t,e,u),[a,i,c,o]);case 5:return v(r(n,t,e,u,a),[i,c,o]);case 6:return v(r(n,t,e,u,a,i),[c,o]);case 7:return v(r(n,t,e,u,a,i,c),[o])}return 1===s?v(r(n),[t,e,u,a,i,c,o]):void 0}(r,n,t,e,u,a,i,c,o,f)}function y(r,n){return n.tag=r,n}function k(r,n){return r<n?-1:r===n?0:1}function _(r,n){for(;;){var e=n,u=r;if(u===e)return 0;var a=typeof u,i=typeof e;if("string"===a){return u<e?-1:u===e?0:1}var c=+("number"===i);if(0!==+("number"===a))return 0!==c?k(u,e):-1;if(0!==c)return 1;if("boolean"===a||"undefined"===a||null===u){return u===e?0:u<e?-1:1}if("function"===a||"function"===i)throw[t,"compare: functional value"];var o=0|u.tag,f=0|e.tag;if(250!==o)if(250!==f){if(248===o)return k(u[1],e[1]);if(251===o)throw[t,"equal: abstract value"];if(o!==f)return o<f?-1:1;var s=0|u.length,v=0|e.length;if(s===v)for(var l=u,h=e,g=0,m=s;;){var b=g;if(b===m)return 0;var w=_(l[b],h[b]);if(0!==w)return w;g=b+1|0}else if(s<v)for(var p=u,d=e,y=0,C=s;;){var N=y;if(N===C)return-1;var A=_(p[N],d[N]);if(0!==A)return A;y=N+1|0}else for(var S=u,F=e,x=0,M=v;;){var O=x;if(O===M)return 1;var T=_(S[O],F[O]);if(0!==T)return T;x=O+1|0}}else n=e[0];else r=u[0]}}function C(r,n){for(;;){var e=n,u=r;if(u===e)return 1;var a=typeof u;if("string"===a||"number"===a||"boolean"===a||"undefined"===a||null===u)return 0;var i=typeof e;if("function"===a||"function"===i)throw[t,"equal: functional value"];if("number"===i||"undefined"===i||null===e)return 0;var c=0|u.tag,o=0|e.tag;if(250!==c)if(250!==o){if(248===c)return+(u[1]===e[1]);if(251===c)throw[t,"equal: abstract value"];if(c!==o)return 0;var f=0|u.length;if(f!==(0|e.length))return 0;for(var s=u,v=e,l=0,h=f;;){var g=l;if(g===h)return 1;if(!C(s[g],v[g]))return 0;l=g+1|0}}else n=e[0];else r=u[0]}}function N(r,n){return 1-C(r,n)}function A(r,n){return+(_(r,n)<=0)}function S(){return[(4294967295^(0|Date.now()))*Math.random()|0]}n.tag=248,t.tag=248,e.tag=248,u.tag=248,a.tag=248,i.tag=248;var F=Math.imul||function(r,n){return((r>>16)*(n|=0)<<16)+(65535&r)*n|0},x=String.prototype.repeat&&function(r,n){return n.repeat(r)}||function(r,n){if(0==n.length||0==r)return"";if(n.length*r>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var t="";1==(1&r)&&(t+=n),0!=(r>>>=1);)n+=n;return t},M=[-2147483648,0],O=[134217727,1],T=[0,1],I=[0,0],q=[-1,4294967295];function D(r){return+(0!=(2147483648&r))}function E(r,n){var t=n[1],e=r[1],u=e+t&4294967295,a=D(e)&&(D(t)||!D(u))||D(t)&&!D(u)?1:0;return[r[0]+n[0]+a&4294967295,u>>>0]}function L(r,n){return r[0]===n[0]?+(r[1]===n[1]):0}function P(r){return L(r,M)?M:E([-1^(n=r)[0],(-1^n[1])>>>0],T);var n}function R(r,n){return E(r,P(n))}function U(r,n){if(n){var t=r[1];return n>=32?[t<<(n-32|0),0]:[t>>>(32-n|0)|r[0]<<n,t<<n>>>0]}return r}function B(r,n){if(n){var t=r[0];return n<32?[t>>n,(t<<(32-n|0)|r[1]>>>n)>>>0]:[t>=0?0:-1,t>>(n-32|0)>>>0]}return r}function V(r,n){for(;;){var t,e=n,u=r,a=0,i=u[0],c=0,o=0,f=0;if(0!==i)f=4;else{if(0===u[1])return I;f=4}if(4===f)if(0!==e[0])o=3;else{if(0===e[1])return I;o=3}if(3===o&&(-2147483648!==i?c=2:0!==u[1]?c=2:(t=e[1],a=1)),2===c){var s=e[0],v=u[1],l=0;if(-2147483648!==s?l=3:0!==e[1]?l=3:(t=v,a=1),3===l){var h=e[1];if(i<0){if(s<0){n=P(e),r=P(u);continue}return P(V(P(u),e))}if(s<0)return P(V(u,P(e)));var g=65535&i,m=v>>>16,b=65535&v,w=65535&s,p=h>>>16,d=65535&h,y=0,k=0,_=0,C=b*d;return y=(k=(k=(_=(C>>>16)+m*d)>>>16)+((_=(65535&_)+b*p)>>>16)+g*d)>>>16,y+=(k=(65535&k)+m*p)>>>16,y+=(k=(65535&k)+b*w)>>>16,[(k&=65535)|(y=y+((i>>>16)*d+g*p+m*w+b*(s>>>16))&65535)<<16,(65535&C|(65535&_)<<16)>>>0]}}if(1===a)return 0==(1&t)?I:M}}function X(r,n){var t=n[0],e=r[0];return e>t?1:e<t?0:+(r[1]>=n[1])}function G(r,n){return 1-L(r,n)}function K(r,n){return 1-X(r,n)}function j(r,n){return r[0]>n[0]?1:r[0]<n[0]?0:+(r[1]>n[1])}function J(r){return 4294967296*r[0]+r[1]}var Z=Math.pow(2,32),z=Math.pow(2,63),H=-Math.pow(2,63);function W(r){return isNaN(r)||!isFinite(r)?I:r<=H?M:r+1>=z?O:r<0?P(W(-r)):[r/Z|0,(r%Z|0)>>>0]}function Y(r,n){for(;;){var t=n,u=r,a=u[0],i=0,c=0;if(0!==t[0])c=2;else{if(0===t[1])throw e;c=2}if(2===c)if(-2147483648!==a)if(0!==a)i=1;else{if(0===u[1])return I;i=1}else if(0!==u[1])i=1;else{if(L(t,T)||L(t,q))return u;if(L(t,M))return T;var o=t[0],f=U(Y(B(u,1),t),1),s=0;if(0!==f[0])s=3;else{if(0===f[1])return o<0?T:P(T);s=3}if(3===s)return E(f,Y(E(u,P(V(t,f))),t))}if(1===i){var v=t[0],l=0;if(-2147483648!==v)l=2;else{if(0===t[1])return I;l=2}if(2===l){if(a<0){if(v<0){n=P(t),r=P(u);continue}return P(Y(P(u),t))}if(v<0)return P(Y(u,P(t)));for(var h=I,g=u;X(g,t);){for(var m=Math.max(1,Math.floor(J(g)/J(t))),b=Math.ceil(Math.log(m)/Math.LN2),w=b<=48?1:Math.pow(2,b-48),p=W(m),d=V(p,t);d[0]<0||j(d,g);)d=V(p=W(m-=w),t);0===(y=p)[0]&&0===y[1]&&(p=T),h=E(h,p),g=E(g,P(d))}return h}}}var y}function Q(r,n){var t=Y(r,n);return[t,E(r,P(V(t,n)))]}function $(r){return[r<0?-1:0,r>>>0]}function rr(r){return[2147483647&r[0],r[1]]}function nr(r){return r>=65?r>=97?r>=123?-1:r-87|0:r>=91?-1:r-55|0:r>57||r<48?-1:r-48|0}function tr(r){var t=function(r){var n=1,t=2,e=0;"-"===r[e]&&(n=-1,e=e+1|0);var u=r.charCodeAt(e),a=r.charCodeAt(e+1|0);return 48===u&&(a>=89?98!==a?111!==a?120===a&&(t=1,e=e+2|0):(t=0,e=e+2|0):(t=3,e=e+2|0):66!==a?79!==a?a>=88&&(t=1,e=e+2|0):(t=0,e=e+2|0):(t=3,e=e+2|0)),[e,n,t]}(r),e=t[0],u=function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10;case 3:return 2}}(t[2]),a=r.length,i=nr(e<a?r.charCodeAt(e):0);if(i<0||i>=u)throw[n,"int_of_string"];var c=t[1]*function(t,e){for(;;){var i=e,c=t;if(i===a)return c;var o=r.charCodeAt(i);if(95!==o){var f=nr(o);if(f<0||f>=u)throw[n,"int_of_string"];var s=u*c+f;if(s>4294967295)throw[n,"int_of_string"];e=i+1|0,t=s}else e=i+1|0}}(i,e+1|0),o=0|c;if(10===u&&c!==o)throw[n,"int_of_string"];return o}function er(r){var n=r.length;if(n>31)throw[t,"format_int: format too long"];for(var e,u=["+","-"," ",0,2,0,0,0,1,-1,"f"],a=0;;){var i=a;if(i>=n)return u;var c=r.charCodeAt(i),o=0;if(c>=69)if(c>=88)if(c>=121)o=1;else switch(c-88|0){case 0:u[4]=1,u[7]=1,a=i+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:u[4]=0,a=i+1|0;continue;case 29:u[4]=2,a=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:u[4]=1,a=i+1|0;continue}else{if(!(c>=72)){u[5]=1,u[7]=1,u[10]=String.fromCharCode((e=c)>=65&&e<=90||e>=192&&e<=214||e>=216&&e<=222?e+32|0:e),a=i+1|0;continue}o=1}else{var f=c-32|0;if(f>25||f<0)o=1;else switch(f){case 3:u[3]=1,a=i+1|0;continue;case 0:case 11:o=2;break;case 13:u[0]="-",a=i+1|0;continue;case 14:u[9]=0;for(var s=i+1|0;function(n){return function(){var t=r.charCodeAt(n)-48|0;return+(t>=0&&t<=9)}}(s)();)u[9]=(F(u[9],10)+r.charCodeAt(s)|0)-48|0,s=s+1|0;a=s;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 15:o=1;break;case 16:u[2]="0",a=i+1|0;continue;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:o=3}}switch(o){case 1:a=i+1|0;continue;case 2:u[1]=String.fromCharCode(c),a=i+1|0;continue;case 3:u[6]=0;for(var v=i;function(n){return function(){var t=r.charCodeAt(n)-48|0;return+(t>=0&&t<=9)}}(v)();)u[6]=(F(u[6],10)+r.charCodeAt(v)|0)-48|0,v=v+1|0;a=v;continue;case 4:u[5]=1,u[4]=2,a=i+1|0;continue;case 5:u[5]=1,u[10]=String.fromCharCode(c),a=i+1|0;continue}}}function ur(r,n){var t=r[0],e=r[1],u=r[2],a=r[3],i=r[4],c=r[5],o=r[6],f=r[7],s=r[8],v=n.length;c&&(s<0||"-"!==e)&&(v=v+1|0),a&&(i?1===i&&(v=v+2|0):v=v+1|0);var l="";if("+"===t&&" "===u)for(var h=v,g=o-1|0;h<=g;++h)l+=u;if(c&&(s<0?l+="-":"-"!==e&&(l+=e)),a&&0===i&&(l+="0"),a&&1===i&&(l+="0x"),"+"===t&&"0"===u)for(var m=v,b=o-1|0;m<=b;++m)l+=u;if(l=f?l+n.toUpperCase():l+n,"-"===t)for(var w=v,p=o-1|0;w<=p;++w)l+=" ";return l}function ar(r,n){if("%d"===r)return String(n);var t=er(r),e=n,u=(e<0?t[5]?(t[8]=-1,-e):e>>>0:e).toString(function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10}}(t[4]));if(t[9]>=0){t[2]=" ";var a=t[9]-u.length|0;a>0&&(u=x(a,"0")+u)}return ur(t,u)}function ir(r,n){var t=er(r),e=t[5]&&K(n,[0,0])?(t[8]=-1,P(n)):n,u="";switch(t[4]){case 0:var a=[0,8],i="01234567";if(K(e,[0,0])){var c=Q(rr(e),a),o=E([268435456,0],c[0]),f=c[1];for(u=String.fromCharCode(i.charCodeAt(0|f[1]))+u;G(o,[0,0]);){var s=Q(o,a);o=s[0],f=s[1],u=String.fromCharCode(i.charCodeAt(0|f[1]))+u}}else{var v=Q(e,a),l=v[0],h=v[1];for(u=String.fromCharCode(i.charCodeAt(0|h[1]))+u;G(l,[0,0]);){var g=Q(l,a);l=g[0],h=g[1],u=String.fromCharCode(i.charCodeAt(0|h[1]))+u}}break;case 1:u=function(r){var n=function(r){return(r>>>0).toString(16)},t=r[0],e=r[1],u=0;if(0!==t)u=1;else{if(0===e)return"0";u=1}if(1===u){if(0!==e){if(0!==t){var a=n(r[1]),i=8-a.length|0;return i<=0?n(r[0])+a:n(r[0])+(x(i,"0")+a)}return n(r[1])}return n(r[0])+"00000000"}}(e)+u;break;case 2:var m=[0,10],b="0123456789";if(K(e,[0,0])){var w=Q(rr(e),m),p=Q(E([0,8],w[1]),m),d=E(E([214748364,3435973836],w[0]),p[0]),y=p[1];for(u=String.fromCharCode(b.charCodeAt(0|y[1]))+u;G(d,[0,0]);){var k=Q(d,m);d=k[0],y=k[1],u=String.fromCharCode(b.charCodeAt(0|y[1]))+u}}else{var _=Q(e,m),C=_[0],N=_[1];for(u=String.fromCharCode(b.charCodeAt(0|N[1]))+u;G(C,[0,0]);){var A=Q(C,m);C=A[0],N=A[1],u=String.fromCharCode(b.charCodeAt(0|N[1]))+u}}}if(t[9]>=0){t[2]=" ";var S=t[9]-u.length|0;S>0&&(u=x(S,"0")+u)}return ur(t,u)}var cr=ar,or=ar;function fr(r){if(r<0)throw[t,"String.create"];return new Array(r)}function sr(r,n){return r===n?0:r<n?-1:1}function vr(r,n,t,e,u){if(u>0){var a=r.length-n|0;if(u<=a){for(var i=0,c=u-1|0;i<=c;++i)t[e+i|0]=r.charCodeAt(n+i|0);return 0}for(var o=0,f=a-1|0;o<=f;++o)t[e+o|0]=r.charCodeAt(n+o|0);for(var s=a,v=u-1|0;s<=v;++s)t[e+s|0]=0;return 0}return 0}function lr(r,n,t,e,u){if(u>0){if(r===t){var a=r,i=n,c=e,o=u;if(i<c){for(var f=(a.length-c|0)-1|0,s=o-1|0,v=f>s?s:f;v>=0;--v)a[c+v|0]=a[i+v|0];return 0}if(i>c){for(var l=(a.length-i|0)-1|0,h=o-1|0,g=l>h?h:l,m=0;m<=g;++m)a[c+m|0]=a[i+m|0];return 0}return 0}var b=r.length-n|0;if(u<=b){for(var w=0,p=u-1|0;w<=p;++w)t[e+w|0]=r[n+w|0];return 0}for(var d=0,y=b-1|0;d<=y;++d)t[e+d|0]=r[n+d|0];for(var k=b,_=u-1|0;k<=_;++k)t[e+k|0]=0;return 0}return 0}function hr(r){for(var n=r.length,t=new Array(n),e=0,u=n-1|0;e<=u;++e)t[e]=r.charCodeAt(e);return t}function gr(r){var n=r,t=r.length,e="",u=t;if(t<=4096&&t===n.length)return String.fromCharCode.apply(null,n);for(var a=0;u>0;){var i=u<1024?u:1024,c=new Array(i);lr(n,a,c,0,i),e+=String.fromCharCode.apply(null,c),u=u-i|0,a=a+i|0}return e}function mr(r,n){if(n<0||n>=r.length)throw[t,"index out of bounds"];return r.charCodeAt(n)}var br=[0];function wr(r){var n=[r,(br[0]+=1,br[0])];return n.tag=248,n}var pr=function(r){throw new Error(r)};function dr(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return y(0,[dr(r[0])]);case 1:return y(1,[dr(r[0])]);case 2:return y(2,[dr(r[0])]);case 3:return y(3,[dr(r[0])]);case 4:return y(4,[dr(r[0])]);case 5:return y(5,[dr(r[0])]);case 6:return y(6,[dr(r[0])]);case 7:return y(7,[dr(r[0])]);case 8:return y(8,[r[0],dr(r[1])]);case 9:var n=r[0];return y(9,[n,n,dr(r[2])]);case 10:return y(10,[dr(r[0])]);case 11:return y(11,[dr(r[0])]);case 12:return y(12,[dr(r[0])]);case 13:return y(13,[dr(r[0])]);case 14:return y(14,[dr(r[0])])}}function yr(r,n){if("number"==typeof r)return n;switch(0|r.tag){case 0:return y(0,[yr(r[0],n)]);case 1:return y(1,[yr(r[0],n)]);case 2:return y(2,[r[0],yr(r[1],n)]);case 3:return y(3,[r[0],yr(r[1],n)]);case 4:return y(4,[r[0],r[1],r[2],yr(r[3],n)]);case 5:return y(5,[r[0],r[1],r[2],yr(r[3],n)]);case 6:return y(6,[r[0],r[1],r[2],yr(r[3],n)]);case 7:return y(7,[r[0],r[1],r[2],yr(r[3],n)]);case 8:return y(8,[r[0],r[1],r[2],yr(r[3],n)]);case 9:return y(9,[yr(r[0],n)]);case 10:return y(10,[yr(r[0],n)]);case 11:return y(11,[r[0],yr(r[1],n)]);case 12:return y(12,[r[0],yr(r[1],n)]);case 13:return y(13,[r[0],r[1],yr(r[2],n)]);case 14:return y(14,[r[0],r[1],yr(r[2],n)]);case 15:return y(15,[yr(r[0],n)]);case 16:return y(16,[yr(r[0],n)]);case 17:return y(17,[r[0],yr(r[1],n)]);case 18:return y(18,[r[0],yr(r[1],n)]);case 19:return y(19,[yr(r[0],n)]);case 20:return y(20,[r[0],r[1],yr(r[2],n)]);case 21:return y(21,[r[0],yr(r[1],n)]);case 22:return y(22,[yr(r[0],n)]);case 23:return y(23,[r[0],yr(r[1],n)]);case 24:return y(24,[r[0],r[1],yr(r[2],n)])}}wr("Pervasives.Exit");function kr(r,n){return+(_(r,n)>=0)?r:n}function _r(r){return r>=0?r:0|-r}function Cr(r){return""+r}function Nr(r,n){return r?[r[0],Nr(r[1],n)]:n}function Ar(r){for(var n=0,t=r;;){var e=t,u=n;if(!e)return u;t=e[1],n=u+1|0}}function Sr(r,n){for(;;){var t=n,e=r;if(!e)return t;n=[e[0],t],r=e[1]}}function Fr(r){return Sr(r,0)}function xr(r,n){return n?[l(r,n[0]),xr(r,n[1])]:0}function Mr(r,n){return function r(n,t,e){return e?[h(t,n,e[0]),r(n+1|0,t,e[1])]:0}(0,r,n)}function Or(r,n){for(;;){var t=n;if(!t)return 0;l(r,t[0]),n=t[1]}}function Tr(r,n,t){for(;;){var e=t,u=n;if(!e)return u;t=e[1],n=h(r,u,e[0])}}function Ir(r,n){for(;;){var t=n;if(t){if(_(t[0],r)){n=t[1];continue}return 1}return 0}}function qr(r,n){for(;;){var t=n;if(t){var e=t[0];if(_(e[0],r)){n=t[1];continue}return e[1]}throw u}}var Dr=function(r){return function(n){for(var t=0,e=n;;){var u=e,a=t;if(!u)return Sr(a,0);var i=u[1],c=u[0];l(r,c)?(e=i,t=[c,a]):e=i}}};function Er(r,n){var t=fr(r);return function(r,n,t,e){if(t>0){for(var u=n,a=(t+n|0)-1|0;u<=a;++u)r[u]=e;return 0}}(t,0,r,n),t}function Lr(r,n,e){return gr(function(r,n,e){if(n<0||e<0||n>(r.length-e|0))throw[t,"String.sub / Bytes.sub"];var u=fr(e);return lr(r,n,u,0,e),u}(r,n,e))}function Pr(r,n,e,u,a){if(a<0||n<0||n>(r.length-a|0)||u<0||u>(e.length-a|0))throw[t,"Bytes.blit"];return lr(r,n,e,u,a)}function Rr(r,n,e,u,a){if(a<0||n<0||n>(r.length-a|0)||u<0||u>(e.length-a|0))throw[t,"String.blit / Bytes.blit_string"];return vr(r,n,e,u,a)}function Ur(r){for(var n=0,t=0,e=r.length-1|0;t<=e;++t){var u,a=r[t];if(a>=32){var i=a-34|0;u=i>58||i<0?i>=93?4:1:i>57||i<1?2:1}else u=a>=11?13!==a?4:2:a>=8?2:4;n=n+u|0}if(n===r.length)return o=(c=r).length,f=fr(o),lr(c,0,f,0,o),f;var c,o,f,s=fr(n);n=0;for(var v=0,l=r.length-1|0;v<=l;++v){var h=r[v],g=0;if(h>=35)92!==h?h>=127?g=1:s[n]=h:g=2;else if(h>=32)h>=34?g=2:s[n]=h;else if(h>=14)g=1;else switch(h){case 8:s[n]=92,s[n=n+1|0]=98;break;case 9:s[n]=92,s[n=n+1|0]=116;break;case 10:s[n]=92,s[n=n+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:g=1;break;case 13:s[n]=92,s[n=n+1|0]=114}switch(g){case 1:s[n]=92,s[n=n+1|0]=48+(h/100|0)|0,s[n=n+1|0]=48+(h/10|0)%10|0,s[n=n+1|0]=48+h%10|0;break;case 2:s[n]=92,s[n=n+1|0]=h}n=n+1|0}return s}function Br(r,n,e){var a=r.length;if(n<0||n>a)throw[t,"String.contains_from / Bytes.contains_from"];try{return function(r,n,t,e){for(;;){var a=t;if(a>=n)throw u;if(r[a]===e)return a;t=a+1|0}}(r,a,n,e),1}catch(r){if(r===u)return 0;throw r}}function Vr(r,n){if(n){var t=n[0],e=[0],u=[0];Or(function(r){return e[0]=e[0]+1|0,u[0]=u[0]+r.length|0,0},n);var a=fr(u[0]+F(r.length,e[0]-1|0)|0);vr(t,0,a,0,t.length);var i=[t.length];return Or(function(n){return vr(r,0,a,i[0],r.length),i[0]=i[0]+r.length|0,vr(n,0,a,i[0],n.length),i[0]=i[0]+n.length|0,0},n[1]),gr(a)}return""}function Xr(r,n){return function(r,n){for(var t=0,e=n.length-1|0;t<=e;++t)l(r,n[t]);return 0}(r,hr(n))}function Gr(r,n){return Br(hr(r),0,n)}var Kr=Rr;function jr(r){var n=r<1?1:r,t=fr(n);return[t,0,n,t]}function Jr(r){return Lr(r[0],0,r[1])}function Zr(r,n){for(var t=r[2];(r[1]+n|0)>t;)t<<=1;var e=fr(t);return Pr(r[0],0,e,0,r[1]),r[0]=e,r[2]=t,0}function zr(r,n){var t=r[1];return t>=r[2]&&Zr(r,1),r[0][t]=n,r[1]=t+1|0,0}function Hr(r,n){var t=n.length,e=r[1]+t|0;return e>r[2]&&Zr(r,t),Rr(n,0,r[0],r[1],t),r[1]=e,0}var Wr=250,Yr=wr("CamlinternalLazy.Undefined");function Qr(){throw Yr}function $r(r){var n=r[0];r[0]=Qr;try{var t=l(n,0);return r[0]=t,r.tag=Wr,t}catch(n){throw r[0]=function(){throw n},n}}var rn=wr("Stream.Failure");wr("Stream.Error");function nn(r){return r[2]=function(r,n,e,u){if(e<0||u<0||e>(n.length-u|0))throw[t,"input"];return pr("caml_ml_input not implemented by bucklescript yet\n")}(r[0],r[1],0,r[1].length),r[3]=0,0}function tn(r,n){for(;;){var t=n;if("number"==typeof t)return t;switch(0|t.tag){case 0:return t;case 1:var e=t[1],u=tn(r,t[0]);if("number"==typeof u){n=e;continue}if(u.tag)throw[i,["stream.ml",53,12]];return y(0,[u[0],y(1,[u[1],e])]);case 2:var a=t[0],c=0|a.tag;n=250===c?a[0]:246===c?$r(a):a;continue;case 3:var o=t[0],f=o[0];if(f){var s=f[0];return s?(o[0]=0,y(0,[s[0],t])):0}var v=l(o[1],r);return v?y(0,[v[0],t]):(o[0]=[0],0);case 4:var h=t[0];if(h[3]>=h[2]&&nn(h),h[2]){var g=h[1][h[3]];return h[3]=h[3]+1|0,y(0,[g,t])}return 0}}}function en(r){for(;;){var n=r[1];if("number"==typeof n)return 0;switch(0|n.tag){case 0:return[n[0]];case 1:var t=tn(r[0],r[1]);if("number"==typeof t)return 0;if(t.tag)throw[i,["stream.ml",82,12]];return r[1]=t,[t[0]];case 2:var e=n[0],u=0|e.tag;r[1]=250===u?e[0]:246===u?$r(e):e;continue;case 3:var a=n[0],c=a[0];if(c)return c[0];var o=l(a[1],r[0]);return a[0]=[o],o;case 4:var f=n[0];return f[3]>=f[2]&&nn(f),f[2]?[f[1][f[3]]]:(r[1]=0,0)}}}function un(r){var n=en(r);if(n)return function(r){for(;;){var n=r[1],t=0;if("number"==typeof n)t=1;else switch(0|n.tag){case 0:return r[0]=r[0]+1|0,r[1]=n[1],0;case 3:var e=n[0];if(e[0])return r[0]=r[0]+1|0,e[0]=0,0;t=1;break;case 4:var u=n[0];return r[0]=r[0]+1|0,u[3]=u[3]+1|0,0;default:t=1}if(1===t){if(en(r))continue;return 0}}}(r),n[0];throw rn}function an(r){var n=[0];return[0,y(3,[[0,function(){var t=n[0];return t<r.length?(n[0]=n[0]+1|0,[mr(r,t)]):0}]])]}function cn(r){var n=function(r){try{return[un(r),y(246,[function(){return n(r)}])]}catch(r){if(r===rn)return 0;throw r}};return n(r)}var on=[cn,function(r){var n=function(r){var t=l(r,0);return t?[t[0],y(246,[function(){return n(r)}])]:0};return n(r)},function(r){return cn(an(r))},function(r){return cn([0,y(4,[[r,new Array(4096),0,0]])])}];function fn(r){var n=jr(16);return Or(function(r){return zr(n,r)},r),Jr(n)}function sn(r,n){var t=l(r,n);return t?[t[0][0]]:0}function vn(r,n){return[[r,n]]}function ln(r,n,t){var e=l(r,t);if(e){var u=e[0];return h(n,u[0],u[1])}return 0}function hn(r,n,t){var e=l(r,t);return e||l(n,t)}function gn(){return 0}function mn(r){if(r){var n=r[1],t=0|n.tag;return[[r[0],250===t?n[0]:246===t?$r(n):n]]}return 0}function bn(r){return function(n){return ln(mn,function(n){return l(r,n)?function(r){return[[n,r]]}:gn},n)}}function wn(r,n){return function(t){return ln(r,function(r){var t=l(n,r);return function(r){return[[t,r]]}},t)}}function pn(r,n){return function(t){return ln(r,function(){return n},t)}}function dn(r,n){return function(t){return ln(r,function(r){return function(t){return ln(n,function(){return function(n){return[[r,n]]}},t)}},t)}}function yn(r,n){return function(t){return ln(r,function(r){return function(t){return ln(n,function(n){var t=[r,n];return function(r){return[[t,r]]}},t)}},t)}}function kn(r){if(r){var n=r[0],t=kn(r[1]);return function(r){return hn(n,t,r)}}return gn}function _n(r){var n=function(r){return[[0,r]]},t=function(t){return ln(r,function(){return n},t)};return function(r){return hn(t,function(r){return[[0,r]]},r)}}function Cn(r){return function(n){for(var t=function(r){return r},e=n;;){var u=e,a=t,i=l(r,u);if(!i)return[[l(a,0),u]];var c=i[0],o=c[0];e=c[1],t=function(r,n){return function(t){return l(r,[n,t])}}(a,o)}}}function Nn(r){return yn(r,Cn(r))}function An(r,n){var t,e,u=(e=n,yn(t=r,Cn(function(r){return ln(e,function(){return t},r)})));return function(r){return hn(u,function(r){return[[0,r]]},r)}}function Sn(r){return bn(function(n){return C(r,n)})}function Fn(r){return bn(function(n){return Ir(n,r)})}function xn(r){return bn(function(n){return 1-Ir(n,r)})}function Mn(r,n){return bn(function(t){return A(r,t)?A(t,n):0})}var On=bn(function(r){return Ir(r,[32,[9,[13,[10,0]]]])}),Tn=function r(n){var t=function(t){return ln(n,function(){return r(n)},t)};return function(r){return hn(t,function(r){return[[0,r]]},r)}}(On),In=Sn(10),qn=Mn(65,90),Dn=Mn(97,122),En=Mn(48,57);function Ln(r){return hn(Dn,qn,r)}function Pn(r){return hn(Ln,En,r)}function Rn(r){return function(n){return ln(Tn,function(){return r},n)}}function Un(r){var n=function(r,t){if(t>=r.length)return function(n){return[[r,n]]};var e=n(r,t+1|0),u=Sn(mr(r,t));return function(r){return ln(u,function(){return e},r)}},t=n(r,0);return function(r){return ln(Tn,function(){return t},r)}}var Bn=wr("Js_exn.Error");function Vn(r){return function(r){if(void 0===r)return 0;if(248===r.tag)return 1;var n=r[0];return void 0!==n?+(248===n.tag):0}(r)?r:[Bn,r]}function Xn(r,n,t){for(var e=s(r,[]),u=0,a=r-1|0;u<=a;++u)e[u]=s(n,t);return e}function Gn(r){var n=r.length;return n?c(r,0,n):[]}function Kn(r,n){var t=n.length;if(t){for(var e=s(t,l(r,n[0])),u=1,a=t-1|0;u<=a;++u)e[u]=l(r,n[u]);return e}return[]}function jn(r,n){for(var t=0,e=n.length-1|0;t<=e;++t)h(r,t,n[t]);return 0}function Jn(r){for(var n=r.length-1|0,t=0;;){var e=t,u=n;if(u<0)return e;t=[r[u],e],n=u-1|0}}function Zn(r,n,t){for(var e=t,u=n.length-1|0;u>=0;--u)e=h(r,n[u],e);return e}var zn;wr("Array.Bottom"),void 0!==(zn="undefined"==typeof process?void 0:process)&&(null==zn.argv||(zn.argv[0],zn.argv)),wr("Sys.Break");function Hn(r,n){var t=r[1].length,e=r[0]+n|0;if(e>t){var u=fr(kr(t<<1,e));return Pr(r[1],0,u,0,t),r[1]=u,0}return 0}function Wn(r,n){return Hn(r,1),r[1][r[0]]=n,r[0]=r[0]+1|0,0}function Yn(r,n){var t=n.length;return Hn(r,t),Kr(n,0,r[1],r[0],t),r[0]=r[0]+t|0,0}function Qn(r){return Lr(r[1],0,r[0])}function $n(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+gr(Er(1,r[0]))}}function rt(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return y(0,[rt(r[0])]);case 1:return y(1,[rt(r[0])]);case 2:return y(2,[rt(r[0])]);case 3:return y(3,[rt(r[0])]);case 4:return y(4,[rt(r[0])]);case 5:return y(5,[rt(r[0])]);case 6:return y(6,[rt(r[0])]);case 7:return y(7,[rt(r[0])]);case 8:return y(8,[r[0],rt(r[1])]);case 9:return y(9,[r[1],r[0],rt(r[2])]);case 10:return y(10,[rt(r[0])]);case 11:return y(11,[rt(r[0])]);case 12:return y(12,[rt(r[0])]);case 13:return y(13,[rt(r[0])]);case 14:return y(14,[rt(r[0])])}}function nt(r){if("number"==typeof r)return[function(){return 0},function(){return 0},function(){return 0},function(){return 0}];switch(0|r.tag){case 0:var n=nt(r[0]),t=n[1],e=n[0];return[function(){return l(e,0),0},function(){return l(t,0),0},n[2],n[3]];case 1:var u=nt(r[0]),a=u[1],i=u[0];return[function(){return l(i,0),0},function(){return l(a,0),0},u[2],u[3]];case 2:var c=nt(r[0]),o=c[1],f=c[0];return[function(){return l(f,0),0},function(){return l(o,0),0},c[2],c[3]];case 3:var s=nt(r[0]),v=s[1],h=s[0];return[function(){return l(h,0),0},function(){return l(v,0),0},s[2],s[3]];case 4:var g=nt(r[0]),m=g[1],b=g[0];return[function(){return l(b,0),0},function(){return l(m,0),0},g[2],g[3]];case 5:var w=nt(r[0]),p=w[1],d=w[0];return[function(){return l(d,0),0},function(){return l(p,0),0},w[2],w[3]];case 6:var y=nt(r[0]),k=y[1],_=y[0];return[function(){return l(_,0),0},function(){return l(k,0),0},y[2],y[3]];case 7:var C=nt(r[0]),N=C[1],A=C[0];return[function(){return l(A,0),0},function(){return l(N,0),0},C[2],C[3]];case 8:var S=nt(r[1]),F=S[1],x=S[0];return[function(){return l(x,0),0},function(){return l(F,0),0},S[2],S[3]];case 9:var M=nt(r[2]),O=M[3],T=M[2],I=M[1],q=M[0],D=nt(tt(rt(r[0]),r[1])),E=D[3],L=D[2],P=D[1],R=D[0];return[function(){return l(q,0),l(R,0),0},function(){return l(P,0),l(I,0),0},function(){return l(T,0),l(L,0),0},function(){return l(E,0),l(O,0),0}];case 10:var U=nt(r[0]),B=U[1],V=U[0];return[function(){return l(V,0),0},function(){return l(B,0),0},U[2],U[3]];case 11:var X=nt(r[0]),G=X[1],K=X[0];return[function(){return l(K,0),0},function(){return l(G,0),0},X[2],X[3]];case 12:var j=nt(r[0]),J=j[1],Z=j[0];return[function(){return l(Z,0),0},function(){return l(J,0),0},j[2],j[3]];case 13:var z=nt(r[0]),H=z[3],W=z[2],Y=z[1],Q=z[0];return[function(){return l(Q,0),0},function(){return l(Y,0),0},function(){return l(W,0),0},function(){return l(H,0),0}];case 14:var $=nt(r[0]),rr=$[3],nr=$[2],tr=$[1],er=$[0];return[function(){return l(er,0),0},function(){return l(tr,0),0},function(){return l(nr,0),0},function(){return l(rr,0),0}]}}function tt(r,n){var t=0;if("number"==typeof r){if("number"==typeof n)return 0;switch(0|n.tag){case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5;break;default:throw[i,["camlinternalFormat.ml",816,23]]}}else switch(0|r.tag){case 0:if("number"==typeof n)t=8;else switch(0|n.tag){case 0:return y(0,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 1:if("number"==typeof n)t=8;else switch(0|n.tag){case 1:return y(1,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 2:if("number"==typeof n)t=8;else switch(0|n.tag){case 2:return y(2,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 3:if("number"==typeof n)t=8;else switch(0|n.tag){case 3:return y(3,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 4:if("number"==typeof n)t=8;else switch(0|n.tag){case 4:return y(4,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 5:if("number"==typeof n)t=8;else switch(0|n.tag){case 5:return y(5,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 6:if("number"==typeof n)t=8;else switch(0|n.tag){case 6:return y(6,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 7:if("number"==typeof n)t=8;else switch(0|n.tag){case 7:return y(7,[tt(r[0],n[0])]);case 8:t=6;break;case 9:t=7;break;case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5}break;case 8:if("number"==typeof n)throw[i,["camlinternalFormat.ml",802,26]];switch(0|n.tag){case 8:return y(8,[tt(r[0],n[0]),tt(r[1],n[1])]);case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5;break;default:throw[i,["camlinternalFormat.ml",802,26]]}break;case 9:if("number"==typeof n)throw[i,["camlinternalFormat.ml",812,28]];switch(0|n.tag){case 8:t=6;break;case 9:var e=nt(tt(rt(r[1]),n[0]));return l(e[1],0),l(e[3],0),y(9,[r[0],n[1],tt(r[2],n[2])]);case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:t=5;break;default:throw[i,["camlinternalFormat.ml",812,28]]}break;case 10:if("number"==typeof n)throw[i,["camlinternalFormat.ml",780,21]];if(10===n.tag)return y(10,[tt(r[0],n[0])]);throw[i,["camlinternalFormat.ml",780,21]];case 11:if("number"==typeof n)throw[i,["camlinternalFormat.ml",784,21]];switch(0|n.tag){case 10:t=1;break;case 11:return y(11,[tt(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",784,21]]}break;case 12:if("number"==typeof n)throw[i,["camlinternalFormat.ml",788,19]];switch(0|n.tag){case 10:t=1;break;case 11:t=2;break;case 12:return y(12,[tt(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",788,19]]}break;case 13:if("number"==typeof n)throw[i,["camlinternalFormat.ml",792,22]];switch(0|n.tag){case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:return y(13,[tt(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",792,22]]}break;case 14:if("number"==typeof n)throw[i,["camlinternalFormat.ml",797,30]];switch(0|n.tag){case 10:t=1;break;case 11:t=2;break;case 12:t=3;break;case 13:t=4;break;case 14:return y(14,[tt(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",797,30]]}}switch(t){case 1:throw[i,["camlinternalFormat.ml",781,21]];case 2:throw[i,["camlinternalFormat.ml",785,21]];case 3:throw[i,["camlinternalFormat.ml",789,19]];case 4:throw[i,["camlinternalFormat.ml",793,22]];case 5:throw[i,["camlinternalFormat.ml",798,30]];case 6:throw[i,["camlinternalFormat.ml",803,26]];case 7:throw[i,["camlinternalFormat.ml",813,28]];case 8:throw[i,["camlinternalFormat.ml",817,23]]}}var et=wr("CamlinternalFormat.Type_mismatch");function ut(r,n){if("number"==typeof r)return[0,n];if(r.tag){if("number"==typeof n)throw et;if(2===n.tag)return[y(1,[r[0]]),n[0]];throw et}return[y(0,[r[0],r[1]]),n]}function at(r,n,t){var e=ut(r,t);if("number"==typeof n){if(0!==n){var u=e[1];if("number"==typeof u)throw et;if(2===u.tag)return[e[0],1,u[0]];throw et}return[e[0],0,e[1]]}return[e[0],[n[0]],e[1]]}function it(r,n,t){var e=ct(n,t);return[y(23,[r,e[0]]),e[1]]}function ct(r,n){if("number"==typeof r)return[0,n];switch(0|r.tag){case 0:if("number"==typeof n)throw et;if(n.tag)throw et;var t=ct(r[0],n[0]);return[y(0,[t[0]]),t[1]];case 1:if("number"==typeof n)throw et;if(n.tag)throw et;var e=ct(r[0],n[0]);return[y(1,[e[0]]),e[1]];case 2:var u=ut(r[0],n),a=u[1];if("number"==typeof a)throw et;if(1===a.tag){var i=ct(r[1],a[0]);return[y(2,[u[0],i[0]]),i[1]]}throw et;case 3:var c=ut(r[0],n),o=c[1];if("number"==typeof o)throw et;if(1===o.tag){var f=ct(r[1],o[0]);return[y(3,[c[0],f[0]]),f[1]]}throw et;case 4:var s=at(r[1],r[2],n),v=s[2];if("number"==typeof v)throw et;if(2===v.tag){var h=ct(r[3],v[0]);return[y(4,[r[0],s[0],s[1],h[0]]),h[1]]}throw et;case 5:var g=at(r[1],r[2],n),m=g[2];if("number"==typeof m)throw et;if(3===m.tag){var b=ct(r[3],m[0]);return[y(5,[r[0],g[0],g[1],b[0]]),b[1]]}throw et;case 6:var w=at(r[1],r[2],n),p=w[2];if("number"==typeof p)throw et;if(4===p.tag){var d=ct(r[3],p[0]);return[y(6,[r[0],w[0],w[1],d[0]]),d[1]]}throw et;case 7:var k=at(r[1],r[2],n),_=k[2];if("number"==typeof _)throw et;if(5===_.tag){var C=ct(r[3],_[0]);return[y(7,[r[0],k[0],k[1],C[0]]),C[1]]}throw et;case 8:var A=at(r[1],r[2],n),S=A[2];if("number"==typeof S)throw et;if(6===S.tag){var F=ct(r[3],S[0]);return[y(8,[r[0],A[0],A[1],F[0]]),F[1]]}throw et;case 9:if("number"==typeof n)throw et;if(7===n.tag){var x=ct(r[0],n[0]);return[y(9,[x[0]]),x[1]]}throw et;case 10:var M=ct(r[0],n);return[y(10,[M[0]]),M[1]];case 11:var O=ct(r[1],n);return[y(11,[r[0],O[0]]),O[1]];case 12:var T=ct(r[1],n);return[y(12,[r[0],T[0]]),T[1]];case 13:if("number"==typeof n)throw et;if(8===n.tag){var I=n[0];if(N([r[1]],[I]))throw et;var q=ct(r[2],n[1]);return[y(13,[r[0],I,q[0]]),q[1]]}throw et;case 14:if("number"==typeof n)throw et;if(9===n.tag){var D=n[0];if(N([dr(r[1])],[dr(D)]))throw et;var E=ct(r[2],dr(n[2]));return[y(14,[r[0],D,E[0]]),E[1]]}throw et;case 15:if("number"==typeof n)throw et;if(10===n.tag){var L=ct(r[0],n[0]);return[y(15,[L[0]]),L[1]]}throw et;case 16:if("number"==typeof n)throw et;if(11===n.tag){var P=ct(r[0],n[0]);return[y(16,[P[0]]),P[1]]}throw et;case 17:var R=ct(r[1],n);return[y(17,[r[0],R[0]]),R[1]];case 18:var U=r[0],B=r[1],V=n;if(U.tag){var X=U[0],G=ct(X[0],V),K=ct(B,G[1]);return[y(18,[y(1,[[G[0],X[1]]]),K[0]]),K[1]]}var j=U[0],J=ct(j[0],V),Z=ct(B,J[1]);return[y(18,[y(0,[[J[0],j[1]]]),Z[0]]),Z[1]];case 19:if("number"==typeof n)throw et;if(13===n.tag){var z=ct(r[0],n[0]);return[y(19,[z[0]]),z[1]]}throw et;case 20:if("number"==typeof n)throw et;if(1===n.tag){var H=ct(r[2],n[0]);return[y(20,[r[0],r[1],H[0]]),H[1]]}throw et;case 21:if("number"==typeof n)throw et;if(2===n.tag){var W=ct(r[1],n[0]);return[y(21,[r[0],W[0]]),W[1]]}throw et;case 23:var Y=r[0],Q=r[1],$=n;if("number"==typeof Y){if(3===Y){if("number"==typeof $)throw et;if(14===$.tag){var rr=ct(Q,$[0]);return[y(23,[3,rr[0]]),rr[1]]}throw et}return it(Y,Q,$)}switch(0|Y.tag){case 7:return it(y(7,[Y[0],Y[1]]),Q,$);case 8:var nr=function r(n,t,e){{if("number"==typeof n)return[0,ct(t,e)];switch(0|n.tag){case 0:if("number"==typeof e)throw et;if(e.tag)throw et;var u=r(n[0],t,e[0]);return[y(0,[u[0]]),u[1]];case 1:if("number"==typeof e)throw et;if(1===e.tag){var a=r(n[0],t,e[0]);return[y(1,[a[0]]),a[1]]}throw et;case 2:if("number"==typeof e)throw et;if(2===e.tag){var i=r(n[0],t,e[0]);return[y(2,[i[0]]),i[1]]}throw et;case 3:if("number"==typeof e)throw et;if(3===e.tag){var c=r(n[0],t,e[0]);return[y(3,[c[0]]),c[1]]}throw et;case 4:if("number"==typeof e)throw et;if(4===e.tag){var o=r(n[0],t,e[0]);return[y(4,[o[0]]),o[1]]}throw et;case 5:if("number"==typeof e)throw et;if(5===e.tag){var f=r(n[0],t,e[0]);return[y(5,[f[0]]),f[1]]}throw et;case 6:if("number"==typeof e)throw et;if(6===e.tag){var s=r(n[0],t,e[0]);return[y(6,[s[0]]),s[1]]}throw et;case 7:if("number"==typeof e)throw et;if(7===e.tag){var v=r(n[0],t,e[0]);return[y(7,[v[0]]),v[1]]}throw et;case 8:if("number"==typeof e)throw et;if(8===e.tag){var h=e[0];if(N([n[0]],[h]))throw et;var g=r(n[1],t,e[1]);return[y(8,[h,g[0]]),g[1]]}throw et;case 9:if("number"==typeof e)throw et;if(9===e.tag){var m=e[1],b=e[0];if(N([dr(n[0])],[dr(b)]))throw et;if(N([dr(n[1])],[dr(m)]))throw et;var w=tt(rt(b),m),p=nt(w);l(p[1],0),l(p[3],0);var d=r(dr(n[2]),t,e[2]);return[y(9,[b,m,rt(d[0])]),d[1]]}throw et;case 10:if("number"==typeof e)throw et;if(10===e.tag){var k=r(n[0],t,e[0]);return[y(10,[k[0]]),k[1]]}throw et;case 11:if("number"==typeof e)throw et;if(11===e.tag){var _=r(n[0],t,e[0]);return[y(11,[_[0]]),_[1]]}throw et;case 12:throw et;case 13:if("number"==typeof e)throw et;if(13===e.tag){var C=r(n[0],t,e[0]);return[y(13,[C[0]]),C[1]]}throw et;case 14:if("number"==typeof e)throw et;if(14===e.tag){var A=r(n[0],t,e[0]);return[y(14,[A[0]]),A[1]]}throw et}}}(Y[1],Q,$),tr=nr[1];return[y(23,[y(8,[Y[0],nr[0]]),tr[0]]),tr[1]];default:return it(Y,Q,$)}case 22:case 24:throw et}}function ot(r,n){return function(r,n){var t=ct(r,n);if("number"==typeof t[1])return t[0];throw et}(r,dr(rt(n)))}function ft(r,n,t){var e=t.length,u=_r(n),a=n<0?0:r,i=u;if(i<=e)return t;var c=a,o=Er(i,2===c?48:32);switch(c){case 0:Kr(t,0,o,0,e);break;case 1:Kr(t,0,o,i-e|0,e);break;case 2:e>0&&(43===mr(t,0)||45===mr(t,0)||32===mr(t,0))?(o[0]=mr(t,0),Kr(t,1,o,1+(i-e|0)|0,e-1|0)):e>1&&48===mr(t,0)&&(120===mr(t,1)||88===mr(t,1))?(o[1]=mr(t,1),Kr(t,2,o,2+(i-e|0)|0,e-2|0)):Kr(t,0,o,i-e|0,e)}return gr(o)}function st(r,n){var t=_r(r),e=n.length,u=mr(n,0),a=0;if(u>=58)if(u>=71){if(u>102||u<97)return n;a=2}else{if(!(u>=65))return n;a=2}else if(32!==u){if(!(u>=43))return n;switch(u-43|0){case 0:case 2:a=1;break;case 1:case 3:case 4:return n;case 5:if((t+2|0)>e&&e>1&&(120===mr(n,1)||88===mr(n,1))){var i=Er(t+2|0,48);return i[1]=mr(n,1),Kr(n,2,i,4+(t-e|0)|0,e-2|0),gr(i)}a=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:a=2}}else a=1;switch(a){case 1:if((t+1|0)>e){var c=Er(t+1|0,48);return c[0]=u,Kr(n,1,c,2+(t-e|0)|0,e-1|0),gr(c)}return n;case 2:if(t>e){var o=Er(t,48);return Kr(n,0,o,t-e|0,e),gr(o)}return n}}function vt(r){return Vr((n=r,function(r){for(;;){var t=r;if(t>=n.length)return 0;var e=n.charCodeAt(t);if(!(e>=32))return 1;var u=e-34|0;if(u>58||u<0){if(u>=93)return 1;r=t+1|0}else{if(u>57||u<1)return 1;r=t+1|0}}}(0)?gr(Ur(hr(n))):n),['"',['"',0]]);var n}function lt(r,n){var t;switch(r){case 0:t=["%",["d",0]];break;case 1:t=["%+",["d",0]];break;case 2:t=["% ",["d",0]];break;case 3:t=["%",["i",0]];break;case 4:t=["%+",["i",0]];break;case 5:t=["% ",["i",0]];break;case 6:t=["%",["x",0]];break;case 7:t=["%#",["x",0]];break;case 8:t=["%",["X",0]];break;case 9:t=["%#",["X",0]];break;case 10:t=["%",["o",0]];break;case 11:t=["%#",["o",0]];break;case 12:t=["%",["u",0]]}return Vr(gr(Er(1,n)),t)}function ht(r,n){if(15===r)return"%.12g";var t=_r(n),e=function(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70}}(r),u=[0,new Array(16)];return Wn(u,37),function(r,n){switch(n){case 1:case 4:case 7:case 10:case 13:return Wn(r,43);case 2:case 5:case 8:case 11:case 14:return Wn(r,32);case 0:case 3:case 6:case 9:case 12:case 15:;}}(u,r),Wn(u,46),Yn(u,""+t),Wn(u,e),Qn(u)}function gt(r,n){return ar(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),n)}function mt(r,n){return or(lt(r,108),n)}function bt(r,n){return cr(lt(r,110),n)}function wt(r,n){return ir(lt(r,76),n)}function pt(r,n,t){var e=function(r,n){var t=er(r),e=t[9]<0?6:t[9],u=n<0?(t[8]=-1,-n):n,a="";if(isNaN(u))a="nan",t[2]=" ";else if(isFinite(u))switch(t[10]){case"e":var i=(a=u.toExponential(e)).length;"e"===a[i-3|0]&&(a=a.slice(0,i-1|0)+"0"+a.slice(i-1|0));break;case"f":a=u.toFixed(e);break;case"g":var c=0!==e?e:1,o=(a=u.toExponential(c-1|0)).indexOf("e"),f=0|Number(a.slice(o+1|0));if(f<-4||u>=1e21||u.toFixed().length>c){for(var s=o-1|0;"0"===a[s];)s=s-1|0;"."===a[s]&&(s=s-1|0);var v=(a=a.slice(0,s+1|0)+a.slice(o)).length;"e"===a[v-3|0]&&(a=a.slice(0,v-1|0)+"0"+a.slice(v-1|0))}else{var l=c;if(f<0)l=l-(f+1|0)|0,a=u.toFixed(l);else for(;+((a=u.toFixed(l)).length>(c+1|0));)l=l-1|0;if(0!==l){for(var h=a.length-1|0;"0"===a[h];)h=h-1|0;"."===a[h]&&(h=h-1|0),a=a.slice(0,h+1|0)}}}else a="inf",t[2]=" ";return ur(t,a)}(ht(r,_r(n)),t);if(15!==r)return e;var u,a=e.length,i=(u=t,isFinite(u)?Math.abs(u)>=2.2250738585072014e-308?0:0!==u?1:2:isNaN(u)?4:3);return 3!==i?i>=4?"nan":function(r){for(;;){var n=r;if(n===a)return 0;var t=mr(e,n)-46|0;if(t>23||t<0){if(55!==t){r=n+1|0;continue}return 1}if(t>22||t<1)return 1;r=n+1|0}}(0)?e:e+".":t<0?"neg_infinity":"infinity"}function dt(r){return Vr(function(r){var n=0;if(r>=40){if(92===r)return"\\\\";n=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";n=2}else if(r>=14)n=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:n=1;break;case 13:return"\\r"}switch(n){case 1:var t=new Array(4);return t[0]=92,t[1]=48+(r/100|0)|0,t[2]=48+(r/10|0)%10|0,t[3]=48+r%10|0,gr(t);case 2:var e=new Array(1);return e[0]=r,gr(e)}}(r),["'",["'",0]])}function yt(r){var n=[0,new Array(16)];return function r(n,t){for(;;){var e=t;if("number"==typeof e)return 0;switch(0|e.tag){case 0:Yn(n,"%c"),t=e[0];continue;case 1:Yn(n,"%s"),t=e[0];continue;case 2:Yn(n,"%i"),t=e[0];continue;case 3:Yn(n,"%li"),t=e[0];continue;case 4:Yn(n,"%ni"),t=e[0];continue;case 5:Yn(n,"%Li"),t=e[0];continue;case 6:Yn(n,"%f"),t=e[0];continue;case 7:Yn(n,"%B"),t=e[0];continue;case 8:Yn(n,"%{"),r(n,e[0]),Yn(n,"%}"),t=e[1];continue;case 9:Yn(n,"%("),r(n,e[0]),Yn(n,"%)"),t=e[2];continue;case 10:Yn(n,"%a"),t=e[0];continue;case 11:Yn(n,"%t"),t=e[0];continue;case 12:Yn(n,"%?"),t=e[0];continue;case 13:Yn(n,"%r"),t=e[0];continue;case 14:Yn(n,"%_r"),t=e[0];continue}}}(n,r),Qn(n)}function kt(r,n,t,e){for(;;){var u=e,a=t,c=r;if("number"==typeof u)return h(c,n,a);switch(0|u.tag){case 0:return function(r,t,e){return function(u){var a=y(5,[t,u]);return kt(r,n,a,e)}}(c,a,u[0]);case 1:return function(r,t,e){return function(u){var a=dt(u),i=y(4,[t,a]);return kt(r,n,i,e)}}(c,a,u[0]);case 2:return Nt(c,n,a,u[1],u[0],function(r){return r});case 3:return Nt(c,n,a,u[1],u[0],vt);case 4:return At(c,n,a,u[3],u[1],u[2],gt,u[0]);case 5:return At(c,n,a,u[3],u[1],u[2],mt,u[0]);case 6:return At(c,n,a,u[3],u[1],u[2],bt,u[0]);case 7:return At(c,n,a,u[3],u[1],u[2],wt,u[0]);case 8:var o=c,f=n,s=a,v=u[3],g=u[1],m=u[2],b=u[0];if("number"!=typeof g){if(g.tag){var w=g[0];return"number"==typeof m?0!==m?function(r,n,t,e,u,a){return function(i,c,o){var f=ft(a,i,pt(u,c,o));return kt(r,n,y(4,[t,f]),e)}}(o,f,s,v,b,w):function(r,n,t,e,u,a){return function(i,c){var o=pt(u,6,c),f=ft(a,i,o);return kt(r,n,y(4,[t,f]),e)}}(o,f,s,v,b,w):function(r,n,t,e,u,a,i){return function(c,o){var f=ft(a,c,pt(u,i,o));return kt(r,n,y(4,[t,f]),e)}}(o,f,s,v,b,w,m[0])}var p=g[1],d=g[0];return"number"==typeof m?0!==m?function(r,n,t,e,u,a,i){return function(c,o){var f=ft(a,i,pt(u,c,o));return kt(r,n,y(4,[t,f]),e)}}(o,f,s,v,b,d,p):function(r,n,t,e,u,a,i){return function(c){var o=pt(u,6,c),f=ft(a,i,o);return kt(r,n,y(4,[t,f]),e)}}(o,f,s,v,b,d,p):function(r,n,t,e,u,a,i,c){return function(o){var f=ft(a,i,pt(u,c,o));return kt(r,n,y(4,[t,f]),e)}}(o,f,s,v,b,d,p,m[0])}return"number"==typeof m?0!==m?function(r,n,t,e,u){return function(a,i){var c=pt(u,a,i);return kt(r,n,y(4,[t,c]),e)}}(o,f,s,v,b):function(r,n,t,e,u){return function(a){var i=pt(u,6,a);return kt(r,n,y(4,[t,i]),e)}}(o,f,s,v,b):function(r,n,t,e,u,a){return function(i){var c=pt(u,a,i);return kt(r,n,y(4,[t,c]),e)}}(o,f,s,v,b,m[0]);case 9:return function(r,t,e){return function(u){return kt(r,n,y(4,[t,u?"true":"false"]),e)}}(c,a,u[0]);case 10:e=u[0],t=y(7,[a]);continue;case 11:e=u[1],t=y(2,[a,u[0]]);continue;case 12:e=u[1],t=y(3,[a,u[0]]);continue;case 13:return function(r,t,e,u){return function(){return kt(r,n,y(4,[t,u]),e)}}(c,a,u[2],yt(u[1]));case 14:var k=u[2];return function(r,t,e,u){return function(a){return kt(r,n,t,yr(ot(a[0],e),u))}}(c,a,u[1],k);case 15:return function(r,t,e){return function(u,a){return kt(r,n,y(6,[t,function(r){return h(u,r,a)}]),e)}}(c,a,u[0]);case 16:return function(r,t,e){return function(u){return kt(r,n,y(6,[t,u]),e)}}(c,a,u[0]);case 17:e=u[1],t=y(0,[a,u[0]]);continue;case 18:var _=u[0];if(_.tag){var C=function(r,n,t){return function(e,u){return kt(r,e,y(1,[n,y(1,[u])]),t)}}(c,a,u[1]);e=_[0][0],t=0,r=C;continue}var N=function(r,n,t){return function(e,u){return kt(r,e,y(1,[n,y(0,[u])]),t)}}(c,a,u[1]);e=_[0][0],t=0,r=N;continue;case 19:throw[i,["camlinternalFormat.ml",1449,4]];case 20:return function(r,t,e){return function(){return kt(r,n,e,t)}}(c,u[2],y(8,[a,"Printf: bad conversion %["]));case 21:return function(r,t,e){return function(u){var a=ar("%u",u),i=y(4,[t,a]);return kt(r,n,i,e)}}(c,a,u[1]);case 22:return function(r,t,e){return function(u){var a=y(5,[t,u]);return kt(r,n,a,e)}}(c,a,u[0]);case 23:var A=c,S=n,F=a,x=u[0],M=u[1];if("number"==typeof x){if(3===x)throw[i,["camlinternalFormat.ml",1517,39]];return Ct(A,S,F,M)}return 8===x.tag?_t(A,S,F,x[1],M):Ct(A,S,F,M);case 24:return St(c,n,a,u[2],u[0],l(u[1],0))}}}function _t(r,n,t,e,u){if("number"==typeof e)return Ct(r,n,t,u);switch(0|e.tag){case 0:var a=e[0];return function(){return _t(r,n,t,a,u)};case 1:var c=e[0];return function(){return _t(r,n,t,c,u)};case 2:var o=e[0];return function(){return _t(r,n,t,o,u)};case 3:var f=e[0];return function(){return _t(r,n,t,f,u)};case 4:var s=e[0];return function(){return _t(r,n,t,s,u)};case 5:var v=e[0];return function(){return _t(r,n,t,v,u)};case 6:var l=e[0];return function(){return _t(r,n,t,l,u)};case 7:var h=e[0];return function(){return _t(r,n,t,h,u)};case 8:var g=e[1];return function(){return _t(r,n,t,g,u)};case 9:var m=e[2],b=tt(rt(e[0]),e[1]);return function(){return _t(r,n,t,function r(n,t){if("number"==typeof n)return t;switch(0|n.tag){case 0:return y(0,[r(n[0],t)]);case 1:return y(1,[r(n[0],t)]);case 2:return y(2,[r(n[0],t)]);case 3:return y(3,[r(n[0],t)]);case 4:return y(4,[r(n[0],t)]);case 5:return y(5,[r(n[0],t)]);case 6:return y(6,[r(n[0],t)]);case 7:return y(7,[r(n[0],t)]);case 8:return y(8,[n[0],r(n[1],t)]);case 9:return y(9,[n[0],n[1],r(n[2],t)]);case 10:return y(10,[r(n[0],t)]);case 11:return y(11,[r(n[0],t)]);case 12:return y(12,[r(n[0],t)]);case 13:return y(13,[r(n[0],t)]);case 14:return y(14,[r(n[0],t)])}}(b,m),u)};case 10:var w=e[0];return function(e,a){return _t(r,n,t,w,u)};case 11:var p=e[0];return function(){return _t(r,n,t,p,u)};case 12:var d=e[0];return function(){return _t(r,n,t,d,u)};case 13:throw[i,["camlinternalFormat.ml",1540,31]];case 14:throw[i,["camlinternalFormat.ml",1541,31]]}}function Ct(r,n,t,e){return kt(r,n,y(8,[t,"Printf: bad conversion %_"]),e)}function Nt(r,n,t,e,u,a){if("number"==typeof u)return function(u){var i=l(a,u),c=y(4,[t,i]);return kt(r,n,c,e)};if(u.tag){var i=u[0];return function(u,c){var o=ft(i,u,l(a,c)),f=y(4,[t,o]);return kt(r,n,f,e)}}var c=u[1],o=u[0];return function(u){var i=ft(o,c,l(a,u)),f=y(4,[t,i]);return kt(r,n,f,e)}}function At(r,n,t,e,u,a,i,c){if("number"==typeof u){if("number"==typeof a)return 0!==a?function(u,a){var o=st(u,h(i,c,a));return kt(r,n,y(4,[t,o]),e)}:function(u){var a=h(i,c,u);return kt(r,n,y(4,[t,a]),e)};var o=a[0];return function(u){var a=st(o,h(i,c,u));return kt(r,n,y(4,[t,a]),e)}}if(u.tag){var f=u[0];if("number"==typeof a)return 0!==a?function(u,a,o){var s=ft(f,u,st(a,h(i,c,o)));return kt(r,n,y(4,[t,s]),e)}:function(u,a){var o=ft(f,u,h(i,c,a));return kt(r,n,y(4,[t,o]),e)};var s=a[0];return function(u,a){var o=ft(f,u,st(s,h(i,c,a)));return kt(r,n,y(4,[t,o]),e)}}var v=u[1],l=u[0];if("number"==typeof a)return 0!==a?function(u,a){var o=ft(l,v,st(u,h(i,c,a)));return kt(r,n,y(4,[t,o]),e)}:function(u){var a=ft(l,v,h(i,c,u));return kt(r,n,y(4,[t,a]),e)};var g=a[0];return function(u){var a=ft(l,v,st(g,h(i,c,u)));return kt(r,n,y(4,[t,a]),e)}}function St(r,n,t,e,u,a){if(u){var i=u[0];return function(u){return St(r,n,t,e,i,l(a,u))}}return kt(r,n,y(4,[t,a]),e)}function Ft(r,n){return kt(function(n,e){var u=jr(64);return function r(n,e){for(;;){var u=e,a=0;if("number"==typeof u)return 0;switch(0|u.tag){case 0:var i=$n(u[1]);return r(n,u[0]),Hr(n,i);case 1:var c=u[1];if(r(n,u[0]),c.tag){Hr(n,"@["),e=c[0];continue}Hr(n,"@{"),e=c[0];continue;case 2:case 4:a=1;break;case 3:case 5:a=2;break;case 6:return r(n,u[0]),Hr(n,l(u[1],0));case 7:e=u[0];continue;case 8:throw r(n,u[0]),[t,u[1]]}switch(a){case 1:return r(n,u[0]),Hr(n,u[1]);case 2:return r(n,u[0]),zr(n,u[1])}}}(u,e),l(r,Jr(u))},0,0,n[0])}function xt(r){return Ft(function(r){return r},r)}function Mt(r){return 0!==r?0:1}var Ot=[[0,75],[[1,81],[[2,82],[[3,66],[[4,78],[[5,80],0]]]]]];function Tt(r){return qr(r,Ot)}function It(r,n){for(;;){var t=n;if(!t)throw u;var e=t[0];if(C(r,e[1]))return e[0];n=t[1]}}var qt=Xn(8,8,0);function Dt(r,n,t){return o(f(qt,r),n,[[t,1]]),o(f(qt,r),7-n|0,[[t,0]])}for(var Et=0;Et<=7;++Et)Dt(Et,1,5);Dt(0,0,2),Dt(7,0,2),Dt(1,0,4),Dt(6,0,4),Dt(2,0,3),Dt(5,0,3),Dt(3,0,1),Dt(4,0,0);var Lt=[qt,1,[1,1],[1,1],0,0,0,[4,0],[4,7],0,0];function Pt(r){return r>=0?+(r<=7):0}function Rt(r){return Pt(r[0])?Pt(r[1]):0}function Ut(r){var n=Gn(r);return jn(function(r,t){return o(n,r,Gn(t))},r),n}function Bt(r){return[r[0],0]}function Vt(r){return[0,r[1]]}var Xt=wr("Ochess.Illegal_move");function Gt(r,n,t){var e,u=Ut(r[0]),a=function(r,n,t,e){return o(f(u,t),e,f(f(u,r),n)),o(f(u,r),n,0)},i=Mt(r[1]),c=r[2],s=r[3],v=[r],l=r[6],h=r[7],g=r[8],m=r[9]+1|0,b=(0|-r[10])+t|0,w=[u,i,c,s,0,v,l,h,g,m,b],p=r[1],d=0;if("number"==typeof n)if(n)if(0!==p){a(0,0,3,0),a(4,0,2,0);var y=w.slice();y[2]=[0,0],y[7]=[2,0],e=y}else{a(0,7,3,7),a(4,7,2,7);var k=w.slice();k[3]=[0,0],k[8]=[2,7],e=k}else if(0!==p){a(7,0,5,0),a(4,0,6,0);var _=w.slice();_[2]=[0,0],_[7]=[6,0],e=_}else{a(7,7,5,7),a(4,7,6,7);var C=w.slice();C[3]=[0,0],C[8]=[6,7],e=C}else if(n.tag){var N=n[2];d=1;var A=0!==p?[6,7]:[1,0],S=A[1];a(n[1],A[0],N,S),o(f(u,N),S,[[n[0],r[1]]]),e=w}else{var F=n[3],x=n[2],M=n[1],O=n[0];f(f(r[0],x),F)&&(d=1),a(O,M,x,F);var T=f(f(u,x),F);if(!T)throw Xt;switch(T[0][0]){case 0:if(0!==r[1]){var I=w.slice();I[2]=[0,0],I[7]=[x,F],e=I}else{var q=w.slice();q[3]=[0,0],q[8]=[x,F],e=q}break;case 2:if(0!==r[1])if(0!==O)if(7!==O)e=w;else if(0!==M)e=w;else{var D=w.slice();D[2]=Bt(r[2]),e=D}else if(0!==M)e=w;else{var E=w.slice();E[2]=Vt(r[2]),e=E}else if(0!==O)if(7!==O)e=w;else if(7!==M)e=w;else{var L=w.slice();L[3]=Bt(r[3]),e=L}else if(7!==M)e=w;else{var P=w.slice();P[3]=Vt(r[3]),e=P}break;case 1:case 3:case 4:e=w;break;case 5:d=1;var R,U=f(f(u,x),F),B=r[1];if(U){var V=U[0];R=V[0]>=5?0!==V[1]?0!==B&&O===x&&1===M&&3===F?[O]:0:0!==B||O!==x||6!==M||4!==F?0:[O]:0}else R=0;var X=r[4];if(X){var G=X[0];if(G===x)0!==r[1]?5===F&&o(f(u,G),4,0):2===F&&o(f(u,G),3,0)}var K=w.slice();K[4]=R,e=K}}var j=e.slice();return j[6]=d?0:r[6]+1|0,j}var Kt=[[1,2],[[1,-2],[[2,1],[[2,-1],[[-1,2],[[-1,-2],[[-2,1],[[-2,-1],0]]]]]]]],jt=[[-1,0],[[0,-1],[[0,1],[[1,0],0]]]],Jt=[[-1,-1],[[-1,1],[[1,-1],[[1,1],0]]]],Zt=Nr(Jt,jt),zt=[[-1,1],[[1,1],0]],Ht=[[-1,-1],[[1,-1],0]];function Wt(r,n){return[r[0]+n[0]|0,r[1]+n[1]|0]}function Yt(r,n,t,e,u){return function r(n){return n?Nr(n[0],r(n[1])):0}(xr(function(e){return function(r,n,t,e,u,a,i,c,o){for(;;){var s=o,v=c,l=u,h=e;if(v<1)return s;var g=Wt([h,l],[a,i]),m=g[1],b=g[0];if(!Rt([b,m]))return s;var w=f(f(r[0],b),m);if(w)return w[0][1]!==r[1]?[y(0,[n,t,b,m]),s]:s;o=[y(0,[n,t,b,m]),s],c=v-1|0,u=m,e=b}}(r,n,t,n,t,e[0],e[1],u,0)},e))}function Qt(r,n,t,e,u,a,i,c){for(;;){var o=c,s=u,v=e;if(o<1)return 0;var l=Wt([v,s],[a,i]),h=l[1],g=l[0];if(!Rt([g,h]))return 0;var m=f(f(r[0],g),h);if(m){var b=m[0];return b[1]!==n?Ir(b[0],t):0}c=o-1|0,u=h,e=g}}function $t(r,n,t,e,u,a,i){for(;;){var c=a;if(!c)return 0;var o=c[0];if(Qt(r,n,t,e,u,o[0],o[1],i))return 1;a=c[1]}}function re(r,n,t,e){return $t(r,n,[2,[1,0]],t,e,jt,10)?1:$t(r,n,[3,[1,0]],t,e,Jt,10)?1:$t(r,n,[4,0],t,e,Kt,1)?1:$t(r,n,[0,0],t,e,Zt,1)?1:$t(r,n,[5,0],t,e,1===n?zt:Ht,1)}function ne(r,n){var t,e=(t=r,[0!==n?t[7]:t[8]]);if(e){var u=e[0];return re(r,n,u[0],u[1])}return 0}function te(r,n,t,e,u,a){if(n){if(C(f(f(r[0],a),t),[[2,r[1]]])){if(function(r,n,t,e){for(;;){var u=t;if(u>e)return 1;if(0!==f(f(r[0],u),n))return 0;t=u+1|0}}(r,t,A(s=e,v=u)?s:v,kr(e,u))){if(re(r,r[1],4,t))return 0;var i=Ut(r[0]);o(f(i,4),t,0),o(f(i,e),t,[[0,r[1]]]);var c=r.slice();return 1-re((c[0]=i,c),r[1],e,t)}return 0}return 0}return 0;var s,v}function ee(r,n,t){var e=function(e){return Yt(r,n,t,e,1)},u=function(e){return Yt(r,n,t,e,10)},a=f(f(r[0],n),t);if(!a)return 0;var i,c,o,s,v=a[0],l=v[1];if(l!==r[1])return 0;switch(v[0]){case 0:return Nr((c=0!==(i=r)[1]?[i[2],0]:[i[3],7],o=c[1],Nr(te(i,(s=c[0])[0],o,3,1,0)?[1,0]:0,te(i,s[1],o,5,6,7)?[0,0]:0)),e(Zt));case 1:return u(Zt);case 2:return u(jt);case 3:return u(Jt);case 4:return e(Kt);case 5:var h=0!==l?t+1|0:t-1|0,g=[0],m=function(r){return g[0]=[r,g[0]],0},b=[3,[4,[2,[1,0]]]];if(7===h&&1===l||0===h&&0===l)f(f(r[0],n),h)||Or(function(r){return m(y(1,[r,n,n]))},b),Or(function(t){if(Pt(t)){var e=f(f(r[0],t),h);return e&&e[0][1]!==l?Or(function(r){return m(y(1,[r,n,t]))},b):0}return 0},[n-1|0,[n+1|0,0]]);else f(f(r[0],n),h)||m(y(0,[n,t,n,h])),Or(function(e){if(Pt(e)){var u=f(f(r[0],e),h);return u&&u[0][1]!==l?m(y(0,[n,t,e,h])):0}return 0},[n-1|0,[n+1|0,0]]);if(1!==t){if(6===t&&!l){var w=f(f(r[0],n),5),p=f(f(r[0],n),4);w||p||m(y(0,[n,t,n,4]))}}else if(0!==l){var d=f(f(r[0],n),2),k=f(f(r[0],n),3);d||k||m(y(0,[n,t,n,3]))}var _=r[4];if(_){var C=_[0],N=0!==l?5:2;Or(function(r){return Pt(r)&&r===C&&h===N?m(y(0,[n,t,r,h])):0},[n-1|0,[n+1|0,0]])}return g[0]}}var ue=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,3,5,5,3,0,0],[0,0,5,9,9,5,0,0],[0,0,5,9,9,5,0,0],[0,0,3,5,5,3,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]];(function(r,n,t,e){var u,a,i=(u=t,0!==e?u:7-u|0);switch(r){case 0:a=1e6-F(5,f(f(ue,n),i))|0;break;case 1:a=9e3+F(10,f(f(ue,n),i))|0;break;case 2:a=5e3+F(10,f(f(ue,n),i))|0;break;case 3:a=3200+F(20,f(f(ue,n),i))|0;break;case 4:a=3e3+F(30,f(f(ue,n),i))|0;break;case 5:a=1e3+F(30,f(f(ue,n),i))|0}F(5,i)})(0,0,0,1),wr("Ochess.Interrupt"),wr("Ochess.Illegal_position");function ae(r){return Dr(function(n){return 1-ne(Gt(r,n,0),r[1])})(function(r){for(var n=0,t=0;t<=7;++t)for(var e=0;e<=7;++e)n=Nr(ee(r,t,e),n);return n}(r))}function ie(r){switch(r){case 0:return"king";case 1:return"queen";case 2:return"rook";case 3:return"bishop";case 4:return"knight";case 5:return"pawn"}}function ce(r){return 0!==r?"white":"black"}function oe(r){return 0!==r?0:7}function fe(r,n){return Gt(r,n,0)}var se=[[[0,0],107],[[[0,1],75],[[[1,0],113],[[[1,1],81],[[[2,0],114],[[[2,1],82],[[[3,0],98],[[[3,1],66],[[[4,0],110],[[[4,1],78],[[[5,0],112],[[[5,1],80],0]]]]]]]]]]]];function ve(r,n){if("number"==typeof n)return y(2,n?[1]:[0]);if(n.tag){var t=n[2],e=n[1];return y(1,[e,[t,0!==r[1]?7:0],+(e!==t),[n[0]]])}var u=n[3],a=n[2],i=n[1],c=n[0],o=f(f(r[0],c),i);if(o){var s=o[0][0];return s>=5?y(1,[c,[a,u],+(c!==a),0]):y(0,[s,[c,i],[a,u],f(f(r[0],a),u)?1:0])}throw Xt}function le(r,n){return n&&!C(r,n[0])?0:1}function he(r,n){return+(1===Ar(Dr(function(r){return function(r,n){switch(0|n.tag){case 0:var t=n[1];return C(r[3],n[2])&&r[0]===n[0]&&le(t[0],r[1])?le(t[1],r[2]):0;case 1:case 2:return 0}}(n,r)})(r)))}function ge(r,n,t){var e,u,a,i=ve(r,t),c=ne(e=Gt(r,t,0),e[1])?ae(e)?0:1:2,o=function(r,n){switch(0|n.tag){case 0:var t=n[3],e=n[2],u=n[1],a=u[1],i=u[0],c=n[0],o=[c,0,0,e,t];if(he(r,o))return[o];var f=[c,[i],0,e,t];if(he(r,f))return[f];var s=[c,0,[a],e,t];return he(r,s)?[s]:[[c,[i],[a],e,t]];case 1:case 2:return 0}}(n,i);if(o){var f=o[0],s=f[3],v=f[2],h=f[1];u=w(xt([y(0,[y(2,[0,y(2,[0,y(2,[0,y(0,[y(0,[0])])])])])]),"%c%s%s%s%c%c"]),Tt(f[0]),h?l(xt([y(0,[0]),"%c"]),mr("abcdefgh",h[0])):"",v?l(xt([y(0,[0]),"%c"]),mr("12345678",v[0])):"",f[4]?"x":"",mr("abcdefgh",s[0]),mr("12345678",s[1]))}else switch(0|i.tag){case 0:throw Xt;case 1:var g=i[3],b=i[1];u=m(xt([y(2,[0,y(0,[y(0,[y(2,[0,0])])])]),"%s%c%c%s"]),i[2]?l(xt([y(0,[y(12,[120,0])]),"%cx"]),mr("abcdefgh",i[0])):"",mr("abcdefgh",b[0]),mr("12345678",b[1]),g?l(xt([y(12,[61,y(0,[0])]),"=%c"]),Tt(g[0])):"");break;case 2:var p=i[0];if("number"!=typeof p)throw Xt;u=0!==p?"O-O-O":"O-O"}switch(c){case 0:a="+";break;case 1:a="#";break;case 2:a=""}return u+a}function me(r,n){var t=xr(function(n){return ve(r,n)},ae(r));return ge(r,t,n)}var be=t;function we(r){var n=r.split("/");if(8!==n.length)throw[be,"not exactly 8 ranks"];var e=Xn(8,8,0),a=[0],i=[0];jn(function(r,n){var c=7-r|0,s=[0];return Xr(function(r){var n=r-48|0;if(n>8||n<0){if(75!==r){if(107===r){if(i[0])throw[be,"more than one black king"];i[0]=[[s[0],c]]}}else{if(a[0])throw[be,"more than one white king"];a[0]=[[s[0],c]]}try{o(f(e,s[0]),c,[It(r,se)])}catch(r){var v=Vn(r);throw v[0]===t?[be,"too many squares on one rank"]:v===u?[be,"not a piece"]:v}return s[0]=s[0]+1|0,0}switch(n){case 0:return 0;case 1:return s[0]=s[0]+1|0,0;case 2:return s[0]=s[0]+2|0,0;case 3:return s[0]=s[0]+3|0,0;case 4:return s[0]=s[0]+4|0,0;case 5:return s[0]=s[0]+5|0,0;case 6:return s[0]=s[0]+6|0,0;case 7:return s[0]=s[0]+7|0,0;case 8:return s[0]=s[0]+8|0,0}},n)},n);var c=a[0],s=i[0];if(c){if(s)return[e,c[0],s[0]];throw[be,"black king is missing"]}throw s?[be,"white king is missing"]:[be,"both kings are missing"]}function pe(r){return[[Gr(r,81),Gr(r,75)],[Gr(r,113),Gr(r,113)]]}function de(r){switch(r){case"b":return 0;case"w":return 1;default:throw[be,"whose move is it?"]}}function ye(r){if("-"===r)return 0;try{return[function(r){var n=r-97|0;if(n>7||n<0)throw[t,"not a file"];return n}(mr(r,0))]}catch(r){throw[be,"en passant square couldn't be parsed"]}}var ke=[be,function(r){var n=[7,[6,[5,[4,[3,[2,[1,[0,0]]]]]]]],t=Vr("/",xr(function(t){var e=function(n,e){for(;;){var u=e,a=n,i=a[1],c=a[0];if(!u)return[c,i];var o=u[1],s=f(f(r[0],u[0]),t);if(s){var v=s[0];if(e=o,i>0){n=[[qr(v,se),[mr("0123456789",i),c]],0];continue}n=[[qr(v,se),c],0]}else e=o,n=[c,i+1|0]}}([0,0],n),u=e[1],a=e[0];return fn(u>0?[mr("0123456789",u),a]:a)},n)),e=1+(r[9]/2|0)|0,u=r[4],a=u?h(xt([y(0,[y(0,[0])]),"%c%c"]),mr("abcdefgh",u[0]),1===r[1]?54:51):"-",i=r[2],c=0!==i[0]?0!==i[1]?"KQ":"Q":0!==i[1]?"K":"",o=r[3],s=c+(0!==o[0]?0!==o[1]?"kq":"q":0!==o[1]?"k":""),v=0!==r[1]?119:98;return w(xt([y(2,[0,y(12,[32,y(0,[y(12,[32,y(2,[0,y(12,[32,y(2,[0,y(12,[32,y(4,[0,0,0,y(12,[32,y(4,[0,0,0,0])])])])])])])])])])]),"%s %c %s %s %d %d"]),t,v,s,a,r[6],e)},we,pe,de,ye,function(r){var n=Jn(r.split(" "));if(n){var t=n[1];if(t){var e=t[1];if(e){var u=e[1];if(u){var a=u[1];if(a){var i=a[1];if(i){if(i[1])throw[be,"too many or missing fields"];var c,o,f=we(n[0]),s=pe(e[0]),v=de(t[0]);try{c=tr(a[0])}catch(r){throw[be,"halfmove clock couldn't be parsed"]}try{var l=tr(i[0])<<1;o=0!==v?l-2|0:l-1|0}catch(r){throw[be,"fullmove clock couldn't be parsed"]}return[f[0],v,s[0],s[1],ye(u[0]),0,c,f[1],f[2],o,0]}throw[be,"too many or missing fields"]}throw[be,"too many or missing fields"]}throw[be,"too many or missing fields"]}throw[be,"too many or missing fields"]}throw[be,"too many or missing fields"]}throw[be,"too many or missing fields"]}],_e=Mt,Ce=function(r){return It((n=r)>=97&&n<=122||n>=224&&n<=246||n>=248&&n<=254?n-32|0:n,Ot);var n},Ne=Lt,Ae=Xt,Se=ae,Fe=function(r){if((n=r)[6]>=100||function(r,n,t){for(;;){var e=t,u=n;if(e<=0)return 1;if(e<<1>u[6])return 0;var a=u[5];if(!a)return 0;var i=a[0];o=i,(c=r)[10]===o[10]&&c[1]===o[1]&&C(c[2],o[2])&&C(c[3],o[3])&&C(c[4],o[4])&&C(c[0],o[0])?(t=e-1|0,n=i):n=i}var c,o}(n,n,2))return 0;var n,t=ae(r);return t?y(1,[t]):ne(r,r[1])?y(0,[Mt(r[1])]):0};function xe(r){return function(n){return hn(function(n){return ln(r,function(r){var n=[r];return function(r){return vn(n,r)}},n)},function(r){return vn(0,r)},n)}}var Me=wr("Pgn.Ambiguous_move"),Oe=wr("Pgn.Parse_error"),Te=Cn(xn([34,0])),Ie=Nn(xn([32,0])),qe=dn(pn(Sn(34),Te),Sn(34)),De=dn(Ie,Nn(On));var Ee=Cn(dn(dn(pn(Sn(91),function(r){return ln(De,function(r){return function(n){return ln(qe,function(n){var t=[fn(r),fn(n)];return function(r){return vn(t,r)}},n)}},r)}),Sn(93)),In)),Le=wn(Fn([75,[81,[82,[66,[78,[80,0]]]]]]),Ce),Pe=kn(Mr(function(r,n){return pn(Sn(n),function(n){return vn(r,n)})},[97,[98,[99,[100,[101,[102,[103,[104,0]]]]]]]])),Re=kn(Mr(function(r,n){return pn(Sn(n),function(n){return vn(r,n)})},[49,[50,[51,[52,[53,[54,[55,[56,0]]]]]]]]));function Ue(r){return ln(Pe,function(r){return function(n){return ln(Re,function(n){var t=[r,n];return function(r){return vn(t,r)}},n)}},r)}var Be=Sn(120),Ve=Sn(43),Xe=Sn(35),Ge=pn(xe(Sn(61)),Le),Ke=wn(Nn(Fn([33,[63,0]])),fn),je=pn(Sn(36),wn(Nn(En),fn));function Je(r){return hn(je,Ke,r)}var Ze=Un("0-0"),ze=Un("O-O"),He=pn(function(r){return hn(ze,Ze,r)},function(r){return vn(1,r)}),We=Un("0-0-0"),Ye=Un("O-O-O"),Qe=pn(function(r){return hn(Ye,We,r)},function(r){return vn(0,r)});function $e(r){return hn(Qe,He,r)}function ru(r){return ln(Le,function(r){var n=xe(Pe);return function(t){return ln(n,function(n){var t=xe(Re);return function(e){return ln(t,function(t){return wn(pn(_n(Be),Ue),function(e){return y(0,[r,n,t,e])})},e)}},t)}},r)}function nu(r){return ln(Le,function(r){return wn(pn(_n(Be),Ue),function(n){return y(0,[r,0,0,n])})},r)}function tu(r){return ln(Ue,function(r){return wn(xe(Ge),function(n){return y(1,[0,r,n])})},r)}var eu=xe(Pe);function uu(r){return ln(eu,function(r){var n=pn(_n(Be),Ue);return function(t){return ln(n,function(n){return wn(xe(Ge),function(t){return y(1,[r,n,t])})},t)}},r)}var au=dn(function(r){return hn(function(r){return hn(function(r){return hn(function(r){return hn($e,ru,r)},nu,r)},tu,r)},uu,r)},_n(function(r){return hn(Ve,Xe,r)})),iu=wn(dn(pn(Sn(123),Cn(xn([125,0]))),Sn(125)),fn),cu=Un("."),ou=Un("..."),fu=Un(". ...");function su(r){return hn(fu,ou,r)}var vu=dn(Nn(En),function(r){return hn(su,cu,r)});function lu(){var r=Cn(Rn(iu));return function(n){return ln(r,function(r){var n=pn(xe(Rn(vu)),Rn(au));return function(t){return ln(n,function(n){var t=Cn(Rn(Je));return function(e){return ln(t,function(t){var e=Cn(Rn(iu));return function(u){return ln(e,function(e){var u=Cn(Rn(dn(pn(Sn(40),Rn(An(lu(),On))),Rn(Sn(41)))));return function(a){return ln(u,function(u){var a=[n,r,e,t,u];return function(r){return vn(a,r)}},a)}},u)}},e)}},t)}},n)}}var hu=pn(Un("*"),function(r){return vn(0,r)}),gu=[y(0,[0])],mu=pn(Un("0-1"),function(r){return vn(gu,r)}),bu=[0],wu=pn(Un("1/2"),function(r){return vn(bu,r)}),pu=[0],du=pn(Un("1/2-1/2"),function(r){return vn(pu,r)}),yu=[y(0,[1])],ku=pn(Un("1-0"),function(r){return vn(yu,r)});function _u(r){return hn(ku,du,r)}function Cu(r){return hn(_u,wu,r)}function Nu(r){return hn(Cu,mu,r)}function Au(r){return hn(Nu,hu,r)}var Su=dn(Rn(Ee),xe(In));function Fu(r){return ln(Su,function(r){var n=dn(An(lu(),On),Tn);return function(t){return ln(n,function(n){return function(t){return ln(Au,function(t){var e=[r,n,t];return function(r){return vn(e,r)}},t)}},t)}},r)}function xu(r,n){var t=Se(r),e=Dr(function(t){return function(r,n,t){if("number"==typeof n)return n?"number"==typeof t&&0===t?1:0:"number"==typeof t&&0!==t?1:0;if(n.tag){var e=n[2],u=n[1],a=u[1],i=u[0],c=n[0];if(e){if("number"==typeof t)return 0;if(1===t.tag){var o=t[1],s=0!==r[1]?7:0,v=0!==r[1]?6:1;return C(f(f(r[0],o),v),[[5,r[1]]])&&le(o,c)&&t[2]===i&&s===a?+(t[0]===e[0]):0}return 0}if("number"==typeof t)return 0;if(t.tag)return 0;var l=t[0];return C(f(f(r[0],l),t[1]),[[5,r[1]]])&&le(l,c)&&t[2]===i?+(t[3]===a):0}if("number"==typeof t)return 0;if(t.tag)return 0;var h=t[1],g=t[0],m=n[3];return C(f(f(r[0],g),h),[[n[0],r[1]]])&&le(g,n[1])&&le(h,n[2])&&t[2]===m[0]?+(t[3]===m[1]):0}(r,n,t)})(t);if(e){if(e[1])throw Me;return e[0]}throw Ae}function Mu(r){var n=function(r){return r?r[4]:0},e=function(r,t,e,u){var a=n(r),i=n(u);return[r,t,e,u,a>=i?a+1|0:i+1|0]},a=function(r,n){return[0,r,n,0,1]},c=function(r,u,a,i){var c=r?r[4]:0,o=i?i[4]:0;if(c>(o+2|0)){if(r){var f=r[3],s=r[2],v=r[1],l=r[0];if(n(l)>=n(f))return e(l,v,s,e(f,u,a,i));if(f)return e(e(l,v,s,f[0]),f[1],f[2],e(f[3],u,a,i));throw[t,"Map.bal"]}throw[t,"Map.bal"]}if(o>(c+2|0)){if(i){var h=i[3],g=i[2],m=i[1],b=i[0];if(n(h)>=n(b))return e(e(r,u,a,b),m,g,h);if(b)return e(e(r,u,a,b[0]),b[1],b[2],e(b[3],m,g,h));throw[t,"Map.bal"]}throw[t,"Map.bal"]}return[r,u,a,i,c>=o?c+1|0:o+1|0]},o=function(n,t,e){if(e){var u=e[3],a=e[2],i=e[1],f=e[0],s=h(r[0],n,i);return s?s<0?c(o(n,t,f),i,a,u):c(f,i,a,o(n,t,u)):[f,n,t,u,e[4]]}return[0,n,t,0,1]},f=function(r){for(;;){var n=r;if(n){var t=n[0];if(t){r=t;continue}return[n[1],n[2]]}throw u}},s=function(r){if(r){var n=r[0];return n?c(s(n),r[1],r[2],r[3]):r[3]}throw[t,"Map.remove_min_elt"]},v=function(n,t){if(t){var e=t[3],u=t[2],a=t[1],i=t[0],o=h(r[0],n,a);if(o)return o<0?c(v(n,i),a,u,e):c(i,a,u,v(n,e));var l=i,g=e;if(l){if(g){var m=f(g);return c(l,m[0],m[1],s(g))}return l}return g}return 0},m=function(r,n){for(;;){var t=n;if(!t)return 0;m(r,t[0]),h(r,t[1],t[2]),n=t[3]}},b=function(r,n){if(n){var t=b(r,n[0]),e=l(r,n[2]),u=b(r,n[3]);return[t,n[1],e,u,n[4]]}return 0},w=function(r,n){if(n){var t=n[1];return[w(r,n[0]),t,h(r,t,n[2]),w(r,n[3]),n[4]]}return 0},p=function(r,n,t){for(;;){var e=t,u=n;if(!u)return e;t=g(r,u[1],u[2],p(r,u[0],e)),n=u[3]}},d=function(r,n){for(;;){var t=n;if(t){if(h(r,t[1],t[2])){if(d(r,t[0])){n=t[3];continue}return 0}return 0}return 1}},y=function(r,n){for(;;){var t=n;if(!t)return 0;if(h(r,t[1],t[2]))return 1;if(y(r,t[0]))return 1;n=t[3]}},k=function(r,n,t){return t?c(k(r,n,t[0]),t[1],t[2],t[3]):a(r,n)},_=function(r,n,t){return t?c(t[0],t[1],t[2],_(r,n,t[3])):a(r,n)},C=function(r,n,t,u){if(r){if(u){var a=u[4],i=r[4];return i>(a+2|0)?c(r[0],r[1],r[2],C(r[3],n,t,u)):a>(i+2|0)?c(C(r,n,t,u[0]),u[1],u[2],u[3]):e(r,n,t,u)}return _(n,t,r)}return k(n,t,u)},N=function(r,n){if(r){if(n){var t=f(n);return C(r,t[0],t[1],s(n))}return r}return n},A=function(r,n,t,e){return t?C(r,n,t[0],e):N(r,e)},S=function(n,t){if(t){var e=t[3],u=t[2],a=t[1],i=t[0],c=h(r[0],n,a);if(c){if(c<0){var o=S(n,i);return[o[0],o[1],C(o[2],a,u,e)]}var f=S(n,e);return[C(i,a,u,f[0]),f[1],f[2]]}return[i,[u],e]}return[0,0,0]},F=function(r,t,e){var u=0;if(t){var a=t[1];if(t[4]>=n(e)){var c=S(a,e);return A(F(r,t[0],c[0]),a,g(r,a,[t[2]],c[1]),F(r,t[3],c[2]))}u=1}else{if(!e)return 0;u=1}if(1===u){if(e){var o=e[1],f=S(o,t);return A(F(r,f[0],e[0]),o,g(r,o,f[1],[e[2]]),F(r,f[2],e[3]))}throw[i,["map.ml",270,10]]}},x=function(r,n){if(n){var t=n[2],e=n[1],u=x(r,n[0]),a=h(r,e,t),i=x(r,n[3]);return a?C(u,e,t,i):N(u,i)}return 0},M=function(r,n){if(n){var t=n[2],e=n[1],u=M(r,n[0]),a=u[1],i=u[0],c=h(r,e,t),o=M(r,n[3]),f=o[1],s=o[0];return c?[C(i,e,t,s),N(a,f)]:[N(i,s),C(a,e,t,f)]}return[0,0]},O=function(r,n){for(;;){var t=n,e=r;if(!e)return t;n=[e[1],e[2],e[3],t],r=e[0]}},T=function(r){return r?(T(r[0])+1|0)+T(r[3])|0:0},I=function(r,n){for(;;){var t=n,e=r;if(!t)return e;n=t[0],r=[[t[1],t[2]],I(e,t[3])]}};return[0,function(r){return r?0:1},function(n,t){for(;;){var e=t;if(e){var u=h(r[0],n,e[1]);if(u){t=u<0?e[0]:e[3];continue}return 1}return 0}},o,a,v,F,function(n,t,e){for(var u=O(t,0),a=O(e,0);;){var i=a,c=u;if(c){if(i){var o=h(r[0],c[0],i[0]);if(0!==o)return o;var f=h(n,c[1],i[1]);if(0!==f)return f;a=O(i[2],i[3]),u=O(c[2],c[3]);continue}return 1}return i?-1:0}},function(n,t,e){for(var u=O(t,0),a=O(e,0);;){var i=a,c=u;if(c){if(i){if(h(r[0],c[0],i[0]))return 0;if(h(n,c[1],i[1])){a=O(i[2],i[3]),u=O(c[2],c[3]);continue}return 0}return 0}return i?0:1}},m,p,d,y,x,M,T,function(r){return I(0,r)},f,function(r){for(;;){var n=r;if(n){var t=n[3];if(t){r=t;continue}return[n[1],n[2]]}throw u}},f,S,function(n,t){for(;;){var e=t;if(e){var a=h(r[0],n,e[1]);if(a){t=a<0?e[0]:e[3];continue}return e[2]}throw u}},b,w]}function Ou(r,n,t,e){var u,a,i=n?n[0]:0,c=r.style;return void 0!==c.setProperty?c.setProperty(t,e,i?"important":null):(u=t,a=e,r.style[u]=a,0)}function Tu(r,n,t){return r.insertBefore(n,t)}function Iu(r,n,t,e){return""===n?r.setAttribute(t,e):r.setAttributeNS(n,t,e)}function qu(r,n){return""===r?document.createElement(n):document.createElementNS(r,n)}function Du(r,n,t,e,u,a){return y(2,[r,n,t,e,u,a])}function Eu(r,n,t){return y(3,[r,y(0,[n,t]),[0]])}function Lu(r,n){return y(3,[r,y(1,[n]),[0]])}function Pu(r){for(;;){var n=r;switch(0|n.tag){case 0:return"\x3c!-- "+n[0]+" --\x3e";case 1:return n[0];case 2:var t=n[1],e=n[0];return Vr("",["<",[e,[""===e?"":":",[t,[Vr("",xr(function(r){var n=r;if("number"==typeof n)return"";switch(0|n.tag){case 0:return Vr("",[" ",[n[0],['="',[n[1],['"',0]]]]]);case 1:return Vr("",[" ",[n[1],['="',[n[2],['"',0]]]]]);case 2:return Vr("",[" data-",[n[0],['="',[n[1],['"',0]]]]]);case 3:return"";case 4:return Vr("",[' style="',[Vr(";",xr(function(r){return Vr("",[r[0],[":",[r[1],[";",0]]]])},n[0])),['"',0]]])}},n[4])),[">",[Vr("",xr(Pu,n[5])),["</",[t,[">",0]]]]]]]]]]);case 3:r=l(n[1],0);continue;case 4:r=n[1];continue}}}function Ru(r){if(r.tag){var n=r[0];return function(){return[n]}}return r[1]}function Uu(r,n,t,e){var u,a,i,c,o,f=[Ru(e)],s=(u=r,a=f,function(r){var n=l(a[0],r);return n?l(u[0][0],n[0]):0});return i=t,c=s,o=0,n.addEventListener(i,c,o),[[s,f]]}function Bu(r,n,t){return t?(e=r,u=n,a=t[0][0],i=0,e.removeEventListener(u,a,i),0):0;var e,u,a,i}function Vu(r,n,t,e,u,a,i,c){var o,f,s=i[0];if(s){if(t===e){if(c[0]=i[0],o=u,(f=a).tag?!o.tag||!C(f[0],o[0]):o.tag||f[0]!==o[0]){var v=Ru(a);return s[0][1][0]=v,0}return 0}return i[0]=Bu(n,t,i[0]),c[0]=Uu(r,n,e,a),0}return c[0]=Uu(r,n,e,a),0}function Xu(r,t,e,u,a){return function(r,t,e,u){if("number"==typeof u)return 0;switch(0|u.tag){case 0:return t[u[0]]=void 0,0;case 1:return i=t,c=u[0],o=u[1],""===c?i.removeAttribute(o):i.removeAttributeNS(c,o);case 2:throw console.log(["TODO:  Remove Data Unhandled",u[0],u[1]]),[n,"TODO:  Remove Data Unhandled"];case 3:var a=u[2];return a[0]=Bu(t,u[0],a[0]),0;case 4:return Tr(function(r,n){return Ou(t,0,n[0],null)},0,u[0])}var i,c,o}(0,t,0,u),function(r,t,e,u){if("number"==typeof u)return 0;switch(0|u.tag){case 0:return t[u[0]]=u[1],0;case 1:return Iu(t,u[0],u[1],u[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",u[0],u[1]]),[n,"TODO:  Add Data Unhandled"];case 3:return u[2][0]=Uu(r,t,u[0],u[1]),0;case 4:Tr(function(r,n){return Ou(t,0,n[0],n[1])},0,u[0])}}(r,t,0,a),0}function Gu(r,e,u,a,i){if("number"==typeof i)throw[n,"This should never be called as all entries through NoProp are gated."];switch(0|i.tag){case 0:return e[i[0]]=i[1],0;case 1:return Iu(e,i[0],i[1],i[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",i[0],i[1]]),[n,"TODO:  Mutate Data Unhandled"];case 3:throw[n,"This will never be called because it is gated"];case 4:if("number"==typeof a)throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===a.tag)return function(r,n,e,u){for(;;){var a=u,i=e,c=n;if(i){if(a){u=a[1],e=i[1],n=g(r,c,i[0],a[0]);continue}throw[t,"List.fold_left2"]}if(a)throw[t,"List.fold_left2"];return c}}(function(r,n,t){var u=t[1],a=t[0],i=n[0];return i===a?n[1]===u?0:Ou(e,0,a,u):(Ou(e,0,i,null),Ou(e,0,a,u))},0,a[0],i[0]);throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function Ku(r,n,t,e){return function(r,n,t,e,u){for(;;){var a=u,i=e,c=t;if(!i)return a?0:1;var o=i[0],f=0;if(!a)return 0;if("number"==typeof o){if("number"==typeof a[0]){u=a[1],e=i[1],t=c+1|0;continue}f=1}else switch(0|o.tag){case 0:var s=a[0];if("number"==typeof s)f=1;else{if(!s.tag){o[0]===s[0]&&o[1]===s[1]||Gu(0,n,0,o,s),u=a[1],e=i[1],t=c+1|0;continue}f=1}break;case 1:var v=a[0];if("number"==typeof v)f=1;else{if(1===v.tag){o[0]===v[0]&&o[1]===v[1]&&o[2]===v[2]||Gu(0,n,0,o,v),u=a[1],e=i[1],t=c+1|0;continue}f=1}break;case 2:var l=a[0];if("number"==typeof l)f=1;else{if(2===l.tag){o[0]===l[0]&&o[1]===l[1]||Gu(0,n,0,o,l),u=a[1],e=i[1],t=c+1|0;continue}f=1}break;case 3:var h=a[0];if("number"==typeof h)f=1;else{if(3===h.tag){Vu(r,n,o[0],h[0],o[1],h[1],o[2],h[2]),u=a[1],e=i[1],t=c+1|0;continue}f=1}break;case 4:var g=a[0];if("number"==typeof g)f=1;else{if(4===g.tag){C(o[0],g[0])||Gu(0,n,0,o,g),u=a[1],e=i[1],t=c+1|0;continue}f=1}}1!==f||(Xu(r,n,0,o,a[0]),u=a[1],e=i[1],t=c+1|0)}}(r,n,0,t,e)}function ju(r,t,e,u,i){if(2===i.tag){var c=i[4],o=f(e,u),s=qu(i[0],i[1]);if(0!==Ku(r,s,xr(function(){return 0},c),c))return zu(r,s,s.childNodes,0,0,i[5]),Tu(t,s,o),t.removeChild(o),0;throw[a,["/Users/daniel/Projects/tea-chess/node_modules/bucklescript-tea/src/vdom.ml",319,30]]}throw[n,"Node replacement should never be passed anything but a node itself"]}function Ju(r,n){for(;;){var t=n,e=r;switch(0|t.tag){case 0:var u=t[0];return document.createComment(u);case 1:var i=t[0];return document.createTextNode(i);case 2:var c=t[4],o=qu(t[0],t[1]);if(0!==Ku(e,o,xr(function(){return 0},c),c))return zu(e,o,o.childNodes,0,0,t[5]),o;throw[a,["/Users/daniel/Projects/tea-chess/node_modules/bucklescript-tea/src/vdom.ml",333,30]];case 3:var f=l(t[1],0);t[2][0]=f,n=f;continue;case 4:n=t[1],r=l(t[0],e);continue}}}function Zu(r,t,e,u,a,i){if(2===a.tag){if(2===i.tag){if(a[3]!==i[3]||a[1]!==i[1])return ju(r,t,e,u,i);var c=f(e,u),o=c.childNodes;return Ku(r,c,a[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),ju(r,t,e,u,i)),zu(r,c,o,0,a[5],i[5])}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}function zu(r,n,t,e,u,a){for(;;){var i=a,c=u,o=e;if(!c){if(i){var s=Ju(r,i[0]);n.appendChild(s),a=i[1],u=0,e=o+1|0;continue}return 0}var v=c[0],h=0;switch(0|v.tag){case 0:if(i){var g=i[0];if(g.tag)h=1;else{if(v[0]===g[0]){a=i[1],u=c[1],e=o+1|0;continue}h=1}}else h=1;break;case 1:if(i){var m=i[0];if(1===m.tag){var b=m[0];if(v[0]!==b)f(t,o).nodeValue=b;a=i[1],u=c[1],e=o+1|0;continue}h=1}else h=1;break;case 2:if(i){var w=i[0];if(2===w.tag){var p=i[1],d=w[2],y=w[1],k=w[0],_=c[1],C=v[2],N=v[1],A=v[0];if(C===d&&""!==C){a=p,u=_,e=o+1|0;continue}if(""===C||""===d){Zu(r,n,t,o,v,w),a=p,u=_,e=o+1|0;continue}var S=0,F=0;if(_){var x=_[0];if(2===x.tag){var M=_[1],O=x[2],T=x[1],I=x[0],q=0;if(p){var D=p[0];if(2===D.tag){if(I===k&&T===y&&O===d&&A===D[0]&&N===D[1]&&C===D[2]){var E=f(t,o),L=f(t,o+1|0);n.removeChild(L),Tu(n,L,E),a=p[1],u=M,e=o+2|0;continue}q=4}else q=4}else q=4;if(4===q){if(I===k&&T===y&&O===d){var P=f(t,o);n.removeChild(P),a=p,u=M,e=o+1|0;continue}F=3}}else F=3}else F=3;if(3===F)if(p){var R=p[0];if(2===R.tag){if(A===R[0]&&N===R[1]&&C===R[2]){var U=f(t,o);Tu(n,Ju(r,w),U),a=p,e=o+1|0;continue}S=2}else S=2}else S=2;if(2===S){Zu(r,n,t,o,v,w),a=p,u=_,e=o+1|0;continue}}else h=1}else h=1;break;case 3:if(i){var B=i[0];if(3===B.tag){var V=i[1],X=B[2],G=B[1],K=B[0],j=c[1],J=v[2],Z=v[0];if(Z===K){X[0]=J[0],a=V,u=j,e=o+1|0;continue}var z=0,H=0;if(j){var W=j[0];if(3===W.tag){var Y=j[1],Q=W[0],$=0;if(V){var rr=V[0];if(3===rr.tag){if(Q===K&&Z===rr[0]){var nr=f(t,o),tr=f(t,o+1|0);n.removeChild(tr),Tu(n,tr,nr),a=V[1],u=Y,e=o+2|0;continue}$=4}else $=4}else $=4;if(4===$){if(Q===K){var er=f(t,o);n.removeChild(er);var ur=W[2][0];X[0]=ur,a=V,u=Y,e=o+1|0;continue}H=3}}else H=3}else H=3;if(3===H)if(V){var ar=V[0];if(3===ar.tag){if(ar[0]===Z){var ir=f(t,o),cr=l(G,0);X[0]=cr,Tu(n,Ju(r,cr),ir),a=V,e=o+1|0;continue}z=2}else z=2}else z=2;if(2===z){var or=J[0],fr=l(G,0);X[0]=fr,a=[fr,V],u=[or,j];continue}}else h=1}else h=1;break;case 4:u=[v[1],c[1]];continue}if(1!==h);else{var sr=c[1];if(i){var vr=i[0];if(4===vr.tag){zu(l(vr[0],r),n,t,o,[v,0],[vr[1],0]),a=i[1],u=sr,e=o+1|0;continue}var lr=f(t,o);Tu(n,Ju(r,vr),lr),n.removeChild(lr),a=i[1],u=sr,e=o+1|0;continue}var hr=f(t,o);n.removeChild(hr),a=0,u=sr}}}function Hu(r){return y(1,[r])}function Wu(r,n,t,e,u,a){return Du(r?r[0]:"",n,t?t[0]:"",e?e[0]:"",u,a)}function Yu(r,n,t,e){return Du("","div",r?r[0]:"",n?n[0]:"",t,e)}function Qu(r,n,t,e){return Du("","span",r?r[0]:"",n?n[0]:"",t,e)}function $u(r,n,t,e){return Du("","p",r?r[0]:"",n?n[0]:"",t,e)}function ra(r,n,t,e){return Du("","a",r?r[0]:"",n?n[0]:"",t,e)}function na(r,n,t,e){return Du("","section",r?r[0]:"",n?n[0]:"",t,e)}function ta(r,n,t,e){return Du("","button",r?r[0]:"",n?n[0]:"",t,e)}function ea(r,n,t,e){return Du("","input",r?r[0]:"",n?n[0]:"",t,e)}function ua(r,n,t,e){return Du("","label",r?r[0]:"",n?n[0]:"",t,e)}function aa(r,n,t,e){return Du("","ul",r?r[0]:"",n?n[0]:"",t,e)}function ia(r,n,t,e){return Du("","li",r?r[0]:"",n?n[0]:"",t,e)}function ca(r,n,t,e){return Du("","td",r?r[0]:"",n?n[0]:"",t,e)}function oa(r,n,t,e){return Du("","option",r?r[0]:"",n?n[0]:"",t,e)}function fa(r,n,t,e){return Du("","nav",r?r[0]:"",n?n[0]:"",t,e)}function sa(r){return y(0,["id",r])}function va(r){return y(1,["","href",r])}function la(r){return y(0,["className",r])}function ha(r){return y(0,["className",Vr(" ",xr(function(r){return r[0]},Dr(function(r){return r[1]})(r)))])}function ga(r){return y(0,["type",r])}var ma=function(r,n){return y(4,[[[r,n],0]])};function ba(r){return y(0,["value",r])}function wa(r){return y(0,["htmlFor",r])}var pa=Eu;function da(r,n){var t,e,u=r?r[0]:"";return e=function(r){return[l(n,r)]},Eu("change",(t=[u])?t[0]:"",function(r){var n=r.target;if(void 0!==n){var t=n.value;return void 0!==t?l(e,t):0}return 0})}function ya(r){return Lu("click",r)}function ka(r,n){var t,e,u=r?r[0]:"";return e=function(r){return[l(n,r)]},Eu("change",(t=[u])?t[0]:"",function(r){var n=r.target;if(void 0!==n){var t=n.checked;return void 0!==t?l(e,t):0}return 0})}var _a=[function(r){return y(1,["","max",r])},function(r){return y(1,["","min",r])},function(r){return y(1,["","step",r])},function(r){return r?y(1,["","disabled","true"]):0},function(r){return r?y(1,["","selected","true"]):0},function(r){return y(1,["","accept-charset",r])},function(r){return y(1,["","rel",r])}],Ca=y(0,[""]),Na=0;function Aa(r,n,t){return l(n,l(r,t))}var Sa=[_],Fa=[_],xa=Mu(Sa),Ma=Mu(Fa);var Oa=[function(r){var n=Mu(Sa);return[l(n[21],r),l(n[3],r)]}];function Ta(r,n){return ta(0,0,[ya(r),0],[Hu(n),0])}var Ia=[function(r,n){return n?[l(r,n[0])]:0},function(r,n){return n?n[0]:r},function(r,n,t){return t?l(r,t[0]):n},function(r){if(r)return r[0];throw[t,"Option.get"]}],qa=wr("Zipper.End_of_list"),Da=wr("Zipper.Beginning_of_list");function Ea(r){return r}var La=wr("Zipper.No_variations"),Pa=wr("Zipper.No_next_variation"),Ra=wr("Zipper.No_prev_variation"),Ua=wr("Zipper.Not_in_variation"),Ba=wr("Zipper.Not_beginning_of_list");function Va(r){var n=r[0],t=n[1];if(t)return[[n[0],t[1]],[t[0],r[1]]];throw Da}function Xa(r){var n=r[0],t=n[1];if(t){var e=t[0],u=e[1];if(u){var a=u[0],i=a[0];return[i,[[[[n[0],t[1]],e[0],0,i,u[1],r[1]],0],a[1]]]}throw La}throw Da}function Ga(r){var n=r[0],t=n[0];if(n[1])throw Ba;if(t){var e=t[4];if(e){var u=e[0],a=u[0];return[a,[[[t[0],t[1],[[t[3],r[1]],t[2]],a,e[1],t[5]],0],u[1]]]}throw Pa}throw Pa}function Ka(r){var n=r[0],t=n[0];if(n[1])throw Ba;if(t){var e=t[2];if(e){var u=e[0],a=u[0];return[a,[[[t[0],t[1],e[1],a,[[t[3],r[1]],t[4]],t[5]],0],u[1]]]}throw Ra}throw Ra}function ja(r){var n=r[0],t=n[0];if(n[1])throw Ba;if(t){var e=t[1],u=t[0],a=[e,Sr(t[2],[[t[3],r[1]],t[4]])];return[e,[[u[0],[a,u[1]]],t[5]]]}throw Ua}function Ja(r,n){return function(t,e){for(var u=Ea,a=t,i=e;;){var c=i,o=a,f=u;if(!c)return l(f,0);var s=c[0],v=l(n,o);i=c[1],a=v,u=function(n,t,e){return function(u){return l(n,[h(r,t,e),u])}}(f,o,s)}}}function Za(r,n,t,e,u){return Tr(function(t,e){var u=t[1];return[[h(r,u,e),t[0]],l(n,u)]},[u,t],e)}function za(r,n,t,e,u,a,i,c,o,f,s,v,m){var b=m[0],w=function(r,n){return g(u,r,n[0],p(r,n[1]))},p=function(r,n){return l(e,Ja(d,s)(l(f,r),n))},d=function(r,a){return l(t,l(n,[g(u,r,a[0],l(e,0)),y(l(i,r),a[1])]))},y=function(r,n){return Ja(w,i)(r,n)},k=function(r,n){return function(t){return Za(w,c,r,n,t)}},_=function(a,f,m){if(f){var b=l(t,l(n,[g(u,a,f[3],l(e,0)),m])),w=l(o,a),p=[f[0],f[5]],C=g(u,l(o,a),f[1],l(e,Za(d,v,l(v,a),f[2],[b,Ja(d,s)(l(s,a),f[4])])[0])),N=p[0],A=k(l(c,w),N[1])([C,y(l(i,w),p[1])]);return _(A[1],N[0],A[0])}return h(r,a,m)},C=k(a,b[1])(y(l(i,a),m[1]));return l(n,_(C[1],b[0],C[0]))}function Ha(r){return y(2,[function(n){return l(n[0][0],r)}])}function Wa(r,n){if("number"==typeof n)return 0;switch(0|n.tag){case 1:return Tr(function(n,t){return Wa(r,t)},0,n[0]);case 0:case 2:return l(n[0],r)}}function Ya(r,n){return y(0,[function(t){return Wa((e=r,u=t,[[function(r){return l(u[0][0],l(e,r))}]]),n);var e,u}])}var Qa=0;var $a=[Ne,[[0,0],0],0,0],ri=wr("Game.No_prev_position");function ni(r){var n=r[0][5];if(!n)throw ri;var t=n[0];try{return[t,Va(r[1]),r[2],r[3]]}catch(n){if(n===Da)return[t,Va(ja(r[1])[1]),r[2],r[3]];throw n}}function ti(r){try{var n=function(r){var n=r[1];if(n){var t=n[0],e=r[0];return[t[0],[[e[0],[t,e[1]]],n[1]]]}throw qa}(r[1]);return[fe(r[0],n[0][0]),n[1],r[2],r[3]]}catch(n){if(n===qa)return r;throw n}}function ei(r,n){var t=me(n[0],r),e=function(r,n){var t=n[1],e=n[0],u=e[1],a=e[0];if(t){var i=t[1],c=t[0],o=c[0];return C(o,r)?[1,[[a,[c,u]],i]]:[1,function(r,n,t){for(;;){var e=t,c=n;if(!e)return[[[[a,u],o,c,r,e,i],0],0];var f=e[0],s=f[0];if(C(r,s)){var v=[a,u],l=e[1];return[[[v,o,c,s,l,i],0],f[1]]}t=e[1],n=[f,c]}}(r,0,c[1])]}return[0,[[a,[[r,0],u]],0]]}([r,t,0,0],n[1]);return[fe(n[0],r),e[1],n[2],n[3]]}function ui(r,n){try{var t=l(r,n[1]),e=n[0][5];if(e)return[fe(e[0],t[0][0]),t[1],n[2],n[3]];throw ri}catch(r){return n}}function ai(r){return ui(Ga,r)}function ii(r){return ui(Ka,r)}function ci(r){return ui(Xa,r)}function oi(r){return ui(ja,r)}function fi(r){return r}function si(r){return Tr(function(r,n){var t=function(r){switch(r){case 0:return ti;case 1:return ni;case 2:return ci;case 3:return ai;case 4:return ii;case 5:return oi}}(n);return function(n){return l(r,l(t,n))}},fi,r)}function vi(r){if(r){var n=r[0];return"number"==typeof n?"1/2-1/2":n.tag?"*":0!==n[0]?"1-0":"0-1"}return"*"}function li(r){var n,e,a,i=function(r,n){if(n){var t=o(r,n[0]);return[t[0],i(t[1],n[1])]}return 0},c=function(r,n){var t=xu(r,n[0]);return[[t,me(r,t),n[1],n[2]],fe(r,t)]},o=function(r,n){var t=xr(function(n){var t=n;if(t){var e=c(r,t[0]);return[e[0],i(e[1],t[1])]}throw Oe},n[4]),e=c(r,n);return[[e[0],t],e[1]]};try{n=Ia[3]((e=r,sn(Fu,on[2](e))))}catch(r){var f=Vn(r);throw f[0]===t?Oe:f}try{a=[qr("FEN",n[0])]}catch(r){if(r!==u)throw r;a=0}var s=Ia[2](ke[6],Ne,a);return[s,[[0,0],i(s,n[1])],n[0],n[2]]}function hi(r){try{return[li(r)]}catch(r){return 0}}function gi(r,n){if("number"==typeof n){if(n){var t;try{t=ti(r)}catch(n){t=r}return[t,Qa]}var e;try{e=ni(r)}catch(n){e=r}return[e,Qa]}return n.tag?[l(si(n[0]),r),Qa]:[ei(n[0],r),Qa]}function mi(r){var n=[r[0][9]-1|0,0],t=[la("moves"),0],e=function(r){return Qu(0,0,[la("comment"),0],[Hu(r),0])};return za(function(r,n){return[(t=r,ia(0,0,[ha([["move",1],[["home",1],[["highlight",+(0===t[1])],0]]]),0],[Qu(0,0,[la("move"),[ya(y(1,[t[1]])),0]],[Hu(""),0]),0])),n];var t},function(r){return aa(0,0,t,r)},function(r){return ia(0,0,[la("variation"),0],[r,0])},function(r){return r?(n=0,t=0,e=[la("variations"),0],u=r,Du("","ol",n?n[0]:"",t?t[0]:"",e,u)):Ca;var n,t,e,u},function(r,n,t){var u=1+(r[0]/2|0)|0,a=+(r[0]%2==0);return ia(0,0,[ha([["move",1],[["white",a],[["black",1-a],[["variations",N(t,Ca)],[["highlight",+(0===r[1])],0]]]]]),0],[Qu(0,0,[la("comments"),0],xr(e,n[2])),[Qu(0,0,[la("number"),0],[Hu(Cr(u)),0]),[Qu(0,0,[la("move"),[ya(y(1,[r[1]])),0]],[Hu(n[1]),0]),[Qu(0,0,[la("comments"),0],xr(e,n[3])),[t,0]]]]])},n,function(r){return[r[0]+1|0,[0,r[1]]]},function(r){return[r[0]-1|0,[1,r[1]]]},function(r){return[r[0],[5,r[1]]]},function(r){return[r[0],[2,r[1]]]},function(r){return[r[0],[3,r[1]]]},function(r){return[r[0],[4,r[1]]]},r[1])}function bi(r){return Yu(0,0,[la("pgn"),0],[(t=r[2],aa(0,0,[la("pgnheader"),0],xr(function(r){return ia(0,0,0,[ua(0,0,0,[Qu(0,0,0,[Hu(r[0]),0]),0]),[Qu(0,0,0,[Hu(r[1]),0]),0]])},Dr(function(r){var n=r[0];return"White"===n?1:+("Black"===n)})(t)))),[mi(r),[(n=r[3],$u(0,0,[la("result"),0],[Hu(vi(n)),0])),0]]]);var n,t}var wi=2147483647,pi=[2147483647,4294967295];function di(r,n,t,e,u,a){var i=((n+r|0)+e|0)+a|0;return(i<<u|i>>>(32-u|0)|0)+t|0}function yi(r,n,t,e,u,a,i){return di(n&t|(-1^n)&e,r,n,u,a,i)}function ki(r,n,t,e,u,a,i){return di(n&e|t&(-1^e),r,n,u,a,i)}function _i(r,n,t,e,u,a,i){return di(n^t^e,r,n,u,a,i)}function Ci(r,n,t,e,u,a,i){return di(t^(n|-1^e),r,n,u,a,i)}function Ni(r,n){var t=r[0],e=r[1],u=r[2],a=r[3];return e=Ci(e=Ci(e=Ci(e=Ci(e=_i(e=_i(e=_i(e=_i(e=ki(e=ki(e=ki(e=ki(e=yi(e=yi(e=yi(e=yi(e,u=yi(u,a=yi(a,t=yi(t,e,u,a,n[0],7,-680876936),e,u,n[1],12,-389564586),t,e,n[2],17,606105819),a,t,n[3],22,-1044525330),u=yi(u,a=yi(a,t=yi(t,e,u,a,n[4],7,-176418897),e,u,n[5],12,1200080426),t,e,n[6],17,-1473231341),a,t,n[7],22,-45705983),u=yi(u,a=yi(a,t=yi(t,e,u,a,n[8],7,1770035416),e,u,n[9],12,-1958414417),t,e,n[10],17,-42063),a,t,n[11],22,-1990404162),u=yi(u,a=yi(a,t=yi(t,e,u,a,n[12],7,1804603682),e,u,n[13],12,-40341101),t,e,n[14],17,-1502002290),a,t,n[15],22,1236535329),u=ki(u,a=ki(a,t=ki(t,e,u,a,n[1],5,-165796510),e,u,n[6],9,-1069501632),t,e,n[11],14,643717713),a,t,n[0],20,-373897302),u=ki(u,a=ki(a,t=ki(t,e,u,a,n[5],5,-701558691),e,u,n[10],9,38016083),t,e,n[15],14,-660478335),a,t,n[4],20,-405537848),u=ki(u,a=ki(a,t=ki(t,e,u,a,n[9],5,568446438),e,u,n[14],9,-1019803690),t,e,n[3],14,-187363961),a,t,n[8],20,1163531501),u=ki(u,a=ki(a,t=ki(t,e,u,a,n[13],5,-1444681467),e,u,n[2],9,-51403784),t,e,n[7],14,1735328473),a,t,n[12],20,-1926607734),u=_i(u,a=_i(a,t=_i(t,e,u,a,n[5],4,-378558),e,u,n[8],11,-2022574463),t,e,n[11],16,1839030562),a,t,n[14],23,-35309556),u=_i(u,a=_i(a,t=_i(t,e,u,a,n[1],4,-1530992060),e,u,n[4],11,1272893353),t,e,n[7],16,-155497632),a,t,n[10],23,-1094730640),u=_i(u,a=_i(a,t=_i(t,e,u,a,n[13],4,681279174),e,u,n[0],11,-358537222),t,e,n[3],16,-722521979),a,t,n[6],23,76029189),u=_i(u,a=_i(a,t=_i(t,e,u,a,n[9],4,-640364487),e,u,n[12],11,-421815835),t,e,n[15],16,530742520),a,t,n[2],23,-995338651),u=Ci(u,a=Ci(a,t=Ci(t,e,u,a,n[0],6,-198630844),e,u,n[7],10,1126891415),t,e,n[14],15,-1416354905),a,t,n[5],21,-57434055),u=Ci(u,a=Ci(a,t=Ci(t,e,u,a,n[12],6,1700485571),e,u,n[3],10,-1894986606),t,e,n[10],15,-1051523),a,t,n[1],21,-2054922799),u=Ci(u,a=Ci(a,t=Ci(t,e,u,a,n[8],6,1873313359),e,u,n[15],10,-30611744),t,e,n[6],15,-1560198380),a,t,n[13],21,1309151649),u=Ci(u,a=Ci(a,t=Ci(t,e,u,a,n[4],6,-145523070),e,u,n[11],10,-1120210379),t,e,n[2],15,718787259),a,t,n[9],21,-343485551),r[0]=t+r[0]|0,r[1]=e+r[1]|0,r[2]=u+r[2]|0,r[3]=a+r[3]|0,0}var Ai=[1732584193,-271733879,-1732584194,271733878],Si=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function Fi(r){return function(r,n,t){var e=r.slice(n,t),u=e.length;Ai[0]=1732584193,Ai[1]=-271733879,Ai[2]=-1732584194,Ai[3]=271733878;for(var a=0;a<=15;++a)Si[a]=0;for(var i=u/64|0,c=1;c<=i;++c){for(var o=0;o<=15;++o){var f=((c<<6)-64|0)+(o<<2)|0;Si[o]=((e.charCodeAt(f)+(e.charCodeAt(f+1|0)<<8)|0)+(e.charCodeAt(f+2|0)<<16)|0)+(e.charCodeAt(f+3|0)<<24)|0}Ni(Ai,Si)}for(var s=e.slice(i<<6),v=0;v<=15;++v)Si[v]=0;for(var l=s.length-1|0,h=0;h<=l;++h)Si[h/4|0]=Si[h/4|0]|s.charCodeAt(h)<<(h%4<<3);var g=l+1|0;if(Si[g/4|0]=Si[g/4|0]|128<<(g%4<<3),g>55){Ni(Ai,Si);for(var m=0;m<=15;++m)Si[m]=0}return Si[14]=u<<3,Ni(Ai,Si),String.fromCharCode(255&Ai[0],Ai[0]>>8&255,Ai[0]>>16&255,Ai[0]>>24&255,255&Ai[1],Ai[1]>>8&255,Ai[1]>>16&255,Ai[1]>>24&255,255&Ai[2],Ai[2]>>8&255,Ai[2]>>16&255,Ai[2]>>24&255,255&Ai[3],Ai[3]>>8&255,Ai[3]>>16&255,Ai[3]>>24&255)}(r,0,r.length)}function xi(r,n){return function(r,n,e,u,a){if(a<0||n<0||n>(r.length-a|0)||u<0||u>(e.length-a|0))throw[t,"Array.blit"];(function(r,n,t,e,u){if(e<=n){for(var a=0,i=u-1|0;a<=i;++a)t[a+e|0]=r[a+n|0];return 0}for(var c=u-1|0;c>=0;--c)t[c+e|0]=r[c+n|0]})(r,n,e,u,a)}(n[0],0,r[0],0,55),r[1]=n[1],0}function Mi(r,n){for(var t=n.length?n:[0],e=t.length,u=0;u<=54;++u)o(r[0],u,u);for(var a,i,c,s="x",v=0,l=54+kr(55,e)|0;v<=l;++v){var h=v%55;i=s,c=f(t,v%e),s=Fi(i+c),o(r[0],h,1073741823&(f(r[0],h)^(((mr(a=s,0)+(mr(a,1)<<8)|0)+(mr(a,2)<<16)|0)+(mr(a,3)<<24)|0)))}return r[1]=0,0}function Oi(r){var n=[s(55,0),0];return Mi(n,r),n}function Ti(r){var n=[s(55,0),0];return xi(n,r),n}function Ii(r){r[1]=(r[1]+1|0)%55;var n=f(r[0],r[1]),t=1073741823&(f(r[0],(r[1]+24|0)%55)+(n^n>>>25&31)|0);return o(r[0],r[1],t),t}function qi(r,n){if(n<=0)throw[t,"Random.int32"];for(var e=r,u=n;;){var a=Ii(e)|(1&Ii(e))<<30,i=a%u;if(!((a-i|0)>(1+(wi-u|0)|0)))return i}}function Di(r,n){if(1-j(n,[0,0]))throw[t,"Random.int64"];for(var e=r,u=n;;){var a=$(Ii(e)),i=U($(Ii(e)),30),c=U($(7&Ii(e)),60),o=(l=a,h=[i[0]|c[0],(i[1]|c[1])>>>0],[l[0]|h[0],(l[1]|h[1])>>>0]),f=E(s=o,P(V(Y(s,v=u),v)));if(!j(R(o,f),E(R(pi,u),[0,1])))return f}var s,v,l,h}var Ei=[[987910699,495797812,364182224,414272206,318284740,990407751,383018966,270373319,840823159,24560019,536292337,512266505,189156120,730249596,143776328,51606627,140166561,366354223,1003410265,700563762,981890670,913149062,526082594,1021425055,784300257,667753350,630144451,949649812,48546892,415514493,258888527,511570777,89983870,283659902,308386020,242688715,482270760,865188196,1027664170,207196989,193777847,619708188,671350186,149669678,257044018,87658204,558145612,183450813,28133145,901332182,710253903,510646120,652377910,409934019,801085050],0];var Li=[Oi,function(){return Oi(S())},Ti,Ii,function(r,n){if(n>1073741823||n<=0)throw[t,"Random.int"];for(var e=r,u=n;;){var a=Ii(e),i=a%u;if(!((a-i|0)>(1+(1073741823-u|0)|0)))return i}},qi,function(r,n){return 0|Di(r,$(n))[1]},Di,function(r,n){return(Ii(t=r)/1073741824+Ii(t))/1073741824*n;var t},function(r){return+(0==(1&Ii(r)))}];y(246,[function(){return Li[1](0)}]);function Pi(r,n,t){var e=l(n,l(r[0],t));return h(r[1],e,t)}function Ri(r,n){var t=r[0],e=n[0],u=r[1];return[function(r){return l(t,l(e,r))},function(r){var t=l(u,r);return function(r){return Pi(n,t,r)}}]}var Ui=[function(r,n){return l(n[0],r)},function(r,n,t){return h(r[1],n,t)},Pi,function(r,n){return Ri(n,r)},Ri,function(r,n){return[function(t){return[l(r[0],t[0]),l(n[0],t[1])]},function(t,e){return[h(r[1],t[0],e[0]),h(n[1],t[1],e[1])]}]},function(r,n){return function(t){return Pi(r,function(r){return n+r|0},t)}},function(r,n){return function(t){return Pi(r,function(r){return n-r|0},t)}}];function Bi(r){return y(0,[r])}function Vi(r,n){return y(1,[r,function(r){return l(n,r[0])},[0]])}function Xi(r,n,t,e){var u=function(r,n){for(;;){var t=n,e=r;if("number"==typeof t)return 0;switch(0|t.tag){case 0:var a=t[0];return a?Or(function(r){return function(n){return u(r,n)}}(e),a):0;case 1:return t[2][0]=[l(t[1],e)],0;case 2:var i=l(t[0],e);n=t[1],r=i;continue}}},a=function(r,n){for(;;){var t=n,e=r;if("number"==typeof t)return 0;switch(0|t.tag){case 0:var u=t[0];return u?Or(function(r){return function(n){return a(r,n)}}(e),u):0;case 1:var i=t[2],c=i[0];return c?(i[0]=0,l(c[0],0)):0;case 2:var o=l(t[0],e);n=t[1],r=o;continue}}},i=0;if("number"==typeof t){if("number"==typeof e)return e;i=1}else switch(0|t.tag){case 0:if("number"==typeof e)i=1;else{if(!e.tag){return function(t,e){for(;;){var i=e,c=t;if(c){var o=c[1],f=c[0];if(i){Xi(r,n,f,i[0]),e=i[1],t=o;continue}a(r,f),e=0,t=o}else{if(!i)return 0;u(n,i[0]),e=i[1],t=0}}}(t[0],e[0]),e}i=1}break;case 1:if("number"==typeof e)i=1;else if(1===e.tag){if(t[0]===e[0])return e[2][0]=t[2][0],e;i=1}else i=1;break;case 2:if("number"==typeof e)i=1;else{if(2===e.tag)return Xi(l(t[0],r),l(e[0],n),t[1],e[1]),e;i=1}}if(1===i)return a(r,t),u(n,e),e}var Gi=0;var Ki=function(r){var n=typeof r;return"string"===n?y(0,[r]):"number"===n?y(1,[r]):"boolean"===n?!0===r?1:0:null===r?2:Array.isArray(r)?y(3,[r]):y(2,[r])};function ji(r,n){return n.tag?n:r}function Ji(r){return r?r[4]:0}function Zi(r,n,t,e){var u=Ji(r),a=Ji(e);return[r,n,t,e,u>=a?u+1|0:a+1|0]}function zi(r,n){return[0,r,n,0,1]}function Hi(r,n,e,u){var a=r?r[4]:0,i=u?u[4]:0;if(a>(i+2|0)){if(r){var c=r[3],o=r[2],f=r[1],s=r[0];if(Ji(s)>=Ji(c))return Zi(s,f,o,Zi(c,n,e,u));if(c)return Zi(Zi(s,f,o,c[0]),c[1],c[2],Zi(c[3],n,e,u));throw[t,"Map.bal"]}throw[t,"Map.bal"]}if(i>(a+2|0)){if(u){var v=u[3],l=u[2],h=u[1],g=u[0];if(Ji(v)>=Ji(g))return Zi(Zi(r,n,e,g),h,l,v);if(g)return Zi(Zi(r,n,e,g[0]),g[1],g[2],Zi(g[3],h,l,v));throw[t,"Map.bal"]}throw[t,"Map.bal"]}return[r,n,e,u,a>=i?a+1|0:i+1|0]}function Wi(r,n,t){if(t){var e=t[3],u=t[2],a=t[1],i=t[0],c=sr(r,a);return c?c<0?Hi(Wi(r,n,i),a,u,e):Hi(i,a,u,Wi(r,n,e)):[i,r,n,e,t[4]]}return[0,r,n,0,1]}function Yi(r){for(;;){var n=r;if(n){var t=n[0];if(t){r=t;continue}return[n[1],n[2]]}throw u}}function Qi(r){if(r){var n=r[0];return n?Hi(Qi(n),r[1],r[2],r[3]):r[3]}throw[t,"Map.remove_min_elt"]}function $i(r,n,t,e){if(r){if(e){var u=e[4],a=r[4];return a>(u+2|0)?Hi(r[0],r[1],r[2],$i(r[3],n,t,e)):u>(a+2|0)?Hi($i(r,n,t,e[0]),e[1],e[2],e[3]):Zi(r,n,t,e)}return function r(n,t,e){return e?Hi(e[0],e[1],e[2],r(n,t,e[3])):zi(n,t)}(n,t,r)}return function r(n,t,e){return e?Hi(r(n,t,e[0]),e[1],e[2],e[3]):zi(n,t)}(n,t,e)}function rc(r,n){if(r){if(n){var t=Yi(n);return $i(r,t[0],t[1],Qi(n))}return r}return n}function nc(r,n,t,e){return t?$i(r,n,t[0],e):rc(r,e)}function tc(r,n){if(n){var t=n[3],e=n[2],u=n[1],a=n[0],i=sr(r,u);if(i){if(i<0){var c=tc(r,a);return[c[0],c[1],$i(c[2],u,e,t)]}var o=tc(r,t);return[$i(a,u,e,o[0]),o[1],o[2]]}return[a,[e],t]}return[0,0,0]}function ec(r,n){for(;;){var t=n,e=r;if(!e)return t;n=[e[1],e[2],e[3],t],r=e[0]}}var uc=[0,function(r){return r?0:1},function(r,n){for(;;){var t=n;if(t){var e=sr(r,t[1]);if(e){n=e<0?t[0]:t[3];continue}return 1}return 0}},Wi,zi,function r(n,t){if(t){var e=t[3],u=t[2],a=t[1],i=t[0],c=sr(n,a);if(c)return c<0?Hi(r(n,i),a,u,e):Hi(i,a,u,r(n,e));var o=i,f=e;if(o){if(f){var s=Yi(f);return Hi(o,s[0],s[1],Qi(f))}return o}return f}return 0},function r(n,t,e){var u=0;if(t){var a=t[1];if(t[4]>=Ji(e)){var c=tc(a,e);return nc(r(n,t[0],c[0]),a,g(n,a,[t[2]],c[1]),r(n,t[3],c[2]))}u=1}else{if(!e)return 0;u=1}if(1===u){if(e){var o=e[1],f=tc(o,t);return nc(r(n,f[0],e[0]),o,g(n,o,f[1],[e[2]]),r(n,f[2],e[3]))}throw[i,["map.ml",270,10]]}},function(r,n,t){for(var e=ec(n,0),u=ec(t,0);;){var a=u,i=e;if(i){if(a){var c=sr(i[0],a[0]);if(0!==c)return c;var o=h(r,i[1],a[1]);if(0!==o)return o;u=ec(a[2],a[3]),e=ec(i[2],i[3]);continue}return 1}return a?-1:0}},function(r,n,t){for(var e=ec(n,0),u=ec(t,0);;){var a=u,i=e;if(i){if(a){if(sr(i[0],a[0]))return 0;if(h(r,i[1],a[1])){u=ec(a[2],a[3]),e=ec(i[2],i[3]);continue}return 0}return 0}return a?0:1}},function r(n,t){for(;;){var e=t;if(!e)return 0;r(n,e[0]),h(n,e[1],e[2]),t=e[3]}},function r(n,t,e){for(;;){var u=e,a=t;if(!a)return u;e=g(n,a[1],a[2],r(n,a[0],u)),t=a[3]}},function r(n,t){for(;;){var e=t;if(e){if(h(n,e[1],e[2])){if(r(n,e[0])){t=e[3];continue}return 0}return 0}return 1}},function r(n,t){for(;;){var e=t;if(!e)return 0;if(h(n,e[1],e[2]))return 1;if(r(n,e[0]))return 1;t=e[3]}},function r(n,t){if(t){var e=t[2],u=t[1],a=r(n,t[0]),i=h(n,u,e),c=r(n,t[3]);return i?$i(a,u,e,c):rc(a,c)}return 0},function r(n,t){if(t){var e=t[2],u=t[1],a=r(n,t[0]),i=a[1],c=a[0],o=h(n,u,e),f=r(n,t[3]),s=f[1],v=f[0];return o?[$i(c,u,e,v),rc(i,s)]:[rc(c,v),$i(i,u,e,s)]}return[0,0]},function r(n){return n?(r(n[0])+1|0)+r(n[3])|0:0},function(r){return function r(n,t){for(;;){var e=t,u=n;if(!e)return u;t=e[0],n=[[e[1],e[2]],r(u,e[3])]}}(0,r)},Yi,function(r){for(;;){var n=r;if(n){var t=n[3];if(t){r=t;continue}return[n[1],n[2]]}throw u}},Yi,tc,function(r,n){for(;;){var t=n;if(t){var e=sr(r,t[1]);if(e){n=e<0?t[0]:t[3];continue}return t[2]}throw u}},function r(n,t){if(t){var e=r(n,t[0]),u=l(n,t[2]),a=r(n,t[3]);return[e,t[1],u,a,t[4]]}return 0},function r(n,t){if(t){var e=t[1];return[r(n,t[0]),e,h(n,e,t[2]),r(n,t[3]),t[4]]}return 0}],ac=wr("Tea_json.Decoder.ParseFail");function ic(r){return[function(n){var t=Ki(n);return"number"==typeof t&&t>=2?y(0,[r]):y(1,["Non-null value"])}]}function cc(r,n){var t=n[0];return[function(n){var e=Ki(n);if("number"==typeof e)return y(1,["Non-fieldable value"]);if(2===e.tag){var u=e[0][r];if(void 0!==u){var a=l(t,u);return a.tag?y(1,["field `"+r+"` -> "+a[0]]):a}return y(1,["Field Value is undefined: "+r])}return y(1,["Non-fieldable value"])}]}function oc(r){return[function(n){var t=function(r,n){for(;;){var e=n;if(!e)return y(1,["No one-of's matched"]);var u=e[1];try{var a=l(e[0][0],r);return a.tag?t(r,u):a}catch(r){n=u;continue}}};return t(n,r)}]}function fc(r,n){var t=n[0];return[function(n){var e=l(t,n);return e.tag?y(1,["map "+e[0]]):y(0,[l(r,e[0])])}]}function sc(r,n){var t=n[0];return[function(n){var e=l(t,n);return e.tag?e:l(l(r,e[0])[0],n)}]}function vc(r,n){try{return l(r[0],n)}catch(r){var t=Vn(r);return t[0]===ac?y(1,[t[1]]):y(1,["Unknown JSON parsing error"])}}var lc=[uc,ac,[function(r){var n=Ki(r);return"number"==typeof n?y(1,["Non-string value"]):n.tag?y(1,["Non-string value"]):y(0,[n[0]])}],[function(r){var n=Ki(r);if("number"==typeof n)return y(1,["Non-int value"]);if(1===n.tag){var t=n[0];return t>-2147483648&&t<2147483647?y(0,[0|t]):y(1,["number out of int range"])}return y(1,["Non-int value"])}],[function(r){var n=Ki(r);return"number"==typeof n?y(1,["Non-float-value"]):1===n.tag?y(0,[n[0]]):y(1,["Non-float-value"])}],[function(r){var n=Ki(r);if("number"!=typeof n)return y(1,["Non-boolean value"]);switch(n){case 0:return y(0,[0]);case 1:return y(0,[1]);case 2:return y(1,["Non-boolean value"])}}],ic,function(r){var n=r[0];return[function(r){var t=Ki(r);if("number"==typeof t)return y(1,["Non-list value"]);if(3!==t.tag)return y(1,["Non-list value"]);try{return y(0,[xr(function(r){var t=l(n,r);if(t.tag)throw[ac,t[0]];return t[0]},Jn(t[0]))])}catch(r){var e=Vn(r);if(e[0]===ac)return y(1,["list -> "+e[1]]);throw e}}]},function(r){var n=r[0];return[function(r){var t=Ki(r);if("number"==typeof t)return y(1,["Non-array value"]);if(3!==t.tag)return y(1,["Non-array value"]);try{return y(0,[Kn(function(r){var t=l(n,r);if(t.tag)throw[ac,t[0]];return t[0]},t[0])])}catch(r){var e=Vn(r);if(e[0]===ac)return y(1,["array -> "+e[1]]);throw e}}]},function(r){var n=r[0];return[function(r){var t=Ki(r);if("number"==typeof t)return y(1,["Non-keyValuePair value"]);if(2!==t.tag)return y(1,["Non-keyValuePair value"]);var e=t[0],u=Object.keys(e);try{return y(0,[Zn(function(r,t){var u=e[r];if(void 0!==u){var a=l(n,u);if(a.tag)throw[ac,a[0]];return[[r,a[0]],t]}throw[ac,"Key is undefined: "+r]},u,0)])}catch(r){var a=Vn(r);if(a[0]===ac)return y(1,["Invalid keyValuePair parsing: "+a[1]]);throw a}}]},function(r){var n=r[0];return[function(r){var t=Ki(r);if("number"==typeof t)return y(1,["Non-dict value"]);if(2!==t.tag)return y(1,["Non-dict value"]);var e=t[0],u=Object.keys(e);try{return y(0,[Zn(function(r,t){var u=e[r];if(void 0!==u){var a=l(n,u);if(a.tag)throw[ac,a[0]];return Wi(r,a[0],t)}throw[ac,"Key is undefined: "+r]},u,0)])}catch(r){var a=Vn(r);if(a[0]===ac)return y(1,["Invalid dict parsing: "+a[1]]);throw a}}]},cc,function(r,n){return function r(n,t,e){return t?h(n,t[0],r(n,t[1],e)):e}(cc,r,n)},function(r,n){var t=n[0];return[function(n){var e=Ki(n);if("number"==typeof e)return y(1,["Non-array value"]);if(3===e.tag){var u=e[0];return r<0||r>u.length?y(1,["Array index out of range: "+r]):l(t,f(u,r))}return y(1,["Non-array value"])}]},function(r){var n=r[0];return[function(r){var t=l(n,r);return t.tag?y(0,[0]):y(0,[[t[0]]])}]},oc,fc,function(r,t,e){var u=e[0],a=t[0];return[function(t){var e,i,c,o=l(a,t),f=l(u,t),s=0;if(o.tag)s=1;else{if(!f.tag)return y(0,[h(r,o[0],f[0])]);s=1}if(1===s){var v=(e=o,(i=f).tag?[i[0]]:(c=e).tag?[c[0]]:0);if(v)return y(1,["map2 -> "+v[0]]);throw[n,"Impossible case"]}}]},function(r,t,e,u){var a=u[0],i=e[0],c=t[0];return[function(t){var e=l(c,t),u=l(i,t),o=l(a,t),f=0;if(e.tag)f=1;else if(u.tag)f=1;else{if(!o.tag)return y(0,[g(r,e[0],u[0],o[0])]);f=1}if(1===f){var s=ji(o,ji(u,e));if(s.tag)return y(1,["map3 -> "+s[0]]);throw[n,"Impossible case"]}}]},function(r,t,e,u,a){var i=a[0],c=u[0],o=e[0],f=t[0];return[function(t){var e=l(f,t),u=l(o,t),a=l(c,t),s=l(i,t),v=0;if(e.tag)v=1;else if(u.tag)v=1;else if(a.tag)v=1;else{if(!s.tag)return y(0,[m(r,e[0],u[0],a[0],s[0])]);v=1}if(1===v){var h=ji(s,ji(a,ji(u,e)));if(h.tag)return y(1,["map4 -> "+h[0]]);throw[n,"Impossible case"]}}]},function(r,t,e,u,a,i){var c=i[0],o=a[0],f=u[0],s=e[0],v=t[0];return[function(t){var e=l(v,t),u=l(s,t),a=l(f,t),i=l(o,t),h=l(c,t),g=0;if(e.tag)g=1;else if(u.tag)g=1;else if(a.tag)g=1;else if(i.tag)g=1;else{if(!h.tag)return y(0,[b(r,e[0],u[0],a[0],i[0],h[0])]);g=1}if(1===g){var m=ji(h,ji(i,ji(a,ji(u,e))));if(m.tag)return y(1,["map5 -> "+m[0]]);throw[n,"Impossible case"]}}]},function(r,t,e,u,a,i,c){var o=c[0],f=i[0],s=a[0],v=u[0],h=e[0],g=t[0];return[function(t){var e=l(g,t),u=l(h,t),a=l(v,t),i=l(s,t),c=l(f,t),m=l(o,t),b=0;if(e.tag)b=1;else if(u.tag)b=1;else if(a.tag)b=1;else if(i.tag)b=1;else if(c.tag)b=1;else{if(!m.tag)return y(0,[w(r,e[0],u[0],a[0],i[0],c[0],m[0])]);b=1}if(1===b){var p=ji(m,ji(c,ji(i,ji(a,ji(u,e)))));if(p.tag)return y(1,["map6 -> "+p[0]]);throw[n,"Impossible case"]}}]},function(r,t,e,u,a,i,c,o){var f=o[0],s=c[0],v=i[0],h=a[0],g=u[0],m=e[0],b=t[0];return[function(t){var e=l(b,t),u=l(m,t),a=l(g,t),i=l(h,t),c=l(v,t),o=l(s,t),w=l(f,t),d=0;if(e.tag)d=1;else if(u.tag)d=1;else if(a.tag)d=1;else if(i.tag)d=1;else if(c.tag)d=1;else if(o.tag)d=1;else{if(!w.tag)return y(0,[p(r,e[0],u[0],a[0],i[0],c[0],o[0],w[0])]);d=1}if(1===d){var k=ji(w,ji(o,ji(c,ji(i,ji(a,ji(u,e))))));if(k.tag)return y(1,["map7 -> "+k[0]]);throw[n,"Impossible case"]}}]},function(r,t,e,u,a,i,c,o,f){var s=f[0],v=o[0],h=c[0],g=i[0],m=a[0],b=u[0],w=e[0],p=t[0];return[function(t){var e=l(p,t),u=l(w,t),a=l(b,t),i=l(m,t),c=l(g,t),o=l(h,t),f=l(v,t),k=l(s,t),_=0;if(e.tag)_=1;else if(u.tag)_=1;else if(a.tag)_=1;else if(i.tag)_=1;else if(c.tag)_=1;else if(o.tag)_=1;else if(f.tag)_=1;else{if(!k.tag)return y(0,[d(r,e[0],u[0],a[0],i[0],c[0],o[0],f[0],k[0])]);_=1}if(1===_){var C=ji(k,ji(f,ji(o,ji(c,ji(i,ji(a,ji(u,e)))))));if(C.tag)return y(1,["map8 -> "+C[0]]);throw[n,"Impossible case"]}}]},function(r){return[function(){return y(0,[r])}]},function(r){return[function(){return y(1,[r])}]},[function(r){return y(0,[r])}],sc,function(r){return sc(r,[function(){return y(0,[0])}])},function(r){return oc([ic(0),[fc(function(r){return[r]},r),0]])},vc,function(r,n){try{return l(r[0],n)}catch(r){var t=Vn(r);return t[0]===ac?y(1,[t[1]]):y(1,["Unknown JSON parsing error"])}},function(r,n){try{return vc(r,JSON.parse(n))}catch(r){return y(1,["Invalid JSON string"])}}],hc=lc[17](function(r,n){return[r,n]},lc[11]("pageX",lc[3]),lc[11]("pageY",lc[3]));function gc(r,n,t){return Vi(n,function(e){var u=[e],a=y(0,[n,function(r){var n=lc[31](hc,r);return n.tag?0:[l(t,n[0])]}]),i=document,c=Uu(u,i,r,a);return function(){return Bu(i,r,c),0}})}function mc(r,n){return lc[17](function(r,n){return[r,n]},lc[11](r,lc[3]),lc[11](n,lc[3]))}mc("pageX","pageY");var bc=lc[11]("clientWidth",lc[3]),wc=lc[18](function(r,n,t){return[r,n,t]},mc("offsetX","offsetY"),mc("pageX","pageY"),lc[11]("target",bc)),pc=lc[31];function dc(r){return pc(wc,r)}var yc=ta(0,0,[ya(y(0,[0])),0],[Hu("Flip board"),0]);function kc(r,n){return[(e=r,u=n,"number"==typeof u?u?[[4,oe(e)],[2,oe(e)]]:[[4,oe(e)],[6,oe(e)]]:u.tag?[[u[1],(i=e,0!==i?6:1)],[u[2],(a=e,0!==a?7:0)]]:[[u[0],u[1]],[u[2],u[3]]]),(t=n,"number"==typeof t?[t]:1===t.tag?0:[t])];var t,e,u,a,i}function _c(r){if(r){var n=r[1],t=r[0];return[[t,function(r,e,u){var a,i,c=u[1];return y(0,[y(0,[[t,[r,e],0,(a=[r,e],i=xr(function(r){return kc(t,r)},n),xr(function(r){return[r[0][1],r[1]]},Dr(function(r){return C(r[0][0],a)})(i))),c,u[0],c,u[2]]])])}]]}return 0}function Cc(r,n,t){var e=0!==t[0]?[[0,[1,[2,[3,[4,[5,[6,[7,0]]]]]]]],[7,[6,[5,[4,[3,[2,[1,[0,0]]]]]]]]]:[[7,[6,[5,[4,[3,[2,[1,[0,0]]]]]]]],[0,[1,[2,[3,[4,[5,[6,[7,0]]]]]]]]],u=e[0],a=function(r,n){return function(r,n){for(;;){var t=n;if(!t)return 0;if(l(r,t[0]))return 1;n=t[1]}}(function(r){return C(r[0],n)},r[3])},i=t[1];return Wu(0,"cb-board",0,0,["number"==typeof i||i.tag?Na:la("dragging"),0],xr(function(e){return Wu(0,"cb-row",0,0,0,xr(function(u){var i,c,o=e,s=u,v=f(f(n,s),o);if(v){var g,m=v[0],b=m[1],w=t[1];if("number"==typeof w)g=[0,Na];else if(w.tag)g=[0,Na];else{var p=w[0];g=C([s,o],p[1])?[1,(c=p,ma("transform",h(xt([y(11,["translate(",y(4,[0,0,0,y(11,["px,",y(4,[0,0,0,y(11,["px)",0])])])])]),"translate(%dpx,%dpx)"]),((c[5][0]-(c[7]/2|0)|0)+c[6][0]|0)-c[4][0]|0,((c[5][1]-(c[7]/2|0)|0)+c[6][1]|0)-c[4][1]|0)))]:[0,Na]}var d,k=_c(r);if(k){var _=k[0];if(b===_[0]){var N=h(_[1],s,o);d=pa("mousedown","",function(r){return n=N,(t=l(dc,r)).tag?0:[l(n,t[0])];var n,t})}else d=Na}else d=Na;i=[Wu(0,"cb-piece",0,0,[g[1],[ha([[ce(b),1],[[ie(m[0]),1],[["dragged",g[0]],0]]]),0]],0),d]}else i=[Ca,Na];var A,S,F,x,M,O,T=t[1],I=0;if("number"==typeof T)I=1;else if(T.tag)I=1;else{var q=T[0];A=[ha([["destination",a(q,[s,o])],[["hovering",(x=q,M=[s,o],O=x[2],O&&C(O[0],M)?1:0)],0]]),[(F=y(0,[y(3,[[s,o]])]),Lu("mouseenter",F)),[(S=y(0,[y(4,[[s,o]])]),Lu("mouseleave",S)),0]]]}return 1===I&&(A=[Na,[Na,[Na,0]]]),Wu(0,"cb-square",0,0,[i[1],A],[i[0],0])},u))},e[1]))}function Nc(r,n,e){var u,a,i,c,o,f,s=e[1];return Wu(0,"cb-wrap",0,0,0,["number"!=typeof s&&s.tag?(u=s[0],a=u[2],i=e[0],c=u[0],f=(o=0!==i?0!==c?[a,[0,[1,[2,[3,0]]]]]:[a,[7,[6,[5,[4,0]]]]]:0!==c?[7-a|0,[7,[6,[5,[4,0]]]]]:[7-a|0,[0,[1,[2,[3,0]]]]])[0],Wu(0,"cb-promo",0,0,[ya(y(0,[1])),0],xr(function(r){var n,t=r[1];return Wu(0,"cb-square",0,0,[ya(y(0,[y(5,[t])])),[(n=[["left",l(xt([y(4,[0,0,0,y(11,["px",0])]),"%dpx"]),F(f,u[3]))],[["top",l(xt([y(4,[0,0,0,y(11,["px",0])]),"%dpx"]),F(r[0],u[3]))],0]],y(4,[n])),0]],[Wu(0,"cb-piece",0,0,[ha([[ce(u[0]),1],[[ie(t),1],0]]),0],0),0])},function r(n,e){if(n){if(e)return[[n[0],e[0]],r(n[1],e[1])];throw[t,"List.combine"]}if(e)throw[t,"List.combine"];return 0}(o[1],[1,[4,[2,[3,0]]]])))):Ca,[Cc(r,n,e),0]])}function Ac(r){var n,t,e,u,a=r[1];return"number"==typeof a||a.tag?Gi:Bi([(e=0,u=function(r){return y(0,[y(1,[r])])},gc("mousemove",e?e[0]:"",u)),[(n=0,t=function(r){return y(0,[y(2,[r])])},gc("mouseup",n?n[0]:"",t)),0]])}function Sc(r,n){var t=n[0];return y(2,[function(n){return l(t,function(t){var e=l(r,t);return e?l(n[0][0],e[0]):0})}])}function Fc(r,n){return Sc(function(n){return[l(r,n)]},n)}function xc(r,n){var t=n[0];return[function(n){return l(t,function(t){return t.tag?l(n,t):l(l(r,t[0])[0],n)})}]}function Mc(r,n){return xc(function(n){var t=l(r,n);return[function(r){return l(r,y(0,[t]))}]},n)}function Oc(r){return r?(n=function(r,n){return[r,n]},t=r[0],e=Oc(r[1]),xc(function(r){return xc(function(t){var e=h(n,r,t);return[function(r){return l(r,y(0,[e]))}]},e)},t)):[function(r){return l(r,y(0,[0]))}];var n,t,e}var Tc=[function(r){var n,t,e=(n=window,void 0!==(t=n.localStorage)?[t.clear()]:0);return l(r,e?y(0,[e[0]]):y(1,["localStorage is not available"]))}];function Ic(r){return[function(n){var t,e,u,a=(t=window,e=r,void 0!==(u=t.localStorage)?[u.removeItem(e)]:0);return l(n,a?y(0,[a[0]]):y(1,["localStorage is not available"]))}]}function qc(r,n){return[function(t){var e,u,a,i;return l(t,(e=window,u=r,a=n,void 0!==(i=e.localStorage)?[i.setItem(u,a)]:0)?y(0,[0]):y(1,["localStorage is not available"]))}]}var Dc=[[function(r){var n,t,e=(n=window,void 0!==(t=n.localStorage)?[t.length]:0);return l(r,e?y(0,[e[0]]):y(1,["localStorage is not available"]))}],Tc,function(){return Sc(function(){return 0},Tc)},function(r){return[function(n){var t,e,u,a=(t=window,e=r,void 0!==(u=t.localStorage)?[u.key(e)]:0);return l(n,a?y(0,[a[0]]):y(1,["localStorage is not available"]))}]},function(r){return[function(n){var t=function(r,n){var t=r.localStorage;if(void 0===t)return 0;try{return[t.getItem(n)]}catch(r){return 0}}(window,r);return l(n,t?y(0,[t[0]]):y(1,["localStorage is not available"]))}]},Ic,function(r){return Sc(function(){return 0},Ic(r))},qc,function(r,n){return Sc(function(){return 0},qc(r,n))}];function Ec(r){var t,e=null!==(t=r.getAllResponseHeaders())?""===t?y(1,[1]):y(0,[t]):y(1,[0]);return e.tag?e:y(0,[xr(function(r){if(2!==r.length)throw[n,"Cannot happen, already checked length"];return[r[0],r[1]]},Dr(function(r){return+(2===r.length)})(Jn(Kn(function(r){return r.split(": ",2)},e[0].split("\r\n")))))])}var Lc,Pc=(Lc=function(r){return y(0,[r])},[5,function(r){var n=r[3];return"number"==typeof n?y(1,["Non-text response returned"]):5===n.tag?l(Lc,n[0]):y(1,["Non-text response returned"])}]);function Rc(r){return[["GET",0,r,0,Pc,0,0],0]}function Uc(r,n){var e=n[1],u=n[0],a=u[4],i=a[1],c=a[0],o=u[6],f=u[5],s=u[3],v=u[2],h=u[1],g=u[0];return y(2,[function(n){var u=function(t,e){return l(n[0][0],l(r,t))},a=new XMLHttpRequest;if(e){var m=e[0],b=function(r,t){return t?l(r,l(t[0],n)):0};b(function(r){return a.onreadystatechange=r},m[0]),b(function(r){return a.onprogress=r},m[1])}var w=y(1,[1]);a.onerror=function(r){return u(w)};var p=y(1,[0]);a.ontimeout=function(r){return u(p)};var d=y(1,[2]);a.onabort=function(r){return u(d)};var k,_,C,N,A,S,F,x,M;a.onload=function(){var r,n,e,c,o,f,s=(r=function(r){return r?r[4]:0},n=function(n,t,e,u){var a=r(n),i=r(u);return[n,t,e,u,a>=i?a+1|0:i+1|0]},e=function(e,u,a,i){var c=e?e[4]:0,o=i?i[4]:0;if(c>(o+2|0)){if(e){var f=e[3],s=e[2],v=e[1],l=e[0];if(r(l)>=r(f))return n(l,v,s,n(f,u,a,i));if(f)return n(n(l,v,s,f[0]),f[1],f[2],n(f[3],u,a,i));throw[t,"Map.bal"]}throw[t,"Map.bal"]}if(o>(c+2|0)){if(i){var h=i[3],g=i[2],m=i[1],b=i[0];if(r(h)>=r(b))return n(n(e,u,a,b),m,g,h);if(b)return n(n(e,u,a,b[0]),b[1],b[2],n(b[3],m,g,h));throw[t,"Map.bal"]}throw[t,"Map.bal"]}return[e,u,a,i,c>=o?c+1|0:o+1|0]},c=function(r,n,t){if(t){var u=t[3],a=t[2],i=t[1],o=t[0],f=sr(r,i);return f?f<0?e(c(r,n,o),i,a,u):e(o,i,a,c(r,n,u)):[o,r,n,u,t[4]]}return[0,r,n,0,1]},(o=Ec(a)).tag?o:y(0,[Tr(function(r,n){return c(n[0],n[1],r)},0,o[0])]));f=s.tag?0:s[0];var v=a.responseURL,h=[a.status,a.statusText],g=[v,h,f,function(r){var n=r.response;if(null===n)return 0;var t=function(r){var n=r.responseType;switch(n){case"":return 0;case"arraybuffer":return 1;case"blob":return 2;case"document":return 3;case"json":return 4;case"text":return 5;default:return[n]}}(r);if("number"!=typeof t)return y(6,[t[0],n]);switch(t){case 0:return y(0,[n]);case 1:return y(1,[n]);case 2:return y(2,[n]);case 3:return y(3,[n]);case 4:return y(4,[n]);case 5:return y(5,[n])}}(a)];if(h[0]<200||300<=h[0]){var m=y(1,[y(1,[g])]);return u(m)}var b=l(i,g);if(b.tag){var w=y(1,[y(2,[b[0],g])]);return u(w)}var p=y(0,[b[0]]);return u(p)};try{k=g,_=v,N=0,A=0,S=a,F=(C=0)?C[0]:1,x=N?N[0]:"",M=A?A[0]:"",S.open(k,_,F,x,M)}catch(r){var O=y(1,[y(0,[v])]);u(O)}return Or(function(r){return n=r[0],t=r[1],a.setRequestHeader(n,t);var n,t},h),function(r,n){if("number"!=typeof r)return n.responseType=r[0];switch(r){case 0:return n.responseType="";case 1:return n.responseType="arraybuffer";case 2:return n.responseType="blob";case 3:return n.responseType="document";case 4:return n.responseType="json";case 5:n.responseType="text"}}(c,a),f&&(a.timeout=f[0]),a.withCredentials=o,function(r,n){if("number"==typeof r)return r?n.send(null):n.send();switch(0|r.tag){case 0:case 1:return n.send(r[0]);case 2:var t=Tr(function(r,n){var t,e;return t=n[0],e=n[1],r.append(t,e),r},new FormData,r[0]);return n.send(t);case 3:n.send(r[0])}}(s,a),0}])}function Bc(r){return y(0,[r])}var Vc="http://localhost:3000/fetch/";function Xc(r,n){if("number"==typeof n)return"number"==typeof r&&1!==r?[r,Uc(Bc,Rc("https://lichess.org/api/tournament/GToVqkC9"))]:[r,Qa];switch(0|n.tag){case 0:var t=n[0];if(t.tag)return[2,Qa];var e=lc[7](lc[2]),u=lc[17](function(r,n){return[r,n]},lc[11]("id",lc[2]),lc[11]("u",e)),a=lc[7](u),i=lc[11]("pairings",a),c=lc[32](i,t[0]);return[c.tag?2:[c[0]],Qa];case 1:var o=n[0];return[r,(f=function(r){return y(2,[o,r])},s=o,Uc(f,Rc(h(xt([y(2,[0,y(11,["https://lichess.org/game/export/",y(2,[0,y(11,[".pgn",0])])])]),"%shttps://lichess.org/game/export/%s.pgn"]),Vc,s))))];case 2:return[r,Qa]}var f,s}function Gc(r){var n,t,e,u;if("number"!=typeof r)return n=0,t=0,e=0,u=xr(function(r){var n,t,e,u,a=r[0];return n=0,t=0,e=0,u=[ca(0,0,0,[ra(0,0,[va(l(xt([y(11,["#/lichess/",y(2,[0,0])]),"#/lichess/%s"]),a)),0],[Hu(a),0]),0]),xr(function(r){return ca(0,0,0,[Hu(r),0])},r[1])],Du("","tr",n?n[0]:"",t?t[0]:"",e,u)},r[0]),Du("","table",n?n[0]:"",t?t[0]:"",e,u);switch(r){case 0:return $u(0,0,0,[ta(0,0,[ya(0),0],[Hu("load Lichess tournament"),0]),0]);case 1:return $u(0,0,0,[Hu("Loading tournament..."),0]);case 2:return $u(0,0,0,[Hu("Tournament could not be loaded."),[ta(0,0,[ya(0),0],[Hu("retry"),0]),0]])}}function Kc(r){return Mc(function(n){return[r,n]},Dc[4](r))}var jc=Mc(function(r){return Tr(function(r,n){try{var t=hi(n[1]);return t?g(xa[3],tr(n[0]),t[0],r):r}catch(n){return r}},xa[0],r)},xc(function(r){return Oc(xr(Kc,r))},xc(function(r){return Oc(function(r,n){for(;;){var t=n,e=r;if(!(e>=0))return t;n=[Dc[3](e),t],r=e-1|0}}(r,0))},Dc[0])));function Jc(r,n){return Dc[7](r,(e=function(r){return l(xt([y(12,[123,y(2,[0,y(12,[125,0])])]),"{%s}"]),r)},u=za(function(r,n){return n},function(r){return Vr(" ",r)},function(r){return l(xt([y(12,[40,y(2,[0,y(12,[41,0])])]),"(%s)"]),r)},function(r){return r},function(r,n,t){var u=1+(r/2|0)|0,a=+(r%2==0),i=xr(e,n[2]),c=xr(e,n[3]);return Vr(" ",Nr(i,Nr(a?[l(xt([y(4,[0,0,0,y(12,[46,0])]),"%d."]),u),[n[1],c]]:[n[1],c],t)))},(t=n)[0][9]-1|0,function(r){return r+1|0},function(r){return r-1|0},fi,fi,fi,fi,t[1]),a=Vr("\n",xr(function(r){return h(xt([y(12,[91,y(2,[0,y(11,[' "',y(2,[0,y(11,['"]',0])])])])]),'[%s "%s"]']),r[0],r[1])},t[2])),g(xt([y(2,[0,y(11,["\n\n",y(2,[0,y(12,[32,y(2,[0,0])])])])]),"%s\n\n%s %s"]),a,u,vi(t[3]))));var t,e,u,a}function Zc(r,n,t,e,u,a){if(a){var i=a[0];return function(a){var c=[0],o=[e],f=[0],s=function(){var r,t,e,u;if(f[0]){var s=[l(n,o[0]),0],v=(r=a,t=i,e=c[0],u=s,zu(r,t,t.childNodes,0,e,u),u);return c[0]=v,f[0]=0,0}return 0},v=function(){for(;i.childNodes.length>0;){var r=i.firstChild;null!==r&&i.removeChild(r)}return 0},g=[0],m=function(r){var n=l(t,r);return g[0]=Xi(a,a,g[0],n),0};return[function(){return v(),Wa(a,u),m(o[0]),f[0]=[-1],s(),0},function(r){return Pu(l(n,r))},function(n,t){var e=h(r,n,t),u=e[0];return o[0]=u,Wa(a,e[1]),!f[0]&&(f[0]=[-1],s()),m(u),u},function(r){return f[0]=0,Wa(a,r),g[0]=Xi(a,a,g[0],0),c[0]=0,v(),0}]}}return function(a){var i=[0],c=function(r){var n=l(t,r);return i[0]=Xi(a,a,i[0],n),0};return[function(){return Wa(a,u),c(e),0},function(r){return Pu(l(n,r))},function(n,t){var e=h(r,n,t),u=e[0];return Wa(a,e[1]),c(u),u},function(r){return Wa(a,r),i[0]=Xi(a,a,i[0],0),0}]}}function zc(r,t,e){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var r=0,n=["ms","moz","webkit","o"],t=0;t<n.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[n[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[t]+"CancelAnimationFrame"]||window[n[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,t){var e=(new Date).getTime(),u=Math.max(0,16-(e-r)),a=window.setTimeout(function(){n(e+u)},u);return r=e+u,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}();var u,a,i,c,o,f,s,v,g,m=l(r[0],e),b=m[0],w=null==t?0:[t],p=Zc(r[1],r[2],r[3],b,m[1],w);return u=b,a=p,i=r[4],c=[u],f=l(a,o=[[function(){return console.log("INVALID enqueue CALL!"),0}]]),s=[0],g=[v=function(r){var t=s[0];if(t)return s[0]=[[r,t[0]]],0;s[0]=[0];var e=h(f[2],c[0],r);c[0]=e;var u=s[0];if(u){var a=u[0];return a?(s[0]=0,Or(v,Fr(a))):(s[0]=0,0)}throw[n,"INVALID message queue state, should never be None during message processing!"]}],o[0]=g,l(f[0],0),{pushMsg:v,shutdown:function(){o[0]=[function(){return console.log("INVALID message enqueued when shut down"),0}];var r=l(i,c[0]);return l(f[3],r),0},getHtmlString:function(){return l(f[1],c[0])}}}var Hc,Wc=function(r,n){return y(4,[function(n){return[[function(t){return l(n[0][0],l(r,t))}]]},n])},Yc=lc[20](function(r,n,t,e,u){return[r,n,t,e,u]},lc[11]("keyCode",lc[3]),lc[11]("shiftKey",lc[5]),lc[11]("ctrlKey",lc[5]),lc[11]("altKey",lc[5]),lc[11]("metaKey",lc[5]));function Qc(r,n){var t,e,u,a=r?r[0]:"";return t="keydown",u=n,Vi(e=a,function(r){var n=[r],a=y(0,[e,function(r){var n=lc[31](Yc,r);return n.tag?0:[l(u,n[0])]}]),i=document,c=Uu(n,i,t,a);return function(){return Bu(i,t,c),0}})}function $c(r){return y(3,[r])}function ro(r){return y(4,[r])}function no(r,n){var t;switch(r[0]){case 0:t=ta(0,0,[ya(y(2,[n])),0],[Hu("move, computer!"),0]);break;case 1:t=Hu("Stockfish is thinking");break;case 2:t=Hu("loading Stockfish")}var e;return $u(0,0,0,[t,[ea(0,0,[sa("autoplay"),[ga("checkbox"),[ka(0,$c),[(e=r[3],e?y(0,["checked","checked"]):0),0]]]],0),[ua(0,0,[wa("autoplay"),0],[Hu("autoplay"),0]),[ea(0,0,[sa("depth"),[ga("number"),[ma("width","3em"),[ma("margin-left","1em"),[da(0,function(r){return Aa(tr,ro,r)}),[ba(Cr(r[2])),[_a[1]("1"),[_a[0]("24"),0]]]]]]]],0),[ua(0,0,[wa("depth"),0],[Hu("strength"),0]),0]]]]])}function to(r,n){var t=n[0];return y(2,[function(n){var e=Ti(Ei),u=l(t,e);return xi(Ei,e),l(n[0][0],l(r,u))}])}function eo(r){return[r.href,r.protocol,r.host,r.hostname,r.port,r.pathname,r.search,r.hash,r.username,r.password,r.origin]}Hc=S(),Mi(Ei,Hc);var uo=[0];function ao(){var r=uo[0];if(r){var n=eo(document.location);return l(r[0],n),0}return 0}function io(r){return Vi("navigation",function(n){uo[0]=[function(t){return l(n[0],l(r,t))}];var t,e,u,a=function(){return ao()};return t="popstate",e=a,u=0,window.addEventListener(t,e,u),function(){return r="popstate",n=a,t=0,window.removeEventListener(r,n,t);var r,n,t}})}function co(r){return y(2,[function(){var n,t,e,u,a,i;return n=r,t=window,e=JSON.parse("{}"),u="",a=n,void 0!==(i=t.history)&&i.replaceState(e,u,a),ao(),0}])}function oo(r){return y(2,[function(){var n,t,e,u,a,i;return n=r,t=window,e=JSON.parse("{}"),u="",a=n,void 0!==(i=t.history)&&i.pushState(e,u,a),ao(),0}])}function fo(r){return y(0,[r])}function so(r){return y(1,[r])}function vo(r){return y(2,[r])}function lo(r){return y(4,[r])}function ho(r){return y(5,[r])}function go(r){return y(6,[r])}function mo(r){return y(8,[r])}function bo(r){return y(9,[r])}var wo=[function(r){return r[0]},function(r,n){var t=n.slice();return t[0]=r,t}];function po(r,n){var t=l(xa[18],n[0])[0]+1|0;return[[g(xa[3],t,r,n[0]),Ui[3](wo,Oa[0](t)),n[2],n[3],n[4],n[5],n[6]],t]}function yo(r){var n=Jn(r[7].split("/"));if(!n)return y(0,[1]);if("#"!==n[0])return y(0,[1]);var t=n[1];if(!t)return y(0,[1]);switch(t[0]){case"":return t[1],y(0,[1]);case"game":var e=t[1];return e?e[1]?y(0,[1]):y(0,[tr(e[0])]):y(0,[1]);case"lichess":var u=t[1];return u?u[1]?y(0,[1]):y(1,[u[0]]):y(0,[1]);case"tournament":return t[1]?y(0,[1]):0;default:return y(0,[1])}}function ko(r){return"number"==typeof r?"#/tournament":r.tag?l(xt([y(11,["#/lichess/",y(2,[0,0])]),"#/lichess/%s"]),r[0]):l(xt([y(11,["#/game/",y(4,[0,0,0,0])]),"#/game/%d"]),r[0])}function _o(r,n){if(C(r[2],n))return[r,Qa];if("number"==typeof n){var t=r.slice();return[(t[2]=0,t),Ha(y(2,[0]))]}if(!n.tag){var e=n[0];if(h(xa[2],e,r[0])){var a=Ui[3](wo,Oa[0](e));return[[r[0],a,n,r[3],r[4],r[5],r[6]],Qa]}var i=r.slice();return[(i[2]=y(0,[1]),i),co(ko(y(0,[1])))]}var c=n[0];try{var o=po(h(Ma[21],c,r[5]),r);return[o[0],co(ko(y(0,[o[1]])))]}catch(n){if(n===u)return[r,Ha(y(2,[y(1,[c])]))];throw n}}var Co=[g(xa[3],1,$a,xa[0]),Ui[3](wo,Oa[0](1)),y(0,[1]),[1,0],0,Ma[0],0];function No(r,n){return[Co,Fc(function(r){return y(7,[n,r])},jc)]}function Ao(r,e){var a,i,c,o,f,s,v,h=0;if("number"==typeof e)switch(e){case 0:var m,b=Fe(Ui[0](r,r[1])[0]);if("number"==typeof b)m=Qa;else if(b.tag){var w=b[0];m=to(function(r){return y(3,[function(r,e){if(e<0)throw[t,"List.nth"];for(var u=r,a=e;;){var i=u;if(i){if(a){a=a-1|0,u=i[1];continue}return i[0]}throw[n,"nth"]}}(w,r)])},(o=0,f=Ar(w),[function(r){return o+Li[4](r,f)|0}]))}else m=Qa;return[r,m];case 1:return[Ui[1](r[1],$a,r),Qa];case 2:var p=po($a,r);return[p[0],oo(ko(y(0,[p[1]])))];case 3:return[r,Fc(mo,Oc((c=r[0],g(xa[10],function(r,n,t){return[Jc(Cr(r),n),t]},c,0))))];case 4:return[r,Dc[2](0)];case 5:var d=stockfish_loader(function(r){return y(9,[(n=r,y(0,[n]))]);var n});if(null==d)return console.log("Stockfish failed to load"),[r,Qa];var k=r.slice();return[(k[6]=[(i=d,[2,i,12,1])],k),Qa]}else switch(0|e.tag){case 0:var _=e[0];if(!_.tag){var N=function(r,n){if(n.tag)return[r,Qa];var t=n[0],e=r[1];if("number"==typeof t)return t?[[r[0],0],Qa]:[[_e(r[0]),r[1]],Qa];switch(0|t.tag){case 0:return[[r[0],y(0,[t[0]])],Qa];case 1:if("number"==typeof e)return[r,Qa];if(e.tag)return[r,Qa];var a=e[0].slice();return[[r[0],y(0,[(a[6]=t[0],a)])],Qa];case 2:if("number"==typeof e)return[r,Qa];if(e.tag)return[r,Qa];var i=e[0],c=i[2];if(!c)return[[r[0],0],Qa];var o=c[0];try{var f=qr(o,i[3]);return f?[[r[0],0],Ha(y(1,[f[0]]))]:[[r[0],y(1,[[i[0],i[1][0],o[0],i[7]]])],Qa]}catch(n){if(n===u)return[[r[0],0],Qa];throw n}break;case 3:if("number"==typeof e)return[r,Qa];if(e.tag)return[r,Qa];var s=e[0].slice();return[[r[0],y(0,[(s[2]=[t[0]],s)])],Qa];case 4:if("number"==typeof e)return[r,Qa];if(e.tag)return[r,Qa];var v=e[0].slice();return[[r[0],y(0,[(v[2]=0,v)])],Qa];case 5:if("number"==typeof e)return[r,Qa];if(e.tag){var l=e[0],h=y(1,[t[0],l[1],l[2]]);return[[r[0],0],Ha(y(1,[h]))]}return[r,Qa]}}(r[3],_),A=r.slice();return[(A[3]=N[0],A),Ya(fo,N[1])]}a=_[0],h=1;break;case 1:var S=gi(Ui[0](r,r[1]),e[0]);return[Ui[1](r[1],S[0],r),Ya(so,S[1])];case 2:var F=e[0],x=0;if("number"==typeof F)x=2;else{if(2===F.tag){var M=F[1],O=F[0];if(M.tag)return alert(l(xt([y(11,["Game ",y(2,[0,y(11,[" could not be loaded!",0])])]),"Game %s could not be loaded!"]),O)),[r,Qa];var T=hi(M[0]);if(T){var I=T[0],q=g(Ma[3],O,I,r[5]),D=r.slice(),E=po(I,(D[5]=q,D));return[E[0],co(ko(y(0,[E[1]])))]}return alert("Game could not be parsed!"),[r,Qa]}x=2}if(2===x){var L=Xc(r[4],F),P=r.slice();return[(P[4]=L[0],P),Ya(vo,L[1])]}break;case 3:a=e[0],h=1;break;case 4:var R,U=e[0],B=U[2],V=U[0],X=0;if(0!==B){var G=V-66|0;if(G>16||G<0)X=2;else switch(G){case 0:R=Ha(y(1,[0]));break;case 4:R=Ha(y(1,[1]));break;case 12:R=Ha(2);break;case 1:case 2:case 3:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:X=2;break;case 16:R=Ha(0)}}else X=2;if(2===X){var K=V-37|0;if(K>2||K<0)R=Qa;else switch(K){case 0:R=Ha(y(1,[0]));break;case 1:R=Qa;break;case 2:R=Ha(y(1,[1]))}}return[r,R];case 5:var j=e[0];return 0!==j?[r,oo(ko(y(0,[j])))]:[r,oo("#/tournament")];case 6:return _o(r,yo(e[0]));case 7:var J=e[1],Z=e[0];if(J.tag)return alert(l(xt([y(11,["games couldn't be restored because of error ",y(2,[0,0])]),"games couldn't be restored because of error %s"]),J[0])),_o(r,yo(Z));var z,H=J[0];if(C(H,xa[0]))z=r;else{var W=r.slice();W[0]=H,z=W}return _o(z,yo(Z));case 8:var Y=e[0];return Y.tag?(alert(l(xt([y(11,["games couldn't be saved because of error ",y(2,[0,0])]),"games couldn't be saved because of error %s"]),Y[0])),[r,Qa]):(alert("games successfully saved"),[r,Qa]);case 9:var Q=e[0],$=0;if("number"==typeof Q)$=2;else if(1===Q.tag)try{var rr=xu(Ui[0](r,r[1])[0],Q[0][0]),nr=gi(Ui[0](r,r[1]),y(0,[rr]));return[Ui[1](r[1],nr[0],r),Ya(so,nr[1])]}catch(n){if(n===Ae)return[r,Qa];throw n}else $=2;if(2===$){var tr=r[6];if(tr){var er=function(r,n){if("number"==typeof n)return[r,Qa];switch(0|n.tag){case 0:var t=n[0];console.log(t);var e=pn(pn(pn(Un("bestmove"),Rn(Nn(Pn))),Un("bestmoveSan")),lu()),u=function(r){return ln(e,function(r){var n=[r];return pn(Sn(32),function(r){return vn(n,r)})},r)},a=pn(Un("Stockfish"),function(r){return vn(0,r)}),i=sn(function(r){return hn(a,u,r)},on[2](t));if(i){var c=i[0];return c?[[0,r[1],r[2],r[3]],Ha(y(1,[c[0]]))]:[[0,r[1],r[2],r[3]],Ha(0)]}return[r,Qa];case 1:return[r,Qa];case 2:return r[1].postMessage("position fen "+n[0]),r[1].postMessage(l(xt([y(11,["go depth ",y(4,[0,0,0,0])]),"go depth %d"]),r[2])),[[1,r[1],r[2],r[3]],Qa];case 3:return[[r[0],r[1],r[2],n[0]],Qa];case 4:return[[r[0],r[1],n[0],r[3]],Qa]}}(tr[0],Q),ur=r.slice();return[(ur[6]=[er[0]],ur),Ya(bo,er[1])]}return[r,Qa]}}if(1===h){var ar=gi(Ui[0](r,r[1]),y(0,[a])),ir=ar[0],cr=r[6],or=Fe(ir[0]),fr=cr&&"number"!=typeof or&&or.tag&&cr[0][3]?Ha(y(9,[(v=ke[1](ir[0]),y(2,[v]))])):Qa;return[Ui[1](r[1],ir,r),(s=[Ya(so,ar[1]),[fr,0]],y(1,[s]))]}}function So(r,n,t){return ia(0,0,[(r?r[0]:0)?la("home"):Na,0],[ra(0,0,[va(n),0],[Hu(t),0]),0])}var Fo=fa(0,0,[sa("main-nav"),0],[aa(0,0,0,[So([1],"#/","TEA-Chess"),[So(0,"https://quernd.github.io/tutorials/tea-chess","Tutorial"),[So(0,"https://github.com/quernd/tea-chess","Code"),0]]]),0]);function xo(r){var n,t=r[2];n="number"==typeof t||t.tag?0:[t[0]];var e,u,a,i,c=Fr(g(xa[10],function(r,t,e){return[oa(0,0,[ba(Cr(r)),[_a[4](C(n,[r])),0]],[Hu(l(xt([y(11,["Game ",y(4,[0,0,0,0])]),"Game %d"]),r)),0]),e]},r[0],0));return e=0,u=0,a=[da(0,function(r){return Aa(tr,ho,r)}),0],i=[oa(0,0,[ba("0"),[_a[4](+(0===r[2])),0]],[Hu("Tournament"),0]),c],Du("","select",e?e[0]:"",u?u[0]:"",a,i)}function Mo(r){var n,t=Ui[0](r,r[1]),e=t[0],u=Fe(e);n="number"!=typeof u&&u.tag?[e[1],u[0]]:0;var a,i=r[6];if(i){var c=i[0],o=0;0!==c[0]||n?o=1:a=function(r){var n,t=Fe(r);if("number"==typeof t)n="It's a draw!";else if(t.tag){var e=r[1];n=h(xt([y(11,["It is ",y(2,[0,y(11,["'s move,  ",y(4,[0,0,0,y(11,[" legal moves",0])])])])]),"It is %s's move,  %d legal moves"]),0!==e?"White":"Black",Ar(t[0]))}else n=0!==t[0]?"White wins by checkmate!":"Black wins by checkmate!";return $u(0,0,0,[Hu(n),0])}(e),1===o&&(a=Wc(bo,no(c,ke[1](t[0]))))}else a=$u(0,0,0,[Ta(5,"load Stockfish"),0]);var f,s,v,l,g,m=r[2];return f="number"==typeof m?Wc(vo,Gc(r[4])):m.tag?Ca:Wc(so,bi(t)),s=0,v=0,l=0,g=[na(0,0,[sa("board"),0],[Fo,[Wc(fo,Nc(n,e[0],r[3])),[$u(0,0,0,[Wc(fo,yc),[Ta(0,"Random move!"),[Ta(y(1,[0]),"Take back"),0]]]),[a,0]]]]),[na(0,0,[sa("game"),0],[fa(0,0,0,[aa(0,0,0,[ia(0,0,0,[xo(r),[Ta(1,"reset game"),[Ta(2,"new game"),[Ta(3,"save games"),[Ta(4,"clear storage"),0]]]]]),0]),0]),[Yu(0,0,[la("scroll"),0],[f,0]),0]]),0]],Du("","main",s?s[0]:"",v?v[0]:"",l,g)}function Oo(r){return Bi([(n=fo,t=Ac(r[3]),y(2,[function(r){return[[function(t){return l(r[0][0],l(n,t))}]]},t])),[Qc(0,lo),0]]);var n,t}var To,Io,qo,Do=(To=go,qo=[function(r){return h(Io[0],r,eo(document.location))},(Io=[No,Ao,Mo,Oo,function(){return Qa}])[1],Io[2],function(r){return y(0,[[io(To),[l(Io[3],r),0]]])},Io[4]],function(r,n){return zc(qo,r,n)});return r.board_msg=fo,r.game_msg=so,r.lichess_msg=vo,r.random_button=0,r.random_move=function(r){return y(3,[r])},r.key_pressed=lo,r.reset_game=1,r.switch_game=ho,r.new_game=2,r.location_changed=go,r.save_games=3,r.clear_games=4,r.games_loaded=function(r,n){return y(7,[r,n])},r.games_saved=mo,r.load_stockfish=5,r.stockfish_msg=bo,r.games_lens=wo,r.add_game_update_lens=po,r.route_of_location=yo,r.location_of_route=ko,r.update_route=_o,r.init_model=Co,r.init=No,r.update=Ao,r.header_nav_view=Fo,r.games_picker=xo,r.view=Mo,r.subscriptions=Oo,r.main=Do,r}({});
