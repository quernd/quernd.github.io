var starter=function(r){"use strict";var n=["Failure",-2],e=["Invalid_argument",-3],t=["Division_by_zero",-5],u=["Not_found",-6],a=["Match_failure",-7],i=["Assert_failure",-10];function c(r,n,e){for(var t=new Array(e),u=0,a=n;u<e;)t[u]=r[a],u=u+1|0,a=a+1|0;return t}function o(r,n,t){if(n<0||n>=r.length)throw[e,"index out of bounds"];return r[n]=t,0}function f(r,n){if(n<0||n>=r.length)throw[e,"index out of bounds"];return r[n]}function s(r,n){for(var e=new Array(r),t=0,u=r-1|0;t<=u;++t)e[t]=n;return e}function v(r,n){for(;;){var e=n,t=r,u=t.length,a=u||1,i=a-e.length|0;if(i){if(i<0){n=c(e,a,0|-i),r=t.apply(null,c(e,0,a));continue}return function(r,n){return function(e){return v(r,n.concat([e]))}}(t,e)}return t.apply(null,e)}}function l(r,n){var e=r.length;return 1===e?r(n):function(r,n,e){if(e>7||e<0)return v(r,[n]);switch(e){case 0:case 1:return r(n);case 2:return function(e){return r(n,e)};case 3:return function(e,t){return r(n,e,t)};case 4:return function(e,t,u){return r(n,e,t,u)};case 5:return function(e,t,u,a){return r(n,e,t,u,a)};case 6:return function(e,t,u,a,i){return r(n,e,t,u,a,i)};case 7:return function(e,t,u,a,i,c){return r(n,e,t,u,a,i,c)}}}(r,n,e)}function h(r,n,e){var t=r.length;return 2===t?r(n,e):function(r,n,e,t){if(t>7||t<0)return v(r,[n,e]);switch(t){case 0:case 1:return v(r(n),[e]);case 2:return r(n,e);case 3:return function(t){return r(n,e,t)};case 4:return function(t,u){return r(n,e,t,u)};case 5:return function(t,u,a){return r(n,e,t,u,a)};case 6:return function(t,u,a,i){return r(n,e,t,u,a,i)};case 7:return function(t,u,a,i,c){return r(n,e,t,u,a,i,c)}}}(r,n,e,t)}function g(r,n,e,t){var u=r.length;return 3===u?r(n,e,t):function(r,n,e,t,u){var a=0;if(u>7||u<0)return v(r,[n,e,t]);switch(u){case 0:case 1:a=1;break;case 2:return v(r(n,e),[t]);case 3:return r(n,e,t);case 4:return function(u){return r(n,e,t,u)};case 5:return function(u,a){return r(n,e,t,u,a)};case 6:return function(u,a,i){return r(n,e,t,u,a,i)};case 7:return function(u,a,i,c){return r(n,e,t,u,a,i,c)}}return 1===a?v(r(n),[e,t]):void 0}(r,n,e,t,u)}function m(r,n,e,t,u){var a=r.length;return 4===a?r(n,e,t,u):function(r,n,e,t,u,a){var i=0;if(a>7||a<0)return v(r,[n,e,t,u]);switch(a){case 0:case 1:i=1;break;case 2:return v(r(n,e),[t,u]);case 3:return v(r(n,e,t),[u]);case 4:return r(n,e,t,u);case 5:return function(a){return r(n,e,t,u,a)};case 6:return function(a,i){return r(n,e,t,u,a,i)};case 7:return function(a,i,c){return r(n,e,t,u,a,i,c)}}return 1===i?v(r(n),[e,t,u]):void 0}(r,n,e,t,u,a)}function b(r,n,e,t,u,a){var i=r.length;return 5===i?r(n,e,t,u,a):function(r,n,e,t,u,a,i){var c=0;if(i>7||i<0)return v(r,[n,e,t,u,a]);switch(i){case 0:case 1:c=1;break;case 2:return v(r(n,e),[t,u,a]);case 3:return v(r(n,e,t),[u,a]);case 4:return v(r(n,e,t,u),[a]);case 5:return r(n,e,t,u,a);case 6:return function(i){return r(n,e,t,u,a,i)};case 7:return function(i,c){return r(n,e,t,u,a,i,c)}}return 1===c?v(r(n),[e,t,u,a]):void 0}(r,n,e,t,u,a,i)}function w(r,n,e,t,u,a,i){var c=r.length;return 6===c?r(n,e,t,u,a,i):function(r,n,e,t,u,a,i,c){var o=0;if(c>7||c<0)return v(r,[n,e,t,u,a,i]);switch(c){case 0:case 1:o=1;break;case 2:return v(r(n,e),[t,u,a,i]);case 3:return v(r(n,e,t),[u,a,i]);case 4:return v(r(n,e,t,u),[a,i]);case 5:return v(r(n,e,t,u,a),[i]);case 6:return r(n,e,t,u,a,i);case 7:return function(c){return r(n,e,t,u,a,i,c)}}return 1===o?v(r(n),[e,t,u,a,i]):void 0}(r,n,e,t,u,a,i,c)}function p(r,n,e,t,u,a,i,c){var o=r.length;return 7===o?r(n,e,t,u,a,i,c):function(r,n,e,t,u,a,i,c,o){var f=0;if(o>7||o<0)return v(r,[n,e,t,u,a,i,c]);switch(o){case 0:case 1:f=1;break;case 2:return v(r(n,e),[t,u,a,i,c]);case 3:return v(r(n,e,t),[u,a,i,c]);case 4:return v(r(n,e,t,u),[a,i,c]);case 5:return v(r(n,e,t,u,a),[i,c]);case 6:return v(r(n,e,t,u,a,i),[c]);case 7:return r(n,e,t,u,a,i,c)}return 1===f?v(r(n),[e,t,u,a,i,c]):void 0}(r,n,e,t,u,a,i,c,o)}function d(r,n,e,t,u,a,i,c,o){var f=r.length;return 8===f?r(n,e,t,u,a,i,c,o):function(r,n,e,t,u,a,i,c,o,f){var s=0;if(f>7||f<0)return v(r,[n,e,t,u,a,i,c,o]);switch(f){case 0:case 1:s=1;break;case 2:return v(r(n,e),[t,u,a,i,c,o]);case 3:return v(r(n,e,t),[u,a,i,c,o]);case 4:return v(r(n,e,t,u),[a,i,c,o]);case 5:return v(r(n,e,t,u,a),[i,c,o]);case 6:return v(r(n,e,t,u,a,i),[c,o]);case 7:return v(r(n,e,t,u,a,i,c),[o])}return 1===s?v(r(n),[e,t,u,a,i,c,o]):void 0}(r,n,e,t,u,a,i,c,o,f)}function y(r,n){return n.tag=r,n}function k(r,n){return r<n?-1:r===n?0:1}function _(r,n){for(;;){var t=n,u=r;if(u===t)return 0;var a=typeof u,i=typeof t;if("string"===a){return u<t?-1:u===t?0:1}var c=+("number"===i);if(0!==+("number"===a))return 0!==c?k(u,t):-1;if(0!==c)return 1;if("boolean"===a||"undefined"===a||null===u){return u===t?0:u<t?-1:1}if("function"===a||"function"===i)throw[e,"compare: functional value"];var o=0|u.tag,f=0|t.tag;if(250!==o)if(250!==f){if(248===o)return k(u[1],t[1]);if(251===o)throw[e,"equal: abstract value"];if(o!==f)return o<f?-1:1;var s=0|u.length,v=0|t.length;if(s===v)for(var l=u,h=t,g=0,m=s;;){var b=g;if(b===m)return 0;var w=_(l[b],h[b]);if(0!==w)return w;g=b+1|0}else if(s<v)for(var p=u,d=t,y=0,C=s;;){var N=y;if(N===C)return-1;var A=_(p[N],d[N]);if(0!==A)return A;y=N+1|0}else for(var S=u,F=t,x=0,M=v;;){var O=x;if(O===M)return 1;var T=_(S[O],F[O]);if(0!==T)return T;x=O+1|0}}else n=t[0];else r=u[0]}}function C(r,n){for(;;){var t=n,u=r;if(u===t)return 1;var a=typeof u;if("string"===a||"number"===a||"boolean"===a||"undefined"===a||null===u)return 0;var i=typeof t;if("function"===a||"function"===i)throw[e,"equal: functional value"];if("number"===i||"undefined"===i||null===t)return 0;var c=0|u.tag,o=0|t.tag;if(250!==c)if(250!==o){if(248===c)return+(u[1]===t[1]);if(251===c)throw[e,"equal: abstract value"];if(c!==o)return 0;var f=0|u.length;if(f!==(0|t.length))return 0;for(var s=u,v=t,l=0,h=f;;){var g=l;if(g===h)return 1;if(!C(s[g],v[g]))return 0;l=g+1|0}}else n=t[0];else r=u[0]}}function N(r,n){return 1-C(r,n)}function A(r,n){return+(_(r,n)<=0)}function S(){return[(4294967295^(0|Date.now()))*Math.random()|0]}n.tag=248,e.tag=248,t.tag=248,u.tag=248,a.tag=248,i.tag=248;var F=Math.imul||function(r,n){return((r>>16)*(n|=0)<<16)+(65535&r)*n|0},x=String.prototype.repeat&&function(r,n){return n.repeat(r)}||function(r,n){if(0==n.length||0==r)return"";if(n.length*r>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var e="";1==(1&r)&&(e+=n),0!=(r>>>=1);)n+=n;return e},M=[-2147483648,0],O=[134217727,1],T=[0,1],I=[0,0],q=[-1,4294967295];function D(r){return+(0!=(2147483648&r))}function E(r,n){var e=n[1],t=r[1],u=t+e&4294967295,a=D(t)&&(D(e)||!D(u))||D(e)&&!D(u)?1:0;return[r[0]+n[0]+a&4294967295,u>>>0]}function L(r,n){return r[0]===n[0]?+(r[1]===n[1]):0}function P(r){return L(r,M)?M:E([-1^(n=r)[0],(-1^n[1])>>>0],T);var n}function R(r,n){return E(r,P(n))}function U(r,n){if(n){var e=r[1];return n>=32?[e<<(n-32|0),0]:[e>>>(32-n|0)|r[0]<<n,e<<n>>>0]}return r}function B(r,n){if(n){var e=r[0];return n<32?[e>>n,(e<<(32-n|0)|r[1]>>>n)>>>0]:[e>=0?0:-1,e>>(n-32|0)>>>0]}return r}function V(r,n){for(;;){var e,t=n,u=r,a=0,i=u[0],c=0,o=0,f=0;if(0!==i)f=4;else{if(0===u[1])return I;f=4}if(4===f)if(0!==t[0])o=3;else{if(0===t[1])return I;o=3}if(3===o&&(-2147483648!==i?c=2:0!==u[1]?c=2:(e=t[1],a=1)),2===c){var s=t[0],v=u[1],l=0;if(-2147483648!==s?l=3:0!==t[1]?l=3:(e=v,a=1),3===l){var h=t[1];if(i<0){if(s<0){n=P(t),r=P(u);continue}return P(V(P(u),t))}if(s<0)return P(V(u,P(t)));var g=65535&i,m=v>>>16,b=65535&v,w=65535&s,p=h>>>16,d=65535&h,y=0,k=0,_=0,C=b*d;return y=(k=(k=(_=(C>>>16)+m*d)>>>16)+((_=(65535&_)+b*p)>>>16)+g*d)>>>16,y+=(k=(65535&k)+m*p)>>>16,y+=(k=(65535&k)+b*w)>>>16,[(k&=65535)|(y=y+((i>>>16)*d+g*p+m*w+b*(s>>>16))&65535)<<16,(65535&C|(65535&_)<<16)>>>0]}}if(1===a)return 0==(1&e)?I:M}}function X(r,n){var e=n[0],t=r[0];return t>e?1:t<e?0:+(r[1]>=n[1])}function G(r,n){return 1-L(r,n)}function K(r,n){return 1-X(r,n)}function j(r,n){return r[0]>n[0]?1:r[0]<n[0]?0:+(r[1]>n[1])}function J(r){return 4294967296*r[0]+r[1]}var Z=Math.pow(2,32),z=Math.pow(2,63),H=-Math.pow(2,63);function W(r){return isNaN(r)||!isFinite(r)?I:r<=H?M:r+1>=z?O:r<0?P(W(-r)):[r/Z|0,(r%Z|0)>>>0]}function Y(r,n){for(;;){var e=n,u=r,a=u[0],i=0,c=0;if(0!==e[0])c=2;else{if(0===e[1])throw t;c=2}if(2===c)if(-2147483648!==a)if(0!==a)i=1;else{if(0===u[1])return I;i=1}else if(0!==u[1])i=1;else{if(L(e,T)||L(e,q))return u;if(L(e,M))return T;var o=e[0],f=U(Y(B(u,1),e),1),s=0;if(0!==f[0])s=3;else{if(0===f[1])return o<0?T:P(T);s=3}if(3===s)return E(f,Y(E(u,P(V(e,f))),e))}if(1===i){var v=e[0],l=0;if(-2147483648!==v)l=2;else{if(0===e[1])return I;l=2}if(2===l){if(a<0){if(v<0){n=P(e),r=P(u);continue}return P(Y(P(u),e))}if(v<0)return P(Y(u,P(e)));for(var h=I,g=u;X(g,e);){for(var m=Math.max(1,Math.floor(J(g)/J(e))),b=Math.ceil(Math.log(m)/Math.LN2),w=b<=48?1:Math.pow(2,b-48),p=W(m),d=V(p,e);d[0]<0||j(d,g);)d=V(p=W(m-=w),e);0===(y=p)[0]&&0===y[1]&&(p=T),h=E(h,p),g=E(g,P(d))}return h}}}var y}function Q(r,n){var e=Y(r,n);return[e,E(r,P(V(e,n)))]}function $(r){return[r<0?-1:0,r>>>0]}function rr(r){return[2147483647&r[0],r[1]]}function nr(r){return r>=65?r>=97?r>=123?-1:r-87|0:r>=91?-1:r-55|0:r>57||r<48?-1:r-48|0}function er(r){var e=function(r){var n=1,e=2,t=0;"-"===r[t]&&(n=-1,t=t+1|0);var u=r.charCodeAt(t),a=r.charCodeAt(t+1|0);return 48===u&&(a>=89?98!==a?111!==a?120===a&&(e=1,t=t+2|0):(e=0,t=t+2|0):(e=3,t=t+2|0):66!==a?79!==a?a>=88&&(e=1,t=t+2|0):(e=0,t=t+2|0):(e=3,t=t+2|0)),[t,n,e]}(r),t=e[0],u=function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10;case 3:return 2}}(e[2]),a=r.length,i=nr(t<a?r.charCodeAt(t):0);if(i<0||i>=u)throw[n,"int_of_string"];var c=e[1]*function(e,t){for(;;){var i=t,c=e;if(i===a)return c;var o=r.charCodeAt(i);if(95!==o){var f=nr(o);if(f<0||f>=u)throw[n,"int_of_string"];var s=u*c+f;if(s>4294967295)throw[n,"int_of_string"];t=i+1|0,e=s}else t=i+1|0}}(i,t+1|0),o=0|c;if(10===u&&c!==o)throw[n,"int_of_string"];return o}function tr(r){var n=r.length;if(n>31)throw[e,"format_int: format too long"];for(var t,u=["+","-"," ",0,2,0,0,0,1,-1,"f"],a=0;;){var i=a;if(i>=n)return u;var c=r.charCodeAt(i),o=0;if(c>=69)if(c>=88)if(c>=121)o=1;else switch(c-88|0){case 0:u[4]=1,u[7]=1,a=i+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:u[4]=0,a=i+1|0;continue;case 29:u[4]=2,a=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:u[4]=1,a=i+1|0;continue}else{if(!(c>=72)){u[5]=1,u[7]=1,u[10]=String.fromCharCode((t=c)>=65&&t<=90||t>=192&&t<=214||t>=216&&t<=222?t+32|0:t),a=i+1|0;continue}o=1}else{var f=c-32|0;if(f>25||f<0)o=1;else switch(f){case 3:u[3]=1,a=i+1|0;continue;case 0:case 11:o=2;break;case 13:u[0]="-",a=i+1|0;continue;case 14:u[9]=0;for(var s=i+1|0;function(n){return function(){var e=r.charCodeAt(n)-48|0;return+(e>=0&&e<=9)}}(s)();)u[9]=(F(u[9],10)+r.charCodeAt(s)|0)-48|0,s=s+1|0;a=s;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 15:o=1;break;case 16:u[2]="0",a=i+1|0;continue;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:o=3}}switch(o){case 1:a=i+1|0;continue;case 2:u[1]=String.fromCharCode(c),a=i+1|0;continue;case 3:u[6]=0;for(var v=i;function(n){return function(){var e=r.charCodeAt(n)-48|0;return+(e>=0&&e<=9)}}(v)();)u[6]=(F(u[6],10)+r.charCodeAt(v)|0)-48|0,v=v+1|0;a=v;continue;case 4:u[5]=1,u[4]=2,a=i+1|0;continue;case 5:u[5]=1,u[10]=String.fromCharCode(c),a=i+1|0;continue}}}function ur(r,n){var e=r[0],t=r[1],u=r[2],a=r[3],i=r[4],c=r[5],o=r[6],f=r[7],s=r[8],v=n.length;c&&(s<0||"-"!==t)&&(v=v+1|0),a&&(i?1===i&&(v=v+2|0):v=v+1|0);var l="";if("+"===e&&" "===u)for(var h=v,g=o-1|0;h<=g;++h)l+=u;if(c&&(s<0?l+="-":"-"!==t&&(l+=t)),a&&0===i&&(l+="0"),a&&1===i&&(l+="0x"),"+"===e&&"0"===u)for(var m=v,b=o-1|0;m<=b;++m)l+=u;if(l=f?l+n.toUpperCase():l+n,"-"===e)for(var w=v,p=o-1|0;w<=p;++w)l+=" ";return l}function ar(r,n){if("%d"===r)return String(n);var e=tr(r),t=n,u=(t<0?e[5]?(e[8]=-1,-t):t>>>0:t).toString(function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10}}(e[4]));if(e[9]>=0){e[2]=" ";var a=e[9]-u.length|0;a>0&&(u=x(a,"0")+u)}return ur(e,u)}function ir(r,n){var e=tr(r),t=e[5]&&K(n,[0,0])?(e[8]=-1,P(n)):n,u="";switch(e[4]){case 0:var a=[0,8],i="01234567";if(K(t,[0,0])){var c=Q(rr(t),a),o=E([268435456,0],c[0]),f=c[1];for(u=String.fromCharCode(i.charCodeAt(0|f[1]))+u;G(o,[0,0]);){var s=Q(o,a);o=s[0],f=s[1],u=String.fromCharCode(i.charCodeAt(0|f[1]))+u}}else{var v=Q(t,a),l=v[0],h=v[1];for(u=String.fromCharCode(i.charCodeAt(0|h[1]))+u;G(l,[0,0]);){var g=Q(l,a);l=g[0],h=g[1],u=String.fromCharCode(i.charCodeAt(0|h[1]))+u}}break;case 1:u=function(r){var n=function(r){return(r>>>0).toString(16)},e=r[0],t=r[1],u=0;if(0!==e)u=1;else{if(0===t)return"0";u=1}if(1===u){if(0!==t){if(0!==e){var a=n(r[1]),i=8-a.length|0;return i<=0?n(r[0])+a:n(r[0])+(x(i,"0")+a)}return n(r[1])}return n(r[0])+"00000000"}}(t)+u;break;case 2:var m=[0,10],b="0123456789";if(K(t,[0,0])){var w=Q(rr(t),m),p=Q(E([0,8],w[1]),m),d=E(E([214748364,3435973836],w[0]),p[0]),y=p[1];for(u=String.fromCharCode(b.charCodeAt(0|y[1]))+u;G(d,[0,0]);){var k=Q(d,m);d=k[0],y=k[1],u=String.fromCharCode(b.charCodeAt(0|y[1]))+u}}else{var _=Q(t,m),C=_[0],N=_[1];for(u=String.fromCharCode(b.charCodeAt(0|N[1]))+u;G(C,[0,0]);){var A=Q(C,m);C=A[0],N=A[1],u=String.fromCharCode(b.charCodeAt(0|N[1]))+u}}}if(e[9]>=0){e[2]=" ";var S=e[9]-u.length|0;S>0&&(u=x(S,"0")+u)}return ur(e,u)}var cr=ar,or=ar;function fr(r){if(r<0)throw[e,"String.create"];return new Array(r)}function sr(r,n){return r===n?0:r<n?-1:1}function vr(r,n,e,t,u){if(u>0){var a=r.length-n|0;if(u<=a){for(var i=0,c=u-1|0;i<=c;++i)e[t+i|0]=r.charCodeAt(n+i|0);return 0}for(var o=0,f=a-1|0;o<=f;++o)e[t+o|0]=r.charCodeAt(n+o|0);for(var s=a,v=u-1|0;s<=v;++s)e[t+s|0]=0;return 0}return 0}function lr(r,n,e,t,u){if(u>0){if(r===e){var a=r,i=n,c=t,o=u;if(i<c){for(var f=(a.length-c|0)-1|0,s=o-1|0,v=f>s?s:f;v>=0;--v)a[c+v|0]=a[i+v|0];return 0}if(i>c){for(var l=(a.length-i|0)-1|0,h=o-1|0,g=l>h?h:l,m=0;m<=g;++m)a[c+m|0]=a[i+m|0];return 0}return 0}var b=r.length-n|0;if(u<=b){for(var w=0,p=u-1|0;w<=p;++w)e[t+w|0]=r[n+w|0];return 0}for(var d=0,y=b-1|0;d<=y;++d)e[t+d|0]=r[n+d|0];for(var k=b,_=u-1|0;k<=_;++k)e[t+k|0]=0;return 0}return 0}function hr(r){for(var n=r.length,e=new Array(n),t=0,u=n-1|0;t<=u;++t)e[t]=r.charCodeAt(t);return e}function gr(r){var n=r,e=r.length,t="",u=e;if(e<=4096&&e===n.length)return String.fromCharCode.apply(null,n);for(var a=0;u>0;){var i=u<1024?u:1024,c=new Array(i);lr(n,a,c,0,i),t+=String.fromCharCode.apply(null,c),u=u-i|0,a=a+i|0}return t}function mr(r,n){if(n<0||n>=r.length)throw[e,"index out of bounds"];return r.charCodeAt(n)}var br=[0];function wr(r){var n=[r,(br[0]+=1,br[0])];return n.tag=248,n}var pr=function(r){throw new Error(r)};function dr(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return y(0,[dr(r[0])]);case 1:return y(1,[dr(r[0])]);case 2:return y(2,[dr(r[0])]);case 3:return y(3,[dr(r[0])]);case 4:return y(4,[dr(r[0])]);case 5:return y(5,[dr(r[0])]);case 6:return y(6,[dr(r[0])]);case 7:return y(7,[dr(r[0])]);case 8:return y(8,[r[0],dr(r[1])]);case 9:var n=r[0];return y(9,[n,n,dr(r[2])]);case 10:return y(10,[dr(r[0])]);case 11:return y(11,[dr(r[0])]);case 12:return y(12,[dr(r[0])]);case 13:return y(13,[dr(r[0])]);case 14:return y(14,[dr(r[0])])}}function yr(r,n){if("number"==typeof r)return n;switch(0|r.tag){case 0:return y(0,[yr(r[0],n)]);case 1:return y(1,[yr(r[0],n)]);case 2:return y(2,[r[0],yr(r[1],n)]);case 3:return y(3,[r[0],yr(r[1],n)]);case 4:return y(4,[r[0],r[1],r[2],yr(r[3],n)]);case 5:return y(5,[r[0],r[1],r[2],yr(r[3],n)]);case 6:return y(6,[r[0],r[1],r[2],yr(r[3],n)]);case 7:return y(7,[r[0],r[1],r[2],yr(r[3],n)]);case 8:return y(8,[r[0],r[1],r[2],yr(r[3],n)]);case 9:return y(9,[yr(r[0],n)]);case 10:return y(10,[yr(r[0],n)]);case 11:return y(11,[r[0],yr(r[1],n)]);case 12:return y(12,[r[0],yr(r[1],n)]);case 13:return y(13,[r[0],r[1],yr(r[2],n)]);case 14:return y(14,[r[0],r[1],yr(r[2],n)]);case 15:return y(15,[yr(r[0],n)]);case 16:return y(16,[yr(r[0],n)]);case 17:return y(17,[r[0],yr(r[1],n)]);case 18:return y(18,[r[0],yr(r[1],n)]);case 19:return y(19,[yr(r[0],n)]);case 20:return y(20,[r[0],r[1],yr(r[2],n)]);case 21:return y(21,[r[0],yr(r[1],n)]);case 22:return y(22,[yr(r[0],n)]);case 23:return y(23,[r[0],yr(r[1],n)]);case 24:return y(24,[r[0],r[1],yr(r[2],n)])}}wr("Pervasives.Exit");function kr(r,n){return+(_(r,n)>=0)?r:n}function _r(r){return r>=0?r:0|-r}function Cr(r){return""+r}function Nr(r,n){return r?[r[0],Nr(r[1],n)]:n}function Ar(r){for(var n=0,e=r;;){var t=e,u=n;if(!t)return u;e=t[1],n=u+1|0}}function Sr(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[0],e],r=t[1]}}function Fr(r){return Sr(r,0)}function xr(r,n){return n?[l(r,n[0]),xr(r,n[1])]:0}function Mr(r,n){return function r(n,e,t){return t?[h(e,n,t[0]),r(n+1|0,e,t[1])]:0}(0,r,n)}function Or(r,n){for(;;){var e=n;if(!e)return 0;l(r,e[0]),n=e[1]}}function Tr(r,n,e){for(;;){var t=e,u=n;if(!t)return u;e=t[1],n=h(r,u,t[0])}}function Ir(r,n){for(;;){var e=n;if(e){if(_(e[0],r)){n=e[1];continue}return 1}return 0}}function qr(r,n){for(;;){var e=n;if(e){var t=e[0];if(_(t[0],r)){n=e[1];continue}return t[1]}throw u}}var Dr=function(r){return function(n){for(var e=0,t=n;;){var u=t,a=e;if(!u)return Sr(a,0);var i=u[1],c=u[0];l(r,c)?(t=i,e=[c,a]):t=i}}};function Er(r,n){var e=fr(r);return function(r,n,e,t){if(e>0){for(var u=n,a=(e+n|0)-1|0;u<=a;++u)r[u]=t;return 0}}(e,0,r,n),e}function Lr(r,n,t){return gr(function(r,n,t){if(n<0||t<0||n>(r.length-t|0))throw[e,"String.sub / Bytes.sub"];var u=fr(t);return lr(r,n,u,0,t),u}(r,n,t))}function Pr(r,n,t,u,a){if(a<0||n<0||n>(r.length-a|0)||u<0||u>(t.length-a|0))throw[e,"Bytes.blit"];return lr(r,n,t,u,a)}function Rr(r,n,t,u,a){if(a<0||n<0||n>(r.length-a|0)||u<0||u>(t.length-a|0))throw[e,"String.blit / Bytes.blit_string"];return vr(r,n,t,u,a)}function Ur(r){for(var n=0,e=0,t=r.length-1|0;e<=t;++e){var u,a=r[e];if(a>=32){var i=a-34|0;u=i>58||i<0?i>=93?4:1:i>57||i<1?2:1}else u=a>=11?13!==a?4:2:a>=8?2:4;n=n+u|0}if(n===r.length)return o=(c=r).length,f=fr(o),lr(c,0,f,0,o),f;var c,o,f,s=fr(n);n=0;for(var v=0,l=r.length-1|0;v<=l;++v){var h=r[v],g=0;if(h>=35)92!==h?h>=127?g=1:s[n]=h:g=2;else if(h>=32)h>=34?g=2:s[n]=h;else if(h>=14)g=1;else switch(h){case 8:s[n]=92,s[n=n+1|0]=98;break;case 9:s[n]=92,s[n=n+1|0]=116;break;case 10:s[n]=92,s[n=n+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:g=1;break;case 13:s[n]=92,s[n=n+1|0]=114}switch(g){case 1:s[n]=92,s[n=n+1|0]=48+(h/100|0)|0,s[n=n+1|0]=48+(h/10|0)%10|0,s[n=n+1|0]=48+h%10|0;break;case 2:s[n]=92,s[n=n+1|0]=h}n=n+1|0}return s}function Br(r,n,t){var a=r.length;if(n<0||n>a)throw[e,"String.contains_from / Bytes.contains_from"];try{return function(r,n,e,t){for(;;){var a=e;if(a>=n)throw u;if(r[a]===t)return a;e=a+1|0}}(r,a,n,t),1}catch(r){if(r===u)return 0;throw r}}function Vr(r,n){if(n){var e=n[0],t=[0],u=[0];Or(function(r){return t[0]=t[0]+1|0,u[0]=u[0]+r.length|0,0},n);var a=fr(u[0]+F(r.length,t[0]-1|0)|0);vr(e,0,a,0,e.length);var i=[e.length];return Or(function(n){return vr(r,0,a,i[0],r.length),i[0]=i[0]+r.length|0,vr(n,0,a,i[0],n.length),i[0]=i[0]+n.length|0,0},n[1]),gr(a)}return""}function Xr(r,n){return function(r,n){for(var e=0,t=n.length-1|0;e<=t;++e)l(r,n[e]);return 0}(r,hr(n))}function Gr(r,n){return Br(hr(r),0,n)}var Kr=Rr;function jr(r){var n=r<1?1:r,e=fr(n);return[e,0,n,e]}function Jr(r){return Lr(r[0],0,r[1])}function Zr(r,n){for(var e=r[2];(r[1]+n|0)>e;)e<<=1;var t=fr(e);return Pr(r[0],0,t,0,r[1]),r[0]=t,r[2]=e,0}function zr(r,n){var e=r[1];return e>=r[2]&&Zr(r,1),r[0][e]=n,r[1]=e+1|0,0}function Hr(r,n){var e=n.length,t=r[1]+e|0;return t>r[2]&&Zr(r,e),Rr(n,0,r[0],r[1],e),r[1]=t,0}var Wr=250,Yr=wr("CamlinternalLazy.Undefined");function Qr(){throw Yr}function $r(r){var n=r[0];r[0]=Qr;try{var e=l(n,0);return r[0]=e,r.tag=Wr,e}catch(n){throw r[0]=function(){throw n},n}}var rn=wr("Stream.Failure");wr("Stream.Error");function nn(r){return r[2]=function(r,n,t,u){if(t<0||u<0||t>(n.length-u|0))throw[e,"input"];return pr("caml_ml_input not implemented by bucklescript yet\n")}(r[0],r[1],0,r[1].length),r[3]=0,0}function en(r,n){for(;;){var e=n;if("number"==typeof e)return e;switch(0|e.tag){case 0:return e;case 1:var t=e[1],u=en(r,e[0]);if("number"==typeof u){n=t;continue}if(u.tag)throw[i,["stream.ml",53,12]];return y(0,[u[0],y(1,[u[1],t])]);case 2:var a=e[0],c=0|a.tag;n=250===c?a[0]:246===c?$r(a):a;continue;case 3:var o=e[0],f=o[0];if(f){var s=f[0];return s?(o[0]=0,y(0,[s[0],e])):0}var v=l(o[1],r);return v?y(0,[v[0],e]):(o[0]=[0],0);case 4:var h=e[0];if(h[3]>=h[2]&&nn(h),h[2]){var g=h[1][h[3]];return h[3]=h[3]+1|0,y(0,[g,e])}return 0}}}function tn(r){for(;;){var n=r[1];if("number"==typeof n)return 0;switch(0|n.tag){case 0:return[n[0]];case 1:var e=en(r[0],r[1]);if("number"==typeof e)return 0;if(e.tag)throw[i,["stream.ml",82,12]];return r[1]=e,[e[0]];case 2:var t=n[0],u=0|t.tag;r[1]=250===u?t[0]:246===u?$r(t):t;continue;case 3:var a=n[0],c=a[0];if(c)return c[0];var o=l(a[1],r[0]);return a[0]=[o],o;case 4:var f=n[0];return f[3]>=f[2]&&nn(f),f[2]?[f[1][f[3]]]:(r[1]=0,0)}}}function un(r){var n=tn(r);if(n)return function(r){for(;;){var n=r[1],e=0;if("number"==typeof n)e=1;else switch(0|n.tag){case 0:return r[0]=r[0]+1|0,r[1]=n[1],0;case 3:var t=n[0];if(t[0])return r[0]=r[0]+1|0,t[0]=0,0;e=1;break;case 4:var u=n[0];return r[0]=r[0]+1|0,u[3]=u[3]+1|0,0;default:e=1}if(1===e){if(tn(r))continue;return 0}}}(r),n[0];throw rn}function an(r){var n=[0];return[0,y(3,[[0,function(){var e=n[0];return e<r.length?(n[0]=n[0]+1|0,[mr(r,e)]):0}]])]}function cn(r){var n=function(r){try{return[un(r),y(246,[function(){return n(r)}])]}catch(r){if(r===rn)return 0;throw r}};return n(r)}var on=[cn,function(r){var n=function(r){var e=l(r,0);return e?[e[0],y(246,[function(){return n(r)}])]:0};return n(r)},function(r){return cn(an(r))},function(r){return cn([0,y(4,[[r,new Array(4096),0,0]])])}];function fn(r){var n=jr(16);return Or(function(r){return zr(n,r)},r),Jr(n)}function sn(r,n){var e=l(r,n);return e?[e[0][0]]:0}function vn(r,n){return[[r,n]]}function ln(r,n,e){var t=l(r,e);if(t){var u=t[0];return h(n,u[0],u[1])}return 0}function hn(r,n,e){var t=l(r,e);return t||l(n,e)}function gn(){return 0}function mn(r){if(r){var n=r[1],e=0|n.tag;return[[r[0],250===e?n[0]:246===e?$r(n):n]]}return 0}function bn(r){return function(n){return ln(mn,function(n){return l(r,n)?function(r){return[[n,r]]}:gn},n)}}function wn(r,n){return function(e){return ln(r,function(r){var e=l(n,r);return function(r){return[[e,r]]}},e)}}function pn(r,n){return function(e){return ln(r,function(){return n},e)}}function dn(r,n){return function(e){return ln(r,function(r){return function(e){return ln(n,function(){return function(n){return[[r,n]]}},e)}},e)}}function yn(r,n){return function(e){return ln(r,function(r){return function(e){return ln(n,function(n){var e=[r,n];return function(r){return[[e,r]]}},e)}},e)}}function kn(r){if(r){var n=r[0],e=kn(r[1]);return function(r){return hn(n,e,r)}}return gn}function _n(r){var n=function(r){return[[0,r]]},e=function(e){return ln(r,function(){return n},e)};return function(r){return hn(e,function(r){return[[0,r]]},r)}}function Cn(r){return function(n){for(var e=function(r){return r},t=n;;){var u=t,a=e,i=l(r,u);if(!i)return[[l(a,0),u]];var c=i[0],o=c[0];t=c[1],e=function(r,n){return function(e){return l(r,[n,e])}}(a,o)}}}function Nn(r){return yn(r,Cn(r))}function An(r,n){var e,t,u=(t=n,yn(e=r,Cn(function(r){return ln(t,function(){return e},r)})));return function(r){return hn(u,function(r){return[[0,r]]},r)}}function Sn(r){return bn(function(n){return C(r,n)})}function Fn(r){return bn(function(n){return Ir(n,r)})}function xn(r){return bn(function(n){return 1-Ir(n,r)})}function Mn(r,n){return bn(function(e){return A(r,e)?A(e,n):0})}var On=bn(function(r){return Ir(r,[32,[9,[13,[10,0]]]])}),Tn=function r(n){var e=function(e){return ln(n,function(){return r(n)},e)};return function(r){return hn(e,function(r){return[[0,r]]},r)}}(On),In=Sn(10),qn=Mn(65,90),Dn=Mn(97,122),En=Mn(48,57);function Ln(r){return hn(Dn,qn,r)}function Pn(r){return hn(Ln,En,r)}function Rn(r){return function(n){return ln(Tn,function(){return r},n)}}function Un(r){var n=function(r,e){if(e>=r.length)return function(n){return[[r,n]]};var t=n(r,e+1|0),u=Sn(mr(r,e));return function(r){return ln(u,function(){return t},r)}},e=n(r,0);return function(r){return ln(Tn,function(){return e},r)}}var Bn=wr("Js_exn.Error");function Vn(r){return function(r){if(void 0===r)return 0;if(248===r.tag)return 1;var n=r[0];return void 0!==n?+(248===n.tag):0}(r)?r:[Bn,r]}function Xn(r,n,e){for(var t=s(r,[]),u=0,a=r-1|0;u<=a;++u)t[u]=s(n,e);return t}function Gn(r){var n=r.length;return n?c(r,0,n):[]}function Kn(r,n){var e=n.length;if(e){for(var t=s(e,l(r,n[0])),u=1,a=e-1|0;u<=a;++u)t[u]=l(r,n[u]);return t}return[]}function jn(r,n){for(var e=0,t=n.length-1|0;e<=t;++e)h(r,e,n[e]);return 0}function Jn(r){for(var n=r.length-1|0,e=0;;){var t=e,u=n;if(u<0)return t;e=[r[u],t],n=u-1|0}}function Zn(r,n,e){for(var t=e,u=n.length-1|0;u>=0;--u)t=h(r,n[u],t);return t}var zn;wr("Array.Bottom"),void 0!==(zn="undefined"==typeof process?void 0:process)&&(null==zn.argv||(zn.argv[0],zn.argv)),wr("Sys.Break");function Hn(r,n){var e=r[1].length,t=r[0]+n|0;if(t>e){var u=fr(kr(e<<1,t));return Pr(r[1],0,u,0,e),r[1]=u,0}return 0}function Wn(r,n){return Hn(r,1),r[1][r[0]]=n,r[0]=r[0]+1|0,0}function Yn(r,n){var e=n.length;return Hn(r,e),Kr(n,0,r[1],r[0],e),r[0]=r[0]+e|0,0}function Qn(r){return Lr(r[1],0,r[0])}function $n(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+gr(Er(1,r[0]))}}function re(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return y(0,[re(r[0])]);case 1:return y(1,[re(r[0])]);case 2:return y(2,[re(r[0])]);case 3:return y(3,[re(r[0])]);case 4:return y(4,[re(r[0])]);case 5:return y(5,[re(r[0])]);case 6:return y(6,[re(r[0])]);case 7:return y(7,[re(r[0])]);case 8:return y(8,[r[0],re(r[1])]);case 9:return y(9,[r[1],r[0],re(r[2])]);case 10:return y(10,[re(r[0])]);case 11:return y(11,[re(r[0])]);case 12:return y(12,[re(r[0])]);case 13:return y(13,[re(r[0])]);case 14:return y(14,[re(r[0])])}}function ne(r){if("number"==typeof r)return[function(){return 0},function(){return 0},function(){return 0},function(){return 0}];switch(0|r.tag){case 0:var n=ne(r[0]),e=n[1],t=n[0];return[function(){return l(t,0),0},function(){return l(e,0),0},n[2],n[3]];case 1:var u=ne(r[0]),a=u[1],i=u[0];return[function(){return l(i,0),0},function(){return l(a,0),0},u[2],u[3]];case 2:var c=ne(r[0]),o=c[1],f=c[0];return[function(){return l(f,0),0},function(){return l(o,0),0},c[2],c[3]];case 3:var s=ne(r[0]),v=s[1],h=s[0];return[function(){return l(h,0),0},function(){return l(v,0),0},s[2],s[3]];case 4:var g=ne(r[0]),m=g[1],b=g[0];return[function(){return l(b,0),0},function(){return l(m,0),0},g[2],g[3]];case 5:var w=ne(r[0]),p=w[1],d=w[0];return[function(){return l(d,0),0},function(){return l(p,0),0},w[2],w[3]];case 6:var y=ne(r[0]),k=y[1],_=y[0];return[function(){return l(_,0),0},function(){return l(k,0),0},y[2],y[3]];case 7:var C=ne(r[0]),N=C[1],A=C[0];return[function(){return l(A,0),0},function(){return l(N,0),0},C[2],C[3]];case 8:var S=ne(r[1]),F=S[1],x=S[0];return[function(){return l(x,0),0},function(){return l(F,0),0},S[2],S[3]];case 9:var M=ne(r[2]),O=M[3],T=M[2],I=M[1],q=M[0],D=ne(ee(re(r[0]),r[1])),E=D[3],L=D[2],P=D[1],R=D[0];return[function(){return l(q,0),l(R,0),0},function(){return l(P,0),l(I,0),0},function(){return l(T,0),l(L,0),0},function(){return l(E,0),l(O,0),0}];case 10:var U=ne(r[0]),B=U[1],V=U[0];return[function(){return l(V,0),0},function(){return l(B,0),0},U[2],U[3]];case 11:var X=ne(r[0]),G=X[1],K=X[0];return[function(){return l(K,0),0},function(){return l(G,0),0},X[2],X[3]];case 12:var j=ne(r[0]),J=j[1],Z=j[0];return[function(){return l(Z,0),0},function(){return l(J,0),0},j[2],j[3]];case 13:var z=ne(r[0]),H=z[3],W=z[2],Y=z[1],Q=z[0];return[function(){return l(Q,0),0},function(){return l(Y,0),0},function(){return l(W,0),0},function(){return l(H,0),0}];case 14:var $=ne(r[0]),rr=$[3],nr=$[2],er=$[1],tr=$[0];return[function(){return l(tr,0),0},function(){return l(er,0),0},function(){return l(nr,0),0},function(){return l(rr,0),0}]}}function ee(r,n){var e=0;if("number"==typeof r){if("number"==typeof n)return 0;switch(0|n.tag){case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",816,23]]}}else switch(0|r.tag){case 0:if("number"==typeof n)e=8;else switch(0|n.tag){case 0:return y(0,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 1:if("number"==typeof n)e=8;else switch(0|n.tag){case 1:return y(1,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 2:if("number"==typeof n)e=8;else switch(0|n.tag){case 2:return y(2,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 3:if("number"==typeof n)e=8;else switch(0|n.tag){case 3:return y(3,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 4:if("number"==typeof n)e=8;else switch(0|n.tag){case 4:return y(4,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 5:if("number"==typeof n)e=8;else switch(0|n.tag){case 5:return y(5,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 6:if("number"==typeof n)e=8;else switch(0|n.tag){case 6:return y(6,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 7:if("number"==typeof n)e=8;else switch(0|n.tag){case 7:return y(7,[ee(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 8:if("number"==typeof n)throw[i,["camlinternalFormat.ml",802,26]];switch(0|n.tag){case 8:return y(8,[ee(r[0],n[0]),ee(r[1],n[1])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",802,26]]}break;case 9:if("number"==typeof n)throw[i,["camlinternalFormat.ml",812,28]];switch(0|n.tag){case 8:e=6;break;case 9:var t=ne(ee(re(r[1]),n[0]));return l(t[1],0),l(t[3],0),y(9,[r[0],n[1],ee(r[2],n[2])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",812,28]]}break;case 10:if("number"==typeof n)throw[i,["camlinternalFormat.ml",780,21]];if(10===n.tag)return y(10,[ee(r[0],n[0])]);throw[i,["camlinternalFormat.ml",780,21]];case 11:if("number"==typeof n)throw[i,["camlinternalFormat.ml",784,21]];switch(0|n.tag){case 10:e=1;break;case 11:return y(11,[ee(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",784,21]]}break;case 12:if("number"==typeof n)throw[i,["camlinternalFormat.ml",788,19]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:return y(12,[ee(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",788,19]]}break;case 13:if("number"==typeof n)throw[i,["camlinternalFormat.ml",792,22]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:return y(13,[ee(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",792,22]]}break;case 14:if("number"==typeof n)throw[i,["camlinternalFormat.ml",797,30]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:return y(14,[ee(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",797,30]]}}switch(e){case 1:throw[i,["camlinternalFormat.ml",781,21]];case 2:throw[i,["camlinternalFormat.ml",785,21]];case 3:throw[i,["camlinternalFormat.ml",789,19]];case 4:throw[i,["camlinternalFormat.ml",793,22]];case 5:throw[i,["camlinternalFormat.ml",798,30]];case 6:throw[i,["camlinternalFormat.ml",803,26]];case 7:throw[i,["camlinternalFormat.ml",813,28]];case 8:throw[i,["camlinternalFormat.ml",817,23]]}}var te=wr("CamlinternalFormat.Type_mismatch");function ue(r,n){if("number"==typeof r)return[0,n];if(r.tag){if("number"==typeof n)throw te;if(2===n.tag)return[y(1,[r[0]]),n[0]];throw te}return[y(0,[r[0],r[1]]),n]}function ae(r,n,e){var t=ue(r,e);if("number"==typeof n){if(0!==n){var u=t[1];if("number"==typeof u)throw te;if(2===u.tag)return[t[0],1,u[0]];throw te}return[t[0],0,t[1]]}return[t[0],[n[0]],t[1]]}function ie(r,n,e){var t=ce(n,e);return[y(23,[r,t[0]]),t[1]]}function ce(r,n){if("number"==typeof r)return[0,n];switch(0|r.tag){case 0:if("number"==typeof n)throw te;if(n.tag)throw te;var e=ce(r[0],n[0]);return[y(0,[e[0]]),e[1]];case 1:if("number"==typeof n)throw te;if(n.tag)throw te;var t=ce(r[0],n[0]);return[y(1,[t[0]]),t[1]];case 2:var u=ue(r[0],n),a=u[1];if("number"==typeof a)throw te;if(1===a.tag){var i=ce(r[1],a[0]);return[y(2,[u[0],i[0]]),i[1]]}throw te;case 3:var c=ue(r[0],n),o=c[1];if("number"==typeof o)throw te;if(1===o.tag){var f=ce(r[1],o[0]);return[y(3,[c[0],f[0]]),f[1]]}throw te;case 4:var s=ae(r[1],r[2],n),v=s[2];if("number"==typeof v)throw te;if(2===v.tag){var h=ce(r[3],v[0]);return[y(4,[r[0],s[0],s[1],h[0]]),h[1]]}throw te;case 5:var g=ae(r[1],r[2],n),m=g[2];if("number"==typeof m)throw te;if(3===m.tag){var b=ce(r[3],m[0]);return[y(5,[r[0],g[0],g[1],b[0]]),b[1]]}throw te;case 6:var w=ae(r[1],r[2],n),p=w[2];if("number"==typeof p)throw te;if(4===p.tag){var d=ce(r[3],p[0]);return[y(6,[r[0],w[0],w[1],d[0]]),d[1]]}throw te;case 7:var k=ae(r[1],r[2],n),_=k[2];if("number"==typeof _)throw te;if(5===_.tag){var C=ce(r[3],_[0]);return[y(7,[r[0],k[0],k[1],C[0]]),C[1]]}throw te;case 8:var A=ae(r[1],r[2],n),S=A[2];if("number"==typeof S)throw te;if(6===S.tag){var F=ce(r[3],S[0]);return[y(8,[r[0],A[0],A[1],F[0]]),F[1]]}throw te;case 9:if("number"==typeof n)throw te;if(7===n.tag){var x=ce(r[0],n[0]);return[y(9,[x[0]]),x[1]]}throw te;case 10:var M=ce(r[0],n);return[y(10,[M[0]]),M[1]];case 11:var O=ce(r[1],n);return[y(11,[r[0],O[0]]),O[1]];case 12:var T=ce(r[1],n);return[y(12,[r[0],T[0]]),T[1]];case 13:if("number"==typeof n)throw te;if(8===n.tag){var I=n[0];if(N([r[1]],[I]))throw te;var q=ce(r[2],n[1]);return[y(13,[r[0],I,q[0]]),q[1]]}throw te;case 14:if("number"==typeof n)throw te;if(9===n.tag){var D=n[0];if(N([dr(r[1])],[dr(D)]))throw te;var E=ce(r[2],dr(n[2]));return[y(14,[r[0],D,E[0]]),E[1]]}throw te;case 15:if("number"==typeof n)throw te;if(10===n.tag){var L=ce(r[0],n[0]);return[y(15,[L[0]]),L[1]]}throw te;case 16:if("number"==typeof n)throw te;if(11===n.tag){var P=ce(r[0],n[0]);return[y(16,[P[0]]),P[1]]}throw te;case 17:var R=ce(r[1],n);return[y(17,[r[0],R[0]]),R[1]];case 18:var U=r[0],B=r[1],V=n;if(U.tag){var X=U[0],G=ce(X[0],V),K=ce(B,G[1]);return[y(18,[y(1,[[G[0],X[1]]]),K[0]]),K[1]]}var j=U[0],J=ce(j[0],V),Z=ce(B,J[1]);return[y(18,[y(0,[[J[0],j[1]]]),Z[0]]),Z[1]];case 19:if("number"==typeof n)throw te;if(13===n.tag){var z=ce(r[0],n[0]);return[y(19,[z[0]]),z[1]]}throw te;case 20:if("number"==typeof n)throw te;if(1===n.tag){var H=ce(r[2],n[0]);return[y(20,[r[0],r[1],H[0]]),H[1]]}throw te;case 21:if("number"==typeof n)throw te;if(2===n.tag){var W=ce(r[1],n[0]);return[y(21,[r[0],W[0]]),W[1]]}throw te;case 23:var Y=r[0],Q=r[1],$=n;if("number"==typeof Y){if(3===Y){if("number"==typeof $)throw te;if(14===$.tag){var rr=ce(Q,$[0]);return[y(23,[3,rr[0]]),rr[1]]}throw te}return ie(Y,Q,$)}switch(0|Y.tag){case 7:return ie(y(7,[Y[0],Y[1]]),Q,$);case 8:var nr=function r(n,e,t){{if("number"==typeof n)return[0,ce(e,t)];switch(0|n.tag){case 0:if("number"==typeof t)throw te;if(t.tag)throw te;var u=r(n[0],e,t[0]);return[y(0,[u[0]]),u[1]];case 1:if("number"==typeof t)throw te;if(1===t.tag){var a=r(n[0],e,t[0]);return[y(1,[a[0]]),a[1]]}throw te;case 2:if("number"==typeof t)throw te;if(2===t.tag){var i=r(n[0],e,t[0]);return[y(2,[i[0]]),i[1]]}throw te;case 3:if("number"==typeof t)throw te;if(3===t.tag){var c=r(n[0],e,t[0]);return[y(3,[c[0]]),c[1]]}throw te;case 4:if("number"==typeof t)throw te;if(4===t.tag){var o=r(n[0],e,t[0]);return[y(4,[o[0]]),o[1]]}throw te;case 5:if("number"==typeof t)throw te;if(5===t.tag){var f=r(n[0],e,t[0]);return[y(5,[f[0]]),f[1]]}throw te;case 6:if("number"==typeof t)throw te;if(6===t.tag){var s=r(n[0],e,t[0]);return[y(6,[s[0]]),s[1]]}throw te;case 7:if("number"==typeof t)throw te;if(7===t.tag){var v=r(n[0],e,t[0]);return[y(7,[v[0]]),v[1]]}throw te;case 8:if("number"==typeof t)throw te;if(8===t.tag){var h=t[0];if(N([n[0]],[h]))throw te;var g=r(n[1],e,t[1]);return[y(8,[h,g[0]]),g[1]]}throw te;case 9:if("number"==typeof t)throw te;if(9===t.tag){var m=t[1],b=t[0];if(N([dr(n[0])],[dr(b)]))throw te;if(N([dr(n[1])],[dr(m)]))throw te;var w=ee(re(b),m),p=ne(w);l(p[1],0),l(p[3],0);var d=r(dr(n[2]),e,t[2]);return[y(9,[b,m,re(d[0])]),d[1]]}throw te;case 10:if("number"==typeof t)throw te;if(10===t.tag){var k=r(n[0],e,t[0]);return[y(10,[k[0]]),k[1]]}throw te;case 11:if("number"==typeof t)throw te;if(11===t.tag){var _=r(n[0],e,t[0]);return[y(11,[_[0]]),_[1]]}throw te;case 12:throw te;case 13:if("number"==typeof t)throw te;if(13===t.tag){var C=r(n[0],e,t[0]);return[y(13,[C[0]]),C[1]]}throw te;case 14:if("number"==typeof t)throw te;if(14===t.tag){var A=r(n[0],e,t[0]);return[y(14,[A[0]]),A[1]]}throw te}}}(Y[1],Q,$),er=nr[1];return[y(23,[y(8,[Y[0],nr[0]]),er[0]]),er[1]];default:return ie(Y,Q,$)}case 22:case 24:throw te}}function oe(r,n){return function(r,n){var e=ce(r,n);if("number"==typeof e[1])return e[0];throw te}(r,dr(re(n)))}function fe(r,n,e){var t=e.length,u=_r(n),a=n<0?0:r,i=u;if(i<=t)return e;var c=a,o=Er(i,2===c?48:32);switch(c){case 0:Kr(e,0,o,0,t);break;case 1:Kr(e,0,o,i-t|0,t);break;case 2:t>0&&(43===mr(e,0)||45===mr(e,0)||32===mr(e,0))?(o[0]=mr(e,0),Kr(e,1,o,1+(i-t|0)|0,t-1|0)):t>1&&48===mr(e,0)&&(120===mr(e,1)||88===mr(e,1))?(o[1]=mr(e,1),Kr(e,2,o,2+(i-t|0)|0,t-2|0)):Kr(e,0,o,i-t|0,t)}return gr(o)}function se(r,n){var e=_r(r),t=n.length,u=mr(n,0),a=0;if(u>=58)if(u>=71){if(u>102||u<97)return n;a=2}else{if(!(u>=65))return n;a=2}else if(32!==u){if(!(u>=43))return n;switch(u-43|0){case 0:case 2:a=1;break;case 1:case 3:case 4:return n;case 5:if((e+2|0)>t&&t>1&&(120===mr(n,1)||88===mr(n,1))){var i=Er(e+2|0,48);return i[1]=mr(n,1),Kr(n,2,i,4+(e-t|0)|0,t-2|0),gr(i)}a=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:a=2}}else a=1;switch(a){case 1:if((e+1|0)>t){var c=Er(e+1|0,48);return c[0]=u,Kr(n,1,c,2+(e-t|0)|0,t-1|0),gr(c)}return n;case 2:if(e>t){var o=Er(e,48);return Kr(n,0,o,e-t|0,t),gr(o)}return n}}function ve(r){return Vr((n=r,function(r){for(;;){var e=r;if(e>=n.length)return 0;var t=n.charCodeAt(e);if(!(t>=32))return 1;var u=t-34|0;if(u>58||u<0){if(u>=93)return 1;r=e+1|0}else{if(u>57||u<1)return 1;r=e+1|0}}}(0)?gr(Ur(hr(n))):n),['"',['"',0]]);var n}function le(r,n){var e;switch(r){case 0:e=["%",["d",0]];break;case 1:e=["%+",["d",0]];break;case 2:e=["% ",["d",0]];break;case 3:e=["%",["i",0]];break;case 4:e=["%+",["i",0]];break;case 5:e=["% ",["i",0]];break;case 6:e=["%",["x",0]];break;case 7:e=["%#",["x",0]];break;case 8:e=["%",["X",0]];break;case 9:e=["%#",["X",0]];break;case 10:e=["%",["o",0]];break;case 11:e=["%#",["o",0]];break;case 12:e=["%",["u",0]]}return Vr(gr(Er(1,n)),e)}function he(r,n){if(15===r)return"%.12g";var e=_r(n),t=function(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70}}(r),u=[0,new Array(16)];return Wn(u,37),function(r,n){switch(n){case 1:case 4:case 7:case 10:case 13:return Wn(r,43);case 2:case 5:case 8:case 11:case 14:return Wn(r,32);case 0:case 3:case 6:case 9:case 12:case 15:;}}(u,r),Wn(u,46),Yn(u,""+e),Wn(u,t),Qn(u)}function ge(r,n){return ar(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),n)}function me(r,n){return or(le(r,108),n)}function be(r,n){return cr(le(r,110),n)}function we(r,n){return ir(le(r,76),n)}function pe(r,n,e){var t=function(r,n){var e=tr(r),t=e[9]<0?6:e[9],u=n<0?(e[8]=-1,-n):n,a="";if(isNaN(u))a="nan",e[2]=" ";else if(isFinite(u))switch(e[10]){case"e":var i=(a=u.toExponential(t)).length;"e"===a[i-3|0]&&(a=a.slice(0,i-1|0)+"0"+a.slice(i-1|0));break;case"f":a=u.toFixed(t);break;case"g":var c=0!==t?t:1,o=(a=u.toExponential(c-1|0)).indexOf("e"),f=0|Number(a.slice(o+1|0));if(f<-4||u>=1e21||u.toFixed().length>c){for(var s=o-1|0;"0"===a[s];)s=s-1|0;"."===a[s]&&(s=s-1|0);var v=(a=a.slice(0,s+1|0)+a.slice(o)).length;"e"===a[v-3|0]&&(a=a.slice(0,v-1|0)+"0"+a.slice(v-1|0))}else{var l=c;if(f<0)l=l-(f+1|0)|0,a=u.toFixed(l);else for(;+((a=u.toFixed(l)).length>(c+1|0));)l=l-1|0;if(0!==l){for(var h=a.length-1|0;"0"===a[h];)h=h-1|0;"."===a[h]&&(h=h-1|0),a=a.slice(0,h+1|0)}}}else a="inf",e[2]=" ";return ur(e,a)}(he(r,_r(n)),e);if(15!==r)return t;var u,a=t.length,i=(u=e,isFinite(u)?Math.abs(u)>=2.2250738585072014e-308?0:0!==u?1:2:isNaN(u)?4:3);return 3!==i?i>=4?"nan":function(r){for(;;){var n=r;if(n===a)return 0;var e=mr(t,n)-46|0;if(e>23||e<0){if(55!==e){r=n+1|0;continue}return 1}if(e>22||e<1)return 1;r=n+1|0}}(0)?t:t+".":e<0?"neg_infinity":"infinity"}function de(r){return Vr(function(r){var n=0;if(r>=40){if(92===r)return"\\\\";n=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";n=2}else if(r>=14)n=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:n=1;break;case 13:return"\\r"}switch(n){case 1:var e=new Array(4);return e[0]=92,e[1]=48+(r/100|0)|0,e[2]=48+(r/10|0)%10|0,e[3]=48+r%10|0,gr(e);case 2:var t=new Array(1);return t[0]=r,gr(t)}}(r),["'",["'",0]])}function ye(r){var n=[0,new Array(16)];return function r(n,e){for(;;){var t=e;if("number"==typeof t)return 0;switch(0|t.tag){case 0:Yn(n,"%c"),e=t[0];continue;case 1:Yn(n,"%s"),e=t[0];continue;case 2:Yn(n,"%i"),e=t[0];continue;case 3:Yn(n,"%li"),e=t[0];continue;case 4:Yn(n,"%ni"),e=t[0];continue;case 5:Yn(n,"%Li"),e=t[0];continue;case 6:Yn(n,"%f"),e=t[0];continue;case 7:Yn(n,"%B"),e=t[0];continue;case 8:Yn(n,"%{"),r(n,t[0]),Yn(n,"%}"),e=t[1];continue;case 9:Yn(n,"%("),r(n,t[0]),Yn(n,"%)"),e=t[2];continue;case 10:Yn(n,"%a"),e=t[0];continue;case 11:Yn(n,"%t"),e=t[0];continue;case 12:Yn(n,"%?"),e=t[0];continue;case 13:Yn(n,"%r"),e=t[0];continue;case 14:Yn(n,"%_r"),e=t[0];continue}}}(n,r),Qn(n)}function ke(r,n,e,t){for(;;){var u=t,a=e,c=r;if("number"==typeof u)return h(c,n,a);switch(0|u.tag){case 0:return function(r,e,t){return function(u){var a=y(5,[e,u]);return ke(r,n,a,t)}}(c,a,u[0]);case 1:return function(r,e,t){return function(u){var a=de(u),i=y(4,[e,a]);return ke(r,n,i,t)}}(c,a,u[0]);case 2:return Ne(c,n,a,u[1],u[0],function(r){return r});case 3:return Ne(c,n,a,u[1],u[0],ve);case 4:return Ae(c,n,a,u[3],u[1],u[2],ge,u[0]);case 5:return Ae(c,n,a,u[3],u[1],u[2],me,u[0]);case 6:return Ae(c,n,a,u[3],u[1],u[2],be,u[0]);case 7:return Ae(c,n,a,u[3],u[1],u[2],we,u[0]);case 8:var o=c,f=n,s=a,v=u[3],g=u[1],m=u[2],b=u[0];if("number"!=typeof g){if(g.tag){var w=g[0];return"number"==typeof m?0!==m?function(r,n,e,t,u,a){return function(i,c,o){var f=fe(a,i,pe(u,c,o));return ke(r,n,y(4,[e,f]),t)}}(o,f,s,v,b,w):function(r,n,e,t,u,a){return function(i,c){var o=pe(u,6,c),f=fe(a,i,o);return ke(r,n,y(4,[e,f]),t)}}(o,f,s,v,b,w):function(r,n,e,t,u,a,i){return function(c,o){var f=fe(a,c,pe(u,i,o));return ke(r,n,y(4,[e,f]),t)}}(o,f,s,v,b,w,m[0])}var p=g[1],d=g[0];return"number"==typeof m?0!==m?function(r,n,e,t,u,a,i){return function(c,o){var f=fe(a,i,pe(u,c,o));return ke(r,n,y(4,[e,f]),t)}}(o,f,s,v,b,d,p):function(r,n,e,t,u,a,i){return function(c){var o=pe(u,6,c),f=fe(a,i,o);return ke(r,n,y(4,[e,f]),t)}}(o,f,s,v,b,d,p):function(r,n,e,t,u,a,i,c){return function(o){var f=fe(a,i,pe(u,c,o));return ke(r,n,y(4,[e,f]),t)}}(o,f,s,v,b,d,p,m[0])}return"number"==typeof m?0!==m?function(r,n,e,t,u){return function(a,i){var c=pe(u,a,i);return ke(r,n,y(4,[e,c]),t)}}(o,f,s,v,b):function(r,n,e,t,u){return function(a){var i=pe(u,6,a);return ke(r,n,y(4,[e,i]),t)}}(o,f,s,v,b):function(r,n,e,t,u,a){return function(i){var c=pe(u,a,i);return ke(r,n,y(4,[e,c]),t)}}(o,f,s,v,b,m[0]);case 9:return function(r,e,t){return function(u){return ke(r,n,y(4,[e,u?"true":"false"]),t)}}(c,a,u[0]);case 10:t=u[0],e=y(7,[a]);continue;case 11:t=u[1],e=y(2,[a,u[0]]);continue;case 12:t=u[1],e=y(3,[a,u[0]]);continue;case 13:return function(r,e,t,u){return function(){return ke(r,n,y(4,[e,u]),t)}}(c,a,u[2],ye(u[1]));case 14:var k=u[2];return function(r,e,t,u){return function(a){return ke(r,n,e,yr(oe(a[0],t),u))}}(c,a,u[1],k);case 15:return function(r,e,t){return function(u,a){return ke(r,n,y(6,[e,function(r){return h(u,r,a)}]),t)}}(c,a,u[0]);case 16:return function(r,e,t){return function(u){return ke(r,n,y(6,[e,u]),t)}}(c,a,u[0]);case 17:t=u[1],e=y(0,[a,u[0]]);continue;case 18:var _=u[0];if(_.tag){var C=function(r,n,e){return function(t,u){return ke(r,t,y(1,[n,y(1,[u])]),e)}}(c,a,u[1]);t=_[0][0],e=0,r=C;continue}var N=function(r,n,e){return function(t,u){return ke(r,t,y(1,[n,y(0,[u])]),e)}}(c,a,u[1]);t=_[0][0],e=0,r=N;continue;case 19:throw[i,["camlinternalFormat.ml",1449,4]];case 20:return function(r,e,t){return function(){return ke(r,n,t,e)}}(c,u[2],y(8,[a,"Printf: bad conversion %["]));case 21:return function(r,e,t){return function(u){var a=ar("%u",u),i=y(4,[e,a]);return ke(r,n,i,t)}}(c,a,u[1]);case 22:return function(r,e,t){return function(u){var a=y(5,[e,u]);return ke(r,n,a,t)}}(c,a,u[0]);case 23:var A=c,S=n,F=a,x=u[0],M=u[1];if("number"==typeof x){if(3===x)throw[i,["camlinternalFormat.ml",1517,39]];return Ce(A,S,F,M)}return 8===x.tag?_e(A,S,F,x[1],M):Ce(A,S,F,M);case 24:return Se(c,n,a,u[2],u[0],l(u[1],0))}}}function _e(r,n,e,t,u){if("number"==typeof t)return Ce(r,n,e,u);switch(0|t.tag){case 0:var a=t[0];return function(){return _e(r,n,e,a,u)};case 1:var c=t[0];return function(){return _e(r,n,e,c,u)};case 2:var o=t[0];return function(){return _e(r,n,e,o,u)};case 3:var f=t[0];return function(){return _e(r,n,e,f,u)};case 4:var s=t[0];return function(){return _e(r,n,e,s,u)};case 5:var v=t[0];return function(){return _e(r,n,e,v,u)};case 6:var l=t[0];return function(){return _e(r,n,e,l,u)};case 7:var h=t[0];return function(){return _e(r,n,e,h,u)};case 8:var g=t[1];return function(){return _e(r,n,e,g,u)};case 9:var m=t[2],b=ee(re(t[0]),t[1]);return function(){return _e(r,n,e,function r(n,e){if("number"==typeof n)return e;switch(0|n.tag){case 0:return y(0,[r(n[0],e)]);case 1:return y(1,[r(n[0],e)]);case 2:return y(2,[r(n[0],e)]);case 3:return y(3,[r(n[0],e)]);case 4:return y(4,[r(n[0],e)]);case 5:return y(5,[r(n[0],e)]);case 6:return y(6,[r(n[0],e)]);case 7:return y(7,[r(n[0],e)]);case 8:return y(8,[n[0],r(n[1],e)]);case 9:return y(9,[n[0],n[1],r(n[2],e)]);case 10:return y(10,[r(n[0],e)]);case 11:return y(11,[r(n[0],e)]);case 12:return y(12,[r(n[0],e)]);case 13:return y(13,[r(n[0],e)]);case 14:return y(14,[r(n[0],e)])}}(b,m),u)};case 10:var w=t[0];return function(t,a){return _e(r,n,e,w,u)};case 11:var p=t[0];return function(){return _e(r,n,e,p,u)};case 12:var d=t[0];return function(){return _e(r,n,e,d,u)};case 13:throw[i,["camlinternalFormat.ml",1540,31]];case 14:throw[i,["camlinternalFormat.ml",1541,31]]}}function Ce(r,n,e,t){return ke(r,n,y(8,[e,"Printf: bad conversion %_"]),t)}function Ne(r,n,e,t,u,a){if("number"==typeof u)return function(u){var i=l(a,u),c=y(4,[e,i]);return ke(r,n,c,t)};if(u.tag){var i=u[0];return function(u,c){var o=fe(i,u,l(a,c)),f=y(4,[e,o]);return ke(r,n,f,t)}}var c=u[1],o=u[0];return function(u){var i=fe(o,c,l(a,u)),f=y(4,[e,i]);return ke(r,n,f,t)}}function Ae(r,n,e,t,u,a,i,c){if("number"==typeof u){if("number"==typeof a)return 0!==a?function(u,a){var o=se(u,h(i,c,a));return ke(r,n,y(4,[e,o]),t)}:function(u){var a=h(i,c,u);return ke(r,n,y(4,[e,a]),t)};var o=a[0];return function(u){var a=se(o,h(i,c,u));return ke(r,n,y(4,[e,a]),t)}}if(u.tag){var f=u[0];if("number"==typeof a)return 0!==a?function(u,a,o){var s=fe(f,u,se(a,h(i,c,o)));return ke(r,n,y(4,[e,s]),t)}:function(u,a){var o=fe(f,u,h(i,c,a));return ke(r,n,y(4,[e,o]),t)};var s=a[0];return function(u,a){var o=fe(f,u,se(s,h(i,c,a)));return ke(r,n,y(4,[e,o]),t)}}var v=u[1],l=u[0];if("number"==typeof a)return 0!==a?function(u,a){var o=fe(l,v,se(u,h(i,c,a)));return ke(r,n,y(4,[e,o]),t)}:function(u){var a=fe(l,v,h(i,c,u));return ke(r,n,y(4,[e,a]),t)};var g=a[0];return function(u){var a=fe(l,v,se(g,h(i,c,u)));return ke(r,n,y(4,[e,a]),t)}}function Se(r,n,e,t,u,a){if(u){var i=u[0];return function(u){return Se(r,n,e,t,i,l(a,u))}}return ke(r,n,y(4,[e,a]),t)}function Fe(r,n){return ke(function(n,t){var u=jr(64);return function r(n,t){for(;;){var u=t,a=0;if("number"==typeof u)return 0;switch(0|u.tag){case 0:var i=$n(u[1]);return r(n,u[0]),Hr(n,i);case 1:var c=u[1];if(r(n,u[0]),c.tag){Hr(n,"@["),t=c[0];continue}Hr(n,"@{"),t=c[0];continue;case 2:case 4:a=1;break;case 3:case 5:a=2;break;case 6:return r(n,u[0]),Hr(n,l(u[1],0));case 7:t=u[0];continue;case 8:throw r(n,u[0]),[e,u[1]]}switch(a){case 1:return r(n,u[0]),Hr(n,u[1]);case 2:return r(n,u[0]),zr(n,u[1])}}}(u,t),l(r,Jr(u))},0,0,n[0])}function xe(r){return Fe(function(r){return r},r)}function Me(r){return 0!==r?0:1}var Oe=[[0,75],[[1,81],[[2,82],[[3,66],[[4,78],[[5,80],0]]]]]];function Te(r){return qr(r,Oe)}function Ie(r,n){for(;;){var e=n;if(!e)throw u;var t=e[0];if(C(r,t[1]))return t[0];n=e[1]}}var qe=Xn(8,8,0);function De(r,n,e){return o(f(qe,r),n,[[e,1]]),o(f(qe,r),7-n|0,[[e,0]])}for(var Ee=0;Ee<=7;++Ee)De(Ee,1,5);De(0,0,2),De(7,0,2),De(1,0,4),De(6,0,4),De(2,0,3),De(5,0,3),De(3,0,1),De(4,0,0);var Le=[qe,1,[1,1],[1,1],0,0,0,[4,0],[4,7],0,0];function Pe(r){return r>=0?+(r<=7):0}function Re(r){return Pe(r[0])?Pe(r[1]):0}function Ue(r){var n=Gn(r);return jn(function(r,e){return o(n,r,Gn(e))},r),n}function Be(r){return[r[0],0]}function Ve(r){return[0,r[1]]}var Xe=wr("Ochess.Illegal_move");function Ge(r,n,e){var t,u=Ue(r[0]),a=function(r,n,e,t){return o(f(u,e),t,f(f(u,r),n)),o(f(u,r),n,0)},i=Me(r[1]),c=r[2],s=r[3],v=[r],l=r[6],h=r[7],g=r[8],m=r[9]+1|0,b=(0|-r[10])+e|0,w=[u,i,c,s,0,v,l,h,g,m,b],p=r[1],d=0;if("number"==typeof n)if(n)if(0!==p){a(0,0,3,0),a(4,0,2,0);var y=w.slice();y[2]=[0,0],y[7]=[2,0],t=y}else{a(0,7,3,7),a(4,7,2,7);var k=w.slice();k[3]=[0,0],k[8]=[2,7],t=k}else if(0!==p){a(7,0,5,0),a(4,0,6,0);var _=w.slice();_[2]=[0,0],_[7]=[6,0],t=_}else{a(7,7,5,7),a(4,7,6,7);var C=w.slice();C[3]=[0,0],C[8]=[6,7],t=C}else if(n.tag){var N=n[2];d=1;var A=0!==p?[6,7]:[1,0],S=A[1];a(n[1],A[0],N,S),o(f(u,N),S,[[n[0],r[1]]]),t=w}else{var F=n[3],x=n[2],M=n[1],O=n[0];f(f(r[0],x),F)&&(d=1),a(O,M,x,F);var T=f(f(u,x),F);if(!T)throw Xe;switch(T[0][0]){case 0:if(0!==r[1]){var I=w.slice();I[2]=[0,0],I[7]=[x,F],t=I}else{var q=w.slice();q[3]=[0,0],q[8]=[x,F],t=q}break;case 2:if(0!==r[1])if(0!==O)if(7!==O)t=w;else if(0!==M)t=w;else{var D=w.slice();D[2]=Be(r[2]),t=D}else if(0!==M)t=w;else{var E=w.slice();E[2]=Ve(r[2]),t=E}else if(0!==O)if(7!==O)t=w;else if(7!==M)t=w;else{var L=w.slice();L[3]=Be(r[3]),t=L}else if(7!==M)t=w;else{var P=w.slice();P[3]=Ve(r[3]),t=P}break;case 1:case 3:case 4:t=w;break;case 5:d=1;var R,U=f(f(u,x),F),B=r[1];if(U){var V=U[0];R=V[0]>=5?0!==V[1]?0!==B&&O===x&&1===M&&3===F?[O]:0:0!==B||O!==x||6!==M||4!==F?0:[O]:0}else R=0;var X=r[4];if(X){var G=X[0];if(G===x)0!==r[1]?5===F&&o(f(u,G),4,0):2===F&&o(f(u,G),3,0)}var K=w.slice();K[4]=R,t=K}}var j=t.slice();return j[6]=d?0:r[6]+1|0,j}var Ke=[[1,2],[[1,-2],[[2,1],[[2,-1],[[-1,2],[[-1,-2],[[-2,1],[[-2,-1],0]]]]]]]],je=[[-1,0],[[0,-1],[[0,1],[[1,0],0]]]],Je=[[-1,-1],[[-1,1],[[1,-1],[[1,1],0]]]],Ze=Nr(Je,je),ze=[[-1,1],[[1,1],0]],He=[[-1,-1],[[1,-1],0]];function We(r,n){return[r[0]+n[0]|0,r[1]+n[1]|0]}function Ye(r,n,e,t,u){return function r(n){return n?Nr(n[0],r(n[1])):0}(xr(function(t){return function(r,n,e,t,u,a,i,c,o){for(;;){var s=o,v=c,l=u,h=t;if(v<1)return s;var g=We([h,l],[a,i]),m=g[1],b=g[0];if(!Re([b,m]))return s;var w=f(f(r[0],b),m);if(w)return w[0][1]!==r[1]?[y(0,[n,e,b,m]),s]:s;o=[y(0,[n,e,b,m]),s],c=v-1|0,u=m,t=b}}(r,n,e,n,e,t[0],t[1],u,0)},t))}function Qe(r,n,e,t,u,a,i,c){for(;;){var o=c,s=u,v=t;if(o<1)return 0;var l=We([v,s],[a,i]),h=l[1],g=l[0];if(!Re([g,h]))return 0;var m=f(f(r[0],g),h);if(m){var b=m[0];return b[1]!==n?Ir(b[0],e):0}c=o-1|0,u=h,t=g}}function $e(r,n,e,t,u,a,i){for(;;){var c=a;if(!c)return 0;var o=c[0];if(Qe(r,n,e,t,u,o[0],o[1],i))return 1;a=c[1]}}function rt(r,n,e,t){return $e(r,n,[2,[1,0]],e,t,je,10)?1:$e(r,n,[3,[1,0]],e,t,Je,10)?1:$e(r,n,[4,0],e,t,Ke,1)?1:$e(r,n,[0,0],e,t,Ze,1)?1:$e(r,n,[5,0],e,t,1===n?ze:He,1)}function nt(r,n){var e,t=(e=r,[0!==n?e[7]:e[8]]);if(t){var u=t[0];return rt(r,n,u[0],u[1])}return 0}function et(r,n,e,t,u,a){if(n){if(C(f(f(r[0],a),e),[[2,r[1]]])){if(function(r,n,e,t){for(;;){var u=e;if(u>t)return 1;if(0!==f(f(r[0],u),n))return 0;e=u+1|0}}(r,e,A(s=t,v=u)?s:v,kr(t,u))){if(rt(r,r[1],4,e))return 0;var i=Ue(r[0]);o(f(i,4),e,0),o(f(i,t),e,[[0,r[1]]]);var c=r.slice();return 1-rt((c[0]=i,c),r[1],t,e)}return 0}return 0}return 0;var s,v}function tt(r,n,e){var t=function(t){return Ye(r,n,e,t,1)},u=function(t){return Ye(r,n,e,t,10)},a=f(f(r[0],n),e);if(!a)return 0;var i,c,o,s,v=a[0],l=v[1];if(l!==r[1])return 0;switch(v[0]){case 0:return Nr((c=0!==(i=r)[1]?[i[2],0]:[i[3],7],o=c[1],Nr(et(i,(s=c[0])[0],o,3,1,0)?[1,0]:0,et(i,s[1],o,5,6,7)?[0,0]:0)),t(Ze));case 1:return u(Ze);case 2:return u(je);case 3:return u(Je);case 4:return t(Ke);case 5:var h=0!==l?e+1|0:e-1|0,g=[0],m=function(r){return g[0]=[r,g[0]],0},b=[3,[4,[2,[1,0]]]];if(7===h&&1===l||0===h&&0===l)f(f(r[0],n),h)||Or(function(r){return m(y(1,[r,n,n]))},b),Or(function(e){if(Pe(e)){var t=f(f(r[0],e),h);return t&&t[0][1]!==l?Or(function(r){return m(y(1,[r,n,e]))},b):0}return 0},[n-1|0,[n+1|0,0]]);else f(f(r[0],n),h)||m(y(0,[n,e,n,h])),Or(function(t){if(Pe(t)){var u=f(f(r[0],t),h);return u&&u[0][1]!==l?m(y(0,[n,e,t,h])):0}return 0},[n-1|0,[n+1|0,0]]);if(1!==e){if(6===e&&!l){var w=f(f(r[0],n),5),p=f(f(r[0],n),4);w||p||m(y(0,[n,e,n,4]))}}else if(0!==l){var d=f(f(r[0],n),2),k=f(f(r[0],n),3);d||k||m(y(0,[n,e,n,3]))}var _=r[4];if(_){var C=_[0],N=0!==l?5:2;Or(function(r){return Pe(r)&&r===C&&h===N?m(y(0,[n,e,r,h])):0},[n-1|0,[n+1|0,0]])}return g[0]}}var ut=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,3,5,5,3,0,0],[0,0,5,9,9,5,0,0],[0,0,5,9,9,5,0,0],[0,0,3,5,5,3,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]];(function(r,n,e,t){var u,a,i=(u=e,0!==t?u:7-u|0);switch(r){case 0:a=1e6-F(5,f(f(ut,n),i))|0;break;case 1:a=9e3+F(10,f(f(ut,n),i))|0;break;case 2:a=5e3+F(10,f(f(ut,n),i))|0;break;case 3:a=3200+F(20,f(f(ut,n),i))|0;break;case 4:a=3e3+F(30,f(f(ut,n),i))|0;break;case 5:a=1e3+F(30,f(f(ut,n),i))|0}F(5,i)})(0,0,0,1),wr("Ochess.Interrupt"),wr("Ochess.Illegal_position");function at(r){return Dr(function(n){return 1-nt(Ge(r,n,0),r[1])})(function(r){for(var n=0,e=0;e<=7;++e)for(var t=0;t<=7;++t)n=Nr(tt(r,e,t),n);return n}(r))}function it(r){switch(r){case 0:return"king";case 1:return"queen";case 2:return"rook";case 3:return"bishop";case 4:return"knight";case 5:return"pawn"}}function ct(r){return 0!==r?"white":"black"}function ot(r){return 0!==r?0:7}function ft(r,n){return Ge(r,n,0)}var st=[[[0,0],107],[[[0,1],75],[[[1,0],113],[[[1,1],81],[[[2,0],114],[[[2,1],82],[[[3,0],98],[[[3,1],66],[[[4,0],110],[[[4,1],78],[[[5,0],112],[[[5,1],80],0]]]]]]]]]]]];function vt(r,n){if("number"==typeof n)return y(2,n?[1]:[0]);if(n.tag){var e=n[2],t=n[1];return y(1,[t,[e,0!==r[1]?7:0],+(t!==e),[n[0]]])}var u=n[3],a=n[2],i=n[1],c=n[0],o=f(f(r[0],c),i);if(o){var s=o[0][0];return s>=5?y(1,[c,[a,u],+(c!==a),0]):y(0,[s,[c,i],[a,u],f(f(r[0],a),u)?1:0])}throw Xe}function lt(r,n){return n&&!C(r,n[0])?0:1}function ht(r,n){return+(1===Ar(Dr(function(r){return function(r,n){switch(0|n.tag){case 0:var e=n[1];return C(r[3],n[2])&&r[0]===n[0]&&lt(e[0],r[1])?lt(e[1],r[2]):0;case 1:case 2:return 0}}(n,r)})(r)))}function gt(r,n,e){var t,u,a,i=vt(r,e),c=nt(t=Ge(r,e,0),t[1])?at(t)?0:1:2,o=function(r,n){switch(0|n.tag){case 0:var e=n[3],t=n[2],u=n[1],a=u[1],i=u[0],c=n[0],o=[c,0,0,t,e];if(ht(r,o))return[o];var f=[c,[i],0,t,e];if(ht(r,f))return[f];var s=[c,0,[a],t,e];return ht(r,s)?[s]:[[c,[i],[a],t,e]];case 1:case 2:return 0}}(n,i);if(o){var f=o[0],s=f[3],v=f[2],h=f[1];u=w(xe([y(0,[y(2,[0,y(2,[0,y(2,[0,y(0,[y(0,[0])])])])])]),"%c%s%s%s%c%c"]),Te(f[0]),h?l(xe([y(0,[0]),"%c"]),mr("abcdefgh",h[0])):"",v?l(xe([y(0,[0]),"%c"]),mr("12345678",v[0])):"",f[4]?"x":"",mr("abcdefgh",s[0]),mr("12345678",s[1]))}else switch(0|i.tag){case 0:throw Xe;case 1:var g=i[3],b=i[1];u=m(xe([y(2,[0,y(0,[y(0,[y(2,[0,0])])])]),"%s%c%c%s"]),i[2]?l(xe([y(0,[y(12,[120,0])]),"%cx"]),mr("abcdefgh",i[0])):"",mr("abcdefgh",b[0]),mr("12345678",b[1]),g?l(xe([y(12,[61,y(0,[0])]),"=%c"]),Te(g[0])):"");break;case 2:var p=i[0];if("number"!=typeof p)throw Xe;u=0!==p?"O-O-O":"O-O"}switch(c){case 0:a="+";break;case 1:a="#";break;case 2:a=""}return u+a}function mt(r,n){var e=xr(function(n){return vt(r,n)},at(r));return gt(r,e,n)}var bt=e;function wt(r){var n=r.split("/");if(8!==n.length)throw[bt,"not exactly 8 ranks"];var t=Xn(8,8,0),a=[0],i=[0];jn(function(r,n){var c=7-r|0,s=[0];return Xr(function(r){var n=r-48|0;if(n>8||n<0){if(75!==r){if(107===r){if(i[0])throw[bt,"more than one black king"];i[0]=[[s[0],c]]}}else{if(a[0])throw[bt,"more than one white king"];a[0]=[[s[0],c]]}try{o(f(t,s[0]),c,[Ie(r,st)])}catch(r){var v=Vn(r);throw v[0]===e?[bt,"too many squares on one rank"]:v===u?[bt,"not a piece"]:v}return s[0]=s[0]+1|0,0}switch(n){case 0:return 0;case 1:return s[0]=s[0]+1|0,0;case 2:return s[0]=s[0]+2|0,0;case 3:return s[0]=s[0]+3|0,0;case 4:return s[0]=s[0]+4|0,0;case 5:return s[0]=s[0]+5|0,0;case 6:return s[0]=s[0]+6|0,0;case 7:return s[0]=s[0]+7|0,0;case 8:return s[0]=s[0]+8|0,0}},n)},n);var c=a[0],s=i[0];if(c){if(s)return[t,c[0],s[0]];throw[bt,"black king is missing"]}throw s?[bt,"white king is missing"]:[bt,"both kings are missing"]}function pt(r){return[[Gr(r,81),Gr(r,75)],[Gr(r,113),Gr(r,113)]]}function dt(r){switch(r){case"b":return 0;case"w":return 1;default:throw[bt,"whose move is it?"]}}function yt(r){if("-"===r)return 0;try{return[function(r){var n=r-97|0;if(n>7||n<0)throw[e,"not a file"];return n}(mr(r,0))]}catch(r){throw[bt,"en passant square couldn't be parsed"]}}var kt=[bt,function(r){var n=[7,[6,[5,[4,[3,[2,[1,[0,0]]]]]]]],e=Vr("/",xr(function(e){var t=function(n,t){for(;;){var u=t,a=n,i=a[1],c=a[0];if(!u)return[c,i];var o=u[1],s=f(f(r[0],u[0]),e);if(s){var v=s[0];if(t=o,i>0){n=[[qr(v,st),[mr("0123456789",i),c]],0];continue}n=[[qr(v,st),c],0]}else t=o,n=[c,i+1|0]}}([0,0],n),u=t[1],a=t[0];return fn(u>0?[mr("0123456789",u),a]:a)},n)),t=1+(r[9]/2|0)|0,u=r[4],a=u?h(xe([y(0,[y(0,[0])]),"%c%c"]),mr("abcdefgh",u[0]),1===r[1]?54:51):"-",i=r[2],c=0!==i[0]?0!==i[1]?"KQ":"Q":0!==i[1]?"K":"",o=r[3],s=c+(0!==o[0]?0!==o[1]?"kq":"q":0!==o[1]?"k":""),v=0!==r[1]?119:98;return w(xe([y(2,[0,y(12,[32,y(0,[y(12,[32,y(2,[0,y(12,[32,y(2,[0,y(12,[32,y(4,[0,0,0,y(12,[32,y(4,[0,0,0,0])])])])])])])])])])]),"%s %c %s %s %d %d"]),e,v,s,a,r[6],t)},wt,pt,dt,yt,function(r){var n=Jn(r.split(" "));if(n){var e=n[1];if(e){var t=e[1];if(t){var u=t[1];if(u){var a=u[1];if(a){var i=a[1];if(i){if(i[1])throw[bt,"too many or missing fields"];var c,o,f=wt(n[0]),s=pt(t[0]),v=dt(e[0]);try{c=er(a[0])}catch(r){throw[bt,"halfmove clock couldn't be parsed"]}try{var l=er(i[0])<<1;o=0!==v?l-2|0:l-1|0}catch(r){throw[bt,"fullmove clock couldn't be parsed"]}return[f[0],v,s[0],s[1],yt(u[0]),0,c,f[1],f[2],o,0]}throw[bt,"too many or missing fields"]}throw[bt,"too many or missing fields"]}throw[bt,"too many or missing fields"]}throw[bt,"too many or missing fields"]}throw[bt,"too many or missing fields"]}throw[bt,"too many or missing fields"]}],_t=Me,Ct=function(r){return Ie((n=r)>=97&&n<=122||n>=224&&n<=246||n>=248&&n<=254?n-32|0:n,Oe);var n},Nt=Le,At=Xe,St=at,Ft=function(r){if((n=r)[6]>=100||function(r,n,e){for(;;){var t=e,u=n;if(t<=0)return 1;if(t<<1>u[6])return 0;var a=u[5];if(!a)return 0;var i=a[0];o=i,(c=r)[10]===o[10]&&c[1]===o[1]&&C(c[2],o[2])&&C(c[3],o[3])&&C(c[4],o[4])&&C(c[0],o[0])?(e=t-1|0,n=i):n=i}var c,o}(n,n,2))return 0;var n,e=at(r);return e?y(1,[e]):nt(r,r[1])?y(0,[Me(r[1])]):0};function xt(r){return function(n){return hn(function(n){return ln(r,function(r){var n=[r];return function(r){return vn(n,r)}},n)},function(r){return vn(0,r)},n)}}var Mt=wr("Pgn.Ambiguous_move"),Ot=wr("Pgn.Parse_error"),Tt=Cn(xn([34,0])),It=Nn(xn([32,0])),qt=dn(pn(Sn(34),Tt),Sn(34)),Dt=dn(It,Nn(On));var Et=Cn(dn(dn(pn(Sn(91),function(r){return ln(Dt,function(r){return function(n){return ln(qt,function(n){var e=[fn(r),fn(n)];return function(r){return vn(e,r)}},n)}},r)}),Sn(93)),In)),Lt=wn(Fn([75,[81,[82,[66,[78,[80,0]]]]]]),Ct),Pt=kn(Mr(function(r,n){return pn(Sn(n),function(n){return vn(r,n)})},[97,[98,[99,[100,[101,[102,[103,[104,0]]]]]]]])),Rt=kn(Mr(function(r,n){return pn(Sn(n),function(n){return vn(r,n)})},[49,[50,[51,[52,[53,[54,[55,[56,0]]]]]]]]));function Ut(r){return ln(Pt,function(r){return function(n){return ln(Rt,function(n){var e=[r,n];return function(r){return vn(e,r)}},n)}},r)}var Bt=Sn(120),Vt=Sn(43),Xt=Sn(35),Gt=pn(xt(Sn(61)),Lt),Kt=wn(Nn(Fn([33,[63,0]])),fn),jt=pn(Sn(36),wn(Nn(En),fn));function Jt(r){return hn(jt,Kt,r)}var Zt=Un("0-0"),zt=Un("O-O"),Ht=pn(function(r){return hn(zt,Zt,r)},function(r){return vn(1,r)}),Wt=Un("0-0-0"),Yt=Un("O-O-O"),Qt=pn(function(r){return hn(Yt,Wt,r)},function(r){return vn(0,r)});function $t(r){return hn(Qt,Ht,r)}function ru(r){return ln(Lt,function(r){var n=xt(Pt);return function(e){return ln(n,function(n){var e=xt(Rt);return function(t){return ln(e,function(e){return wn(pn(_n(Bt),Ut),function(t){return y(0,[r,n,e,t])})},t)}},e)}},r)}function nu(r){return ln(Lt,function(r){return wn(pn(_n(Bt),Ut),function(n){return y(0,[r,0,0,n])})},r)}function eu(r){return ln(Ut,function(r){return wn(xt(Gt),function(n){return y(1,[0,r,n])})},r)}var tu=xt(Pt);function uu(r){return ln(tu,function(r){var n=pn(_n(Bt),Ut);return function(e){return ln(n,function(n){return wn(xt(Gt),function(e){return y(1,[r,n,e])})},e)}},r)}var au=dn(function(r){return hn(function(r){return hn(function(r){return hn(function(r){return hn($t,ru,r)},nu,r)},eu,r)},uu,r)},_n(function(r){return hn(Vt,Xt,r)})),iu=wn(dn(pn(Sn(123),Cn(xn([125,0]))),Sn(125)),fn),cu=Un("."),ou=Un("..."),fu=Un(". ...");function su(r){return hn(fu,ou,r)}var vu=dn(Nn(En),function(r){return hn(su,cu,r)});function lu(){var r=Cn(Rn(iu));return function(n){return ln(r,function(r){var n=pn(xt(Rn(vu)),Rn(au));return function(e){return ln(n,function(n){var e=Cn(Rn(Jt));return function(t){return ln(e,function(e){var t=Cn(Rn(iu));return function(u){return ln(t,function(t){var u=Cn(Rn(dn(pn(Sn(40),Rn(An(lu(),On))),Rn(Sn(41)))));return function(a){return ln(u,function(u){var a=[n,r,t,e,u];return function(r){return vn(a,r)}},a)}},u)}},t)}},e)}},n)}}var hu=pn(Un("*"),function(r){return vn(0,r)}),gu=[y(0,[0])],mu=pn(Un("0-1"),function(r){return vn(gu,r)}),bu=[0],wu=pn(Un("1/2"),function(r){return vn(bu,r)}),pu=[0],du=pn(Un("1/2-1/2"),function(r){return vn(pu,r)}),yu=[y(0,[1])],ku=pn(Un("1-0"),function(r){return vn(yu,r)});function _u(r){return hn(ku,du,r)}function Cu(r){return hn(_u,wu,r)}function Nu(r){return hn(Cu,mu,r)}function Au(r){return hn(Nu,hu,r)}var Su=dn(Rn(Et),xt(In));function Fu(r){return ln(Su,function(r){var n=dn(An(lu(),On),Tn);return function(e){return ln(n,function(n){return function(e){return ln(Au,function(e){var t=[r,n,e];return function(r){return vn(t,r)}},e)}},e)}},r)}function xu(r,n){var e=St(r),t=Dr(function(e){return function(r,n,e){if("number"==typeof n)return n?"number"==typeof e&&0===e?1:0:"number"==typeof e&&0!==e?1:0;if(n.tag){var t=n[2],u=n[1],a=u[1],i=u[0],c=n[0];if(t){if("number"==typeof e)return 0;if(1===e.tag){var o=e[1],s=0!==r[1]?7:0,v=0!==r[1]?6:1;return C(f(f(r[0],o),v),[[5,r[1]]])&&lt(o,c)&&e[2]===i&&s===a?+(e[0]===t[0]):0}return 0}if("number"==typeof e)return 0;if(e.tag)return 0;var l=e[0];return C(f(f(r[0],l),e[1]),[[5,r[1]]])&&lt(l,c)&&e[2]===i?+(e[3]===a):0}if("number"==typeof e)return 0;if(e.tag)return 0;var h=e[1],g=e[0],m=n[3];return C(f(f(r[0],g),h),[[n[0],r[1]]])&&lt(g,n[1])&&lt(h,n[2])&&e[2]===m[0]?+(e[3]===m[1]):0}(r,n,e)})(e);if(t){if(t[1])throw Mt;return t[0]}throw At}function Mu(r){var n=function(r){return r?r[4]:0},t=function(r,e,t,u){var a=n(r),i=n(u);return[r,e,t,u,a>=i?a+1|0:i+1|0]},a=function(r,n){return[0,r,n,0,1]},c=function(r,u,a,i){var c=r?r[4]:0,o=i?i[4]:0;if(c>(o+2|0)){if(r){var f=r[3],s=r[2],v=r[1],l=r[0];if(n(l)>=n(f))return t(l,v,s,t(f,u,a,i));if(f)return t(t(l,v,s,f[0]),f[1],f[2],t(f[3],u,a,i));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(o>(c+2|0)){if(i){var h=i[3],g=i[2],m=i[1],b=i[0];if(n(h)>=n(b))return t(t(r,u,a,b),m,g,h);if(b)return t(t(r,u,a,b[0]),b[1],b[2],t(b[3],m,g,h));throw[e,"Map.bal"]}throw[e,"Map.bal"]}return[r,u,a,i,c>=o?c+1|0:o+1|0]},o=function(n,e,t){if(t){var u=t[3],a=t[2],i=t[1],f=t[0],s=h(r[0],n,i);return s?s<0?c(o(n,e,f),i,a,u):c(f,i,a,o(n,e,u)):[f,n,e,u,t[4]]}return[0,n,e,0,1]},f=function(r){for(;;){var n=r;if(n){var e=n[0];if(e){r=e;continue}return[n[1],n[2]]}throw u}},s=function(r){if(r){var n=r[0];return n?c(s(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]},v=function(n,e){if(e){var t=e[3],u=e[2],a=e[1],i=e[0],o=h(r[0],n,a);if(o)return o<0?c(v(n,i),a,u,t):c(i,a,u,v(n,t));var l=i,g=t;if(l){if(g){var m=f(g);return c(l,m[0],m[1],s(g))}return l}return g}return 0},m=function(r,n){for(;;){var e=n;if(!e)return 0;m(r,e[0]),h(r,e[1],e[2]),n=e[3]}},b=function(r,n){if(n){var e=b(r,n[0]),t=l(r,n[2]),u=b(r,n[3]);return[e,n[1],t,u,n[4]]}return 0},w=function(r,n){if(n){var e=n[1];return[w(r,n[0]),e,h(r,e,n[2]),w(r,n[3]),n[4]]}return 0},p=function(r,n,e){for(;;){var t=e,u=n;if(!u)return t;e=g(r,u[1],u[2],p(r,u[0],t)),n=u[3]}},d=function(r,n){for(;;){var e=n;if(e){if(h(r,e[1],e[2])){if(d(r,e[0])){n=e[3];continue}return 0}return 0}return 1}},y=function(r,n){for(;;){var e=n;if(!e)return 0;if(h(r,e[1],e[2]))return 1;if(y(r,e[0]))return 1;n=e[3]}},k=function(r,n,e){return e?c(k(r,n,e[0]),e[1],e[2],e[3]):a(r,n)},_=function(r,n,e){return e?c(e[0],e[1],e[2],_(r,n,e[3])):a(r,n)},C=function(r,n,e,u){if(r){if(u){var a=u[4],i=r[4];return i>(a+2|0)?c(r[0],r[1],r[2],C(r[3],n,e,u)):a>(i+2|0)?c(C(r,n,e,u[0]),u[1],u[2],u[3]):t(r,n,e,u)}return _(n,e,r)}return k(n,e,u)},N=function(r,n){if(r){if(n){var e=f(n);return C(r,e[0],e[1],s(n))}return r}return n},A=function(r,n,e,t){return e?C(r,n,e[0],t):N(r,t)},S=function(n,e){if(e){var t=e[3],u=e[2],a=e[1],i=e[0],c=h(r[0],n,a);if(c){if(c<0){var o=S(n,i);return[o[0],o[1],C(o[2],a,u,t)]}var f=S(n,t);return[C(i,a,u,f[0]),f[1],f[2]]}return[i,[u],t]}return[0,0,0]},F=function(r,e,t){var u=0;if(e){var a=e[1];if(e[4]>=n(t)){var c=S(a,t);return A(F(r,e[0],c[0]),a,g(r,a,[e[2]],c[1]),F(r,e[3],c[2]))}u=1}else{if(!t)return 0;u=1}if(1===u){if(t){var o=t[1],f=S(o,e);return A(F(r,f[0],t[0]),o,g(r,o,f[1],[t[2]]),F(r,f[2],t[3]))}throw[i,["map.ml",270,10]]}},x=function(r,n){if(n){var e=n[2],t=n[1],u=x(r,n[0]),a=h(r,t,e),i=x(r,n[3]);return a?C(u,t,e,i):N(u,i)}return 0},M=function(r,n){if(n){var e=n[2],t=n[1],u=M(r,n[0]),a=u[1],i=u[0],c=h(r,t,e),o=M(r,n[3]),f=o[1],s=o[0];return c?[C(i,t,e,s),N(a,f)]:[N(i,s),C(a,t,e,f)]}return[0,0]},O=function(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}},T=function(r){return r?(T(r[0])+1|0)+T(r[3])|0:0},I=function(r,n){for(;;){var e=n,t=r;if(!e)return t;n=e[0],r=[[e[1],e[2]],I(t,e[3])]}};return[0,function(r){return r?0:1},function(n,e){for(;;){var t=e;if(t){var u=h(r[0],n,t[1]);if(u){e=u<0?t[0]:t[3];continue}return 1}return 0}},o,a,v,F,function(n,e,t){for(var u=O(e,0),a=O(t,0);;){var i=a,c=u;if(c){if(i){var o=h(r[0],c[0],i[0]);if(0!==o)return o;var f=h(n,c[1],i[1]);if(0!==f)return f;a=O(i[2],i[3]),u=O(c[2],c[3]);continue}return 1}return i?-1:0}},function(n,e,t){for(var u=O(e,0),a=O(t,0);;){var i=a,c=u;if(c){if(i){if(h(r[0],c[0],i[0]))return 0;if(h(n,c[1],i[1])){a=O(i[2],i[3]),u=O(c[2],c[3]);continue}return 0}return 0}return i?0:1}},m,p,d,y,x,M,T,function(r){return I(0,r)},f,function(r){for(;;){var n=r;if(n){var e=n[3];if(e){r=e;continue}return[n[1],n[2]]}throw u}},f,S,function(n,e){for(;;){var t=e;if(t){var a=h(r[0],n,t[1]);if(a){e=a<0?t[0]:t[3];continue}return t[2]}throw u}},b,w]}function Ou(r,n,e,t){var u,a,i=n?n[0]:0,c=r.style;return void 0!==c.setProperty?c.setProperty(e,t,i?"important":null):(u=e,a=t,r.style[u]=a,0)}function Tu(r,n,e){return r.insertBefore(n,e)}function Iu(r,n,e,t){return""===n?r.setAttribute(e,t):r.setAttributeNS(n,e,t)}function qu(r,n){return""===r?document.createElement(n):document.createElementNS(r,n)}function Du(r,n,e,t,u,a){return y(2,[r,n,e,t,u,a])}function Eu(r,n,e){return y(3,[r,y(0,[n,e]),[0]])}function Lu(r,n){return y(3,[r,y(1,[n]),[0]])}function Pu(r){for(;;){var n=r;switch(0|n.tag){case 0:return"\x3c!-- "+n[0]+" --\x3e";case 1:return n[0];case 2:var e=n[1],t=n[0];return Vr("",["<",[t,[""===t?"":":",[e,[Vr("",xr(function(r){var n=r;if("number"==typeof n)return"";switch(0|n.tag){case 0:return Vr("",[" ",[n[0],['="',[n[1],['"',0]]]]]);case 1:return Vr("",[" ",[n[1],['="',[n[2],['"',0]]]]]);case 2:return Vr("",[" data-",[n[0],['="',[n[1],['"',0]]]]]);case 3:return"";case 4:return Vr("",[' style="',[Vr(";",xr(function(r){return Vr("",[r[0],[":",[r[1],[";",0]]]])},n[0])),['"',0]]])}},n[4])),[">",[Vr("",xr(Pu,n[5])),["</",[e,[">",0]]]]]]]]]]);case 3:r=l(n[1],0);continue;case 4:r=n[1];continue}}}function Ru(r){if(r.tag){var n=r[0];return function(){return[n]}}return r[1]}function Uu(r,n,e,t){var u,a,i,c,o,f=[Ru(t)],s=(u=r,a=f,function(r){var n=l(a[0],r);return n?l(u[0][0],n[0]):0});return i=e,c=s,o=0,n.addEventListener(i,c,o),[[s,f]]}function Bu(r,n,e){return e?(t=r,u=n,a=e[0][0],i=0,t.removeEventListener(u,a,i),0):0;var t,u,a,i}function Vu(r,n,e,t,u,a,i,c){var o,f,s=i[0];if(s){if(e===t){if(c[0]=i[0],o=u,(f=a).tag?!o.tag||!C(f[0],o[0]):o.tag||f[0]!==o[0]){var v=Ru(a);return s[0][1][0]=v,0}return 0}return i[0]=Bu(n,e,i[0]),c[0]=Uu(r,n,t,a),0}return c[0]=Uu(r,n,t,a),0}function Xu(r,e,t,u,a){return function(r,e,t,u){if("number"==typeof u)return 0;switch(0|u.tag){case 0:return e[u[0]]=void 0,0;case 1:return i=e,c=u[0],o=u[1],""===c?i.removeAttribute(o):i.removeAttributeNS(c,o);case 2:throw console.log(["TODO:  Remove Data Unhandled",u[0],u[1]]),[n,"TODO:  Remove Data Unhandled"];case 3:var a=u[2];return a[0]=Bu(e,u[0],a[0]),0;case 4:return Tr(function(r,n){return Ou(e,0,n[0],null)},0,u[0])}var i,c,o}(0,e,0,u),function(r,e,t,u){if("number"==typeof u)return 0;switch(0|u.tag){case 0:return e[u[0]]=u[1],0;case 1:return Iu(e,u[0],u[1],u[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",u[0],u[1]]),[n,"TODO:  Add Data Unhandled"];case 3:return u[2][0]=Uu(r,e,u[0],u[1]),0;case 4:Tr(function(r,n){return Ou(e,0,n[0],n[1])},0,u[0])}}(r,e,0,a),0}function Gu(r,t,u,a,i){if("number"==typeof i)throw[n,"This should never be called as all entries through NoProp are gated."];switch(0|i.tag){case 0:return t[i[0]]=i[1],0;case 1:return Iu(t,i[0],i[1],i[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",i[0],i[1]]),[n,"TODO:  Mutate Data Unhandled"];case 3:throw[n,"This will never be called because it is gated"];case 4:if("number"==typeof a)throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===a.tag)return function(r,n,t,u){for(;;){var a=u,i=t,c=n;if(i){if(a){u=a[1],t=i[1],n=g(r,c,i[0],a[0]);continue}throw[e,"List.fold_left2"]}if(a)throw[e,"List.fold_left2"];return c}}(function(r,n,e){var u=e[1],a=e[0],i=n[0];return i===a?n[1]===u?0:Ou(t,0,a,u):(Ou(t,0,i,null),Ou(t,0,a,u))},0,a[0],i[0]);throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function Ku(r,n,e,t){return function(r,n,e,t,u){for(;;){var a=u,i=t,c=e;if(!i)return a?0:1;var o=i[0],f=0;if(!a)return 0;if("number"==typeof o){if("number"==typeof a[0]){u=a[1],t=i[1],e=c+1|0;continue}f=1}else switch(0|o.tag){case 0:var s=a[0];if("number"==typeof s)f=1;else{if(!s.tag){o[0]===s[0]&&o[1]===s[1]||Gu(0,n,0,o,s),u=a[1],t=i[1],e=c+1|0;continue}f=1}break;case 1:var v=a[0];if("number"==typeof v)f=1;else{if(1===v.tag){o[0]===v[0]&&o[1]===v[1]&&o[2]===v[2]||Gu(0,n,0,o,v),u=a[1],t=i[1],e=c+1|0;continue}f=1}break;case 2:var l=a[0];if("number"==typeof l)f=1;else{if(2===l.tag){o[0]===l[0]&&o[1]===l[1]||Gu(0,n,0,o,l),u=a[1],t=i[1],e=c+1|0;continue}f=1}break;case 3:var h=a[0];if("number"==typeof h)f=1;else{if(3===h.tag){Vu(r,n,o[0],h[0],o[1],h[1],o[2],h[2]),u=a[1],t=i[1],e=c+1|0;continue}f=1}break;case 4:var g=a[0];if("number"==typeof g)f=1;else{if(4===g.tag){C(o[0],g[0])||Gu(0,n,0,o,g),u=a[1],t=i[1],e=c+1|0;continue}f=1}}1!==f||(Xu(r,n,0,o,a[0]),u=a[1],t=i[1],e=c+1|0)}}(r,n,0,e,t)}function ju(r,e,t,u,i){if(2===i.tag){var c=i[4],o=f(t,u),s=qu(i[0],i[1]);if(0!==Ku(r,s,xr(function(){return 0},c),c))return zu(r,s,s.childNodes,0,0,i[5]),Tu(e,s,o),e.removeChild(o),0;throw[a,["/Users/daniel/Projects/tea-chess/node_modules/bucklescript-tea/src/vdom.ml",319,30]]}throw[n,"Node replacement should never be passed anything but a node itself"]}function Ju(r,n){for(;;){var e=n,t=r;switch(0|e.tag){case 0:var u=e[0];return document.createComment(u);case 1:var i=e[0];return document.createTextNode(i);case 2:var c=e[4],o=qu(e[0],e[1]);if(0!==Ku(t,o,xr(function(){return 0},c),c))return zu(t,o,o.childNodes,0,0,e[5]),o;throw[a,["/Users/daniel/Projects/tea-chess/node_modules/bucklescript-tea/src/vdom.ml",333,30]];case 3:var f=l(e[1],0);e[2][0]=f,n=f;continue;case 4:n=e[1],r=l(e[0],t);continue}}}function Zu(r,e,t,u,a,i){if(2===a.tag){if(2===i.tag){if(a[3]!==i[3]||a[1]!==i[1])return ju(r,e,t,u,i);var c=f(t,u),o=c.childNodes;return Ku(r,c,a[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),ju(r,e,t,u,i)),zu(r,c,o,0,a[5],i[5])}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}function zu(r,n,e,t,u,a){for(;;){var i=a,c=u,o=t;if(!c){if(i){var s=Ju(r,i[0]);n.appendChild(s),a=i[1],u=0,t=o+1|0;continue}return 0}var v=c[0],h=0;switch(0|v.tag){case 0:if(i){var g=i[0];if(g.tag)h=1;else{if(v[0]===g[0]){a=i[1],u=c[1],t=o+1|0;continue}h=1}}else h=1;break;case 1:if(i){var m=i[0];if(1===m.tag){var b=m[0];if(v[0]!==b)f(e,o).nodeValue=b;a=i[1],u=c[1],t=o+1|0;continue}h=1}else h=1;break;case 2:if(i){var w=i[0];if(2===w.tag){var p=i[1],d=w[2],y=w[1],k=w[0],_=c[1],C=v[2],N=v[1],A=v[0];if(C===d&&""!==C){a=p,u=_,t=o+1|0;continue}if(""===C||""===d){Zu(r,n,e,o,v,w),a=p,u=_,t=o+1|0;continue}var S=0,F=0;if(_){var x=_[0];if(2===x.tag){var M=_[1],O=x[2],T=x[1],I=x[0],q=0;if(p){var D=p[0];if(2===D.tag){if(I===k&&T===y&&O===d&&A===D[0]&&N===D[1]&&C===D[2]){var E=f(e,o),L=f(e,o+1|0);n.removeChild(L),Tu(n,L,E),a=p[1],u=M,t=o+2|0;continue}q=4}else q=4}else q=4;if(4===q){if(I===k&&T===y&&O===d){var P=f(e,o);n.removeChild(P),a=p,u=M,t=o+1|0;continue}F=3}}else F=3}else F=3;if(3===F)if(p){var R=p[0];if(2===R.tag){if(A===R[0]&&N===R[1]&&C===R[2]){var U=f(e,o);Tu(n,Ju(r,w),U),a=p,t=o+1|0;continue}S=2}else S=2}else S=2;if(2===S){Zu(r,n,e,o,v,w),a=p,u=_,t=o+1|0;continue}}else h=1}else h=1;break;case 3:if(i){var B=i[0];if(3===B.tag){var V=i[1],X=B[2],G=B[1],K=B[0],j=c[1],J=v[2],Z=v[0];if(Z===K){X[0]=J[0],a=V,u=j,t=o+1|0;continue}var z=0,H=0;if(j){var W=j[0];if(3===W.tag){var Y=j[1],Q=W[0],$=0;if(V){var rr=V[0];if(3===rr.tag){if(Q===K&&Z===rr[0]){var nr=f(e,o),er=f(e,o+1|0);n.removeChild(er),Tu(n,er,nr),a=V[1],u=Y,t=o+2|0;continue}$=4}else $=4}else $=4;if(4===$){if(Q===K){var tr=f(e,o);n.removeChild(tr);var ur=W[2][0];X[0]=ur,a=V,u=Y,t=o+1|0;continue}H=3}}else H=3}else H=3;if(3===H)if(V){var ar=V[0];if(3===ar.tag){if(ar[0]===Z){var ir=f(e,o),cr=l(G,0);X[0]=cr,Tu(n,Ju(r,cr),ir),a=V,t=o+1|0;continue}z=2}else z=2}else z=2;if(2===z){var or=J[0],fr=l(G,0);X[0]=fr,a=[fr,V],u=[or,j];continue}}else h=1}else h=1;break;case 4:u=[v[1],c[1]];continue}if(1!==h);else{var sr=c[1];if(i){var vr=i[0];if(4===vr.tag){zu(l(vr[0],r),n,e,o,[v,0],[vr[1],0]),a=i[1],u=sr,t=o+1|0;continue}var lr=f(e,o);Tu(n,Ju(r,vr),lr),n.removeChild(lr),a=i[1],u=sr,t=o+1|0;continue}var hr=f(e,o);n.removeChild(hr),a=0,u=sr}}}function Hu(r){return y(1,[r])}function Wu(r,n,e,t,u,a){return Du(r?r[0]:"",n,e?e[0]:"",t?t[0]:"",u,a)}function Yu(r,n,e,t){return Du("","div",r?r[0]:"",n?n[0]:"",e,t)}function Qu(r,n,e,t){return Du("","span",r?r[0]:"",n?n[0]:"",e,t)}function $u(r,n,e,t){return Du("","p",r?r[0]:"",n?n[0]:"",e,t)}function ra(r,n,e,t){return Du("","a",r?r[0]:"",n?n[0]:"",e,t)}function na(r,n,e,t){return Du("","section",r?r[0]:"",n?n[0]:"",e,t)}function ea(r,n,e,t){return Du("","button",r?r[0]:"",n?n[0]:"",e,t)}function ta(r,n,e,t){return Du("","input",r?r[0]:"",n?n[0]:"",e,t)}function ua(r,n,e,t){return Du("","label",r?r[0]:"",n?n[0]:"",e,t)}function aa(r,n,e,t){return Du("","ul",r?r[0]:"",n?n[0]:"",e,t)}function ia(r,n,e,t){return Du("","li",r?r[0]:"",n?n[0]:"",e,t)}function ca(r,n,e,t){return Du("","td",r?r[0]:"",n?n[0]:"",e,t)}function oa(r,n,e,t){return Du("","option",r?r[0]:"",n?n[0]:"",e,t)}function fa(r,n,e,t){return Du("","nav",r?r[0]:"",n?n[0]:"",e,t)}function sa(r){return y(0,["id",r])}function va(r){return y(1,["","href",r])}function la(r){return y(0,["className",r])}function ha(r){return y(0,["className",Vr(" ",xr(function(r){return r[0]},Dr(function(r){return r[1]})(r)))])}function ga(r){return y(0,["type",r])}var ma=function(r,n){return y(4,[[[r,n],0]])};function ba(r){return y(0,["value",r])}function wa(r){return y(0,["htmlFor",r])}var pa=Eu;function da(r,n){var e,t,u=r?r[0]:"";return t=function(r){return[l(n,r)]},Eu("change",(e=[u])?e[0]:"",function(r){var n=r.target;if(void 0!==n){var e=n.value;return void 0!==e?l(t,e):0}return 0})}function ya(r){return Lu("click",r)}function ka(r,n){var e,t,u=r?r[0]:"";return t=function(r){return[l(n,r)]},Eu("change",(e=[u])?e[0]:"",function(r){var n=r.target;if(void 0!==n){var e=n.checked;return void 0!==e?l(t,e):0}return 0})}var _a=[function(r){return y(1,["","max",r])},function(r){return y(1,["","min",r])},function(r){return y(1,["","step",r])},function(r){return r?y(1,["","disabled","true"]):0},function(r){return r?y(1,["","selected","true"]):0},function(r){return y(1,["","accept-charset",r])},function(r){return y(1,["","rel",r])}],Ca=y(0,[""]),Na=0;function Aa(r,n,e){return l(n,l(r,e))}var Sa=[_],Fa=[_],xa=Mu(Sa),Ma=Mu(Fa);var Oa=[function(r){var n=Mu(Sa);return[l(n[21],r),l(n[3],r)]}];function Ta(r,n){return ea(0,0,[ya(r),0],[Hu(n),0])}var Ia=[function(r,n){return n?[l(r,n[0])]:0},function(r,n){return n?n[0]:r},function(r,n,e){return e?l(r,e[0]):n},function(r){if(r)return r[0];throw[e,"Option.get"]}],qa=wr("Zipper.End_of_list"),Da=wr("Zipper.Beginning_of_list");function Ea(r){return r}var La=wr("Zipper.No_variations"),Pa=wr("Zipper.No_next_variation"),Ra=wr("Zipper.No_prev_variation"),Ua=wr("Zipper.Not_in_variation"),Ba=wr("Zipper.Not_beginning_of_list");function Va(r){var n=r[0],e=n[1];if(e)return[[n[0],e[1]],[e[0],r[1]]];throw Da}function Xa(r){var n=r[0],e=n[1];if(e){var t=e[0],u=t[1];if(u){var a=u[0],i=a[0];return[i,[[[[n[0],e[1]],t[0],0,i,u[1],r[1]],0],a[1]]]}throw La}throw Da}function Ga(r){var n=r[0],e=n[0];if(n[1])throw Ba;if(e){var t=e[4];if(t){var u=t[0],a=u[0];return[a,[[[e[0],e[1],[[e[3],r[1]],e[2]],a,t[1],e[5]],0],u[1]]]}throw Pa}throw Pa}function Ka(r){var n=r[0],e=n[0];if(n[1])throw Ba;if(e){var t=e[2];if(t){var u=t[0],a=u[0];return[a,[[[e[0],e[1],t[1],a,[[e[3],r[1]],e[4]],e[5]],0],u[1]]]}throw Ra}throw Ra}function ja(r){var n=r[0],e=n[0];if(n[1])throw Ba;if(e){var t=e[1],u=e[0],a=[t,Sr(e[2],[[e[3],r[1]],e[4]])];return[t,[[u[0],[a,u[1]]],e[5]]]}throw Ua}function Ja(r,n){return function(e,t){for(var u=Ea,a=e,i=t;;){var c=i,o=a,f=u;if(!c)return l(f,0);var s=c[0],v=l(n,o);i=c[1],a=v,u=function(n,e,t){return function(u){return l(n,[h(r,e,t),u])}}(f,o,s)}}}function Za(r,n,e,t,u){return Tr(function(e,t){var u=e[1];return[[h(r,u,t),e[0]],l(n,u)]},[u,e],t)}function za(r,n,e,t,u,a,i,c,o,f,s,v,m){var b=m[0],w=function(r,n){return g(u,r,n[0],p(r,n[1]))},p=function(r,n){return l(t,Ja(d,s)(l(f,r),n))},d=function(r,a){return l(e,l(n,[g(u,r,a[0],l(t,0)),y(l(i,r),a[1])]))},y=function(r,n){return Ja(w,i)(r,n)},k=function(r,n){return function(e){return Za(w,c,r,n,e)}},_=function(a,f,m){if(f){var b=l(e,l(n,[g(u,a,f[3],l(t,0)),m])),w=l(o,a),p=[f[0],f[5]],C=g(u,l(o,a),f[1],l(t,Za(d,v,l(v,a),f[2],[b,Ja(d,s)(l(s,a),f[4])])[0])),N=p[0],A=k(l(c,w),N[1])([C,y(l(i,w),p[1])]);return _(A[1],N[0],A[0])}return h(r,a,m)},C=k(a,b[1])(y(l(i,a),m[1]));return l(n,_(C[1],b[0],C[0]))}function Ha(r){return y(2,[function(n){return l(n[0][0],r)}])}function Wa(r,n){if("number"==typeof n)return 0;switch(0|n.tag){case 1:return Tr(function(n,e){return Wa(r,e)},0,n[0]);case 0:case 2:return l(n[0],r)}}function Ya(r,n){return y(0,[function(e){return Wa((t=r,u=e,[[function(r){return l(u[0][0],l(t,r))}]]),n);var t,u}])}var Qa=0;var $a=[Nt,[[0,0],0],0,0],ri=wr("Game.No_prev_position");function ni(r){var n=r[0][5];if(!n)throw ri;var e=n[0];try{return[e,Va(r[1]),r[2],r[3]]}catch(n){if(n===Da)return[e,Va(ja(r[1])[1]),r[2],r[3]];throw n}}function ei(r){try{var n=function(r){var n=r[1];if(n){var e=n[0],t=r[0];return[e[0],[[t[0],[e,t[1]]],n[1]]]}throw qa}(r[1]);return[ft(r[0],n[0][0]),n[1],r[2],r[3]]}catch(n){if(n===qa)return r;throw n}}function ti(r,n){var e=mt(n[0],r),t=function(r,n){var e=n[1],t=n[0],u=t[1],a=t[0];if(e){var i=e[1],c=e[0],o=c[0];return C(o,r)?[1,[[a,[c,u]],i]]:[1,function(r,n,e){for(;;){var t=e,c=n;if(!t)return[[[[a,u],o,c,r,t,i],0],0];var f=t[0],s=f[0];if(C(r,s)){var v=[a,u],l=t[1];return[[[v,o,c,s,l,i],0],f[1]]}e=t[1],n=[f,c]}}(r,0,c[1])]}return[0,[[a,[[r,0],u]],0]]}([r,e,0,0],n[1]);return[ft(n[0],r),t[1],n[2],n[3]]}function ui(r,n){try{var e=l(r,n[1]),t=n[0][5];if(t)return[ft(t[0],e[0][0]),e[1],n[2],n[3]];throw ri}catch(r){return n}}function ai(r){return ui(Ga,r)}function ii(r){return ui(Ka,r)}function ci(r){return ui(Xa,r)}function oi(r){return ui(ja,r)}function fi(r){return r}function si(r){return Tr(function(r,n){var e=function(r){switch(r){case 0:return ei;case 1:return ni;case 2:return ci;case 3:return ai;case 4:return ii;case 5:return oi}}(n);return function(n){return l(r,l(e,n))}},fi,r)}function vi(r){if(r){var n=r[0];return"number"==typeof n?"1/2-1/2":n.tag?"*":0!==n[0]?"1-0":"0-1"}return"*"}function li(r){var n,t,a,i=function(r,n){if(n){var e=o(r,n[0]);return[e[0],i(e[1],n[1])]}return 0},c=function(r,n){var e=xu(r,n[0]);return[[e,mt(r,e),n[1],n[2]],ft(r,e)]},o=function(r,n){var e=xr(function(n){var e=n;if(e){var t=c(r,e[0]);return[t[0],i(t[1],e[1])]}throw Ot},n[4]),t=c(r,n);return[[t[0],e],t[1]]};try{n=Ia[3]((t=r,sn(Fu,on[2](t))))}catch(r){var f=Vn(r);throw f[0]===e?Ot:f}try{a=[qr("FEN",n[0])]}catch(r){if(r!==u)throw r;a=0}var s=Ia[2](kt[6],Nt,a);return[s,[[0,0],i(s,n[1])],n[0],n[2]]}function hi(r){try{return[li(r)]}catch(r){return 0}}function gi(r,n){if("number"==typeof n){if(n){var e;try{e=ei(r)}catch(n){e=r}return[e,Qa]}var t;try{t=ni(r)}catch(n){t=r}return[t,Qa]}return n.tag?[l(si(n[0]),r),Qa]:[ti(n[0],r),Qa]}function mi(r){var n=[r[0][9]-1|0,0],e=[la("moves"),0],t=function(r){return Qu(0,0,[la("comment"),0],[Hu(r),0])};return za(function(r,n){return[(e=r,ia(0,0,[ha([["move",1],[["home",1],[["highlight",+(0===e[1])],0]]]),0],[Qu(0,0,[la("move"),[ya(y(1,[e[1]])),0]],[Hu(""),0]),0])),n];var e},function(r){return aa(0,0,e,r)},function(r){return ia(0,0,[la("variation"),0],[r,0])},function(r){return r?(n=0,e=0,t=[la("variations"),0],u=r,Du("","ol",n?n[0]:"",e?e[0]:"",t,u)):Ca;var n,e,t,u},function(r,n,e){var u=1+(r[0]/2|0)|0,a=+(r[0]%2==0);return ia(0,0,[ha([["move",1],[["white",a],[["black",1-a],[["variations",N(e,Ca)],[["highlight",+(0===r[1])],0]]]]]),0],[Qu(0,0,[la("comments"),0],xr(t,n[2])),[Qu(0,0,[la("number"),0],[Hu(Cr(u)),0]),[Qu(0,0,[la("move"),[ya(y(1,[r[1]])),0]],[Hu(n[1]),0]),[Qu(0,0,[la("comments"),0],xr(t,n[3])),[e,0]]]]])},n,function(r){return[r[0]+1|0,[0,r[1]]]},function(r){return[r[0]-1|0,[1,r[1]]]},function(r){return[r[0],[5,r[1]]]},function(r){return[r[0],[2,r[1]]]},function(r){return[r[0],[3,r[1]]]},function(r){return[r[0],[4,r[1]]]},r[1])}function bi(r){return Yu(0,0,[la("pgn"),0],[(e=r[2],aa(0,0,[la("pgnheader"),0],xr(function(r){return ia(0,0,0,[ua(0,0,0,[Qu(0,0,0,[Hu(r[0]),0]),0]),[Qu(0,0,0,[Hu(r[1]),0]),0]])},Dr(function(r){var n=r[0];return"White"===n?1:+("Black"===n)})(e)))),[mi(r),[(n=r[3],$u(0,0,[la("result"),0],[Hu(vi(n)),0])),0]]]);var n,e}var wi=2147483647,pi=[2147483647,4294967295];function di(r,n,e,t,u,a){var i=((n+r|0)+t|0)+a|0;return(i<<u|i>>>(32-u|0)|0)+e|0}function yi(r,n,e,t,u,a,i){return di(n&e|(-1^n)&t,r,n,u,a,i)}function ki(r,n,e,t,u,a,i){return di(n&t|e&(-1^t),r,n,u,a,i)}function _i(r,n,e,t,u,a,i){return di(n^e^t,r,n,u,a,i)}function Ci(r,n,e,t,u,a,i){return di(e^(n|-1^t),r,n,u,a,i)}function Ni(r,n){var e=r[0],t=r[1],u=r[2],a=r[3];return t=Ci(t=Ci(t=Ci(t=Ci(t=_i(t=_i(t=_i(t=_i(t=ki(t=ki(t=ki(t=ki(t=yi(t=yi(t=yi(t=yi(t,u=yi(u,a=yi(a,e=yi(e,t,u,a,n[0],7,-680876936),t,u,n[1],12,-389564586),e,t,n[2],17,606105819),a,e,n[3],22,-1044525330),u=yi(u,a=yi(a,e=yi(e,t,u,a,n[4],7,-176418897),t,u,n[5],12,1200080426),e,t,n[6],17,-1473231341),a,e,n[7],22,-45705983),u=yi(u,a=yi(a,e=yi(e,t,u,a,n[8],7,1770035416),t,u,n[9],12,-1958414417),e,t,n[10],17,-42063),a,e,n[11],22,-1990404162),u=yi(u,a=yi(a,e=yi(e,t,u,a,n[12],7,1804603682),t,u,n[13],12,-40341101),e,t,n[14],17,-1502002290),a,e,n[15],22,1236535329),u=ki(u,a=ki(a,e=ki(e,t,u,a,n[1],5,-165796510),t,u,n[6],9,-1069501632),e,t,n[11],14,643717713),a,e,n[0],20,-373897302),u=ki(u,a=ki(a,e=ki(e,t,u,a,n[5],5,-701558691),t,u,n[10],9,38016083),e,t,n[15],14,-660478335),a,e,n[4],20,-405537848),u=ki(u,a=ki(a,e=ki(e,t,u,a,n[9],5,568446438),t,u,n[14],9,-1019803690),e,t,n[3],14,-187363961),a,e,n[8],20,1163531501),u=ki(u,a=ki(a,e=ki(e,t,u,a,n[13],5,-1444681467),t,u,n[2],9,-51403784),e,t,n[7],14,1735328473),a,e,n[12],20,-1926607734),u=_i(u,a=_i(a,e=_i(e,t,u,a,n[5],4,-378558),t,u,n[8],11,-2022574463),e,t,n[11],16,1839030562),a,e,n[14],23,-35309556),u=_i(u,a=_i(a,e=_i(e,t,u,a,n[1],4,-1530992060),t,u,n[4],11,1272893353),e,t,n[7],16,-155497632),a,e,n[10],23,-1094730640),u=_i(u,a=_i(a,e=_i(e,t,u,a,n[13],4,681279174),t,u,n[0],11,-358537222),e,t,n[3],16,-722521979),a,e,n[6],23,76029189),u=_i(u,a=_i(a,e=_i(e,t,u,a,n[9],4,-640364487),t,u,n[12],11,-421815835),e,t,n[15],16,530742520),a,e,n[2],23,-995338651),u=Ci(u,a=Ci(a,e=Ci(e,t,u,a,n[0],6,-198630844),t,u,n[7],10,1126891415),e,t,n[14],15,-1416354905),a,e,n[5],21,-57434055),u=Ci(u,a=Ci(a,e=Ci(e,t,u,a,n[12],6,1700485571),t,u,n[3],10,-1894986606),e,t,n[10],15,-1051523),a,e,n[1],21,-2054922799),u=Ci(u,a=Ci(a,e=Ci(e,t,u,a,n[8],6,1873313359),t,u,n[15],10,-30611744),e,t,n[6],15,-1560198380),a,e,n[13],21,1309151649),u=Ci(u,a=Ci(a,e=Ci(e,t,u,a,n[4],6,-145523070),t,u,n[11],10,-1120210379),e,t,n[2],15,718787259),a,e,n[9],21,-343485551),r[0]=e+r[0]|0,r[1]=t+r[1]|0,r[2]=u+r[2]|0,r[3]=a+r[3]|0,0}var Ai=[1732584193,-271733879,-1732584194,271733878],Si=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function Fi(r){return function(r,n,e){var t=r.slice(n,e),u=t.length;Ai[0]=1732584193,Ai[1]=-271733879,Ai[2]=-1732584194,Ai[3]=271733878;for(var a=0;a<=15;++a)Si[a]=0;for(var i=u/64|0,c=1;c<=i;++c){for(var o=0;o<=15;++o){var f=((c<<6)-64|0)+(o<<2)|0;Si[o]=((t.charCodeAt(f)+(t.charCodeAt(f+1|0)<<8)|0)+(t.charCodeAt(f+2|0)<<16)|0)+(t.charCodeAt(f+3|0)<<24)|0}Ni(Ai,Si)}for(var s=t.slice(i<<6),v=0;v<=15;++v)Si[v]=0;for(var l=s.length-1|0,h=0;h<=l;++h)Si[h/4|0]=Si[h/4|0]|s.charCodeAt(h)<<(h%4<<3);var g=l+1|0;if(Si[g/4|0]=Si[g/4|0]|128<<(g%4<<3),g>55){Ni(Ai,Si);for(var m=0;m<=15;++m)Si[m]=0}return Si[14]=u<<3,Ni(Ai,Si),String.fromCharCode(255&Ai[0],Ai[0]>>8&255,Ai[0]>>16&255,Ai[0]>>24&255,255&Ai[1],Ai[1]>>8&255,Ai[1]>>16&255,Ai[1]>>24&255,255&Ai[2],Ai[2]>>8&255,Ai[2]>>16&255,Ai[2]>>24&255,255&Ai[3],Ai[3]>>8&255,Ai[3]>>16&255,Ai[3]>>24&255)}(r,0,r.length)}function xi(r,n){return function(r,n,t,u,a){if(a<0||n<0||n>(r.length-a|0)||u<0||u>(t.length-a|0))throw[e,"Array.blit"];(function(r,n,e,t,u){if(t<=n){for(var a=0,i=u-1|0;a<=i;++a)e[a+t|0]=r[a+n|0];return 0}for(var c=u-1|0;c>=0;--c)e[c+t|0]=r[c+n|0]})(r,n,t,u,a)}(n[0],0,r[0],0,55),r[1]=n[1],0}function Mi(r,n){for(var e=n.length?n:[0],t=e.length,u=0;u<=54;++u)o(r[0],u,u);for(var a,i,c,s="x",v=0,l=54+kr(55,t)|0;v<=l;++v){var h=v%55;i=s,c=f(e,v%t),s=Fi(i+c),o(r[0],h,1073741823&(f(r[0],h)^(((mr(a=s,0)+(mr(a,1)<<8)|0)+(mr(a,2)<<16)|0)+(mr(a,3)<<24)|0)))}return r[1]=0,0}function Oi(r){var n=[s(55,0),0];return Mi(n,r),n}function Ti(r){var n=[s(55,0),0];return xi(n,r),n}function Ii(r){r[1]=(r[1]+1|0)%55;var n=f(r[0],r[1]),e=1073741823&(f(r[0],(r[1]+24|0)%55)+(n^n>>>25&31)|0);return o(r[0],r[1],e),e}function qi(r,n){if(n<=0)throw[e,"Random.int32"];for(var t=r,u=n;;){var a=Ii(t)|(1&Ii(t))<<30,i=a%u;if(!((a-i|0)>(1+(wi-u|0)|0)))return i}}function Di(r,n){if(1-j(n,[0,0]))throw[e,"Random.int64"];for(var t=r,u=n;;){var a=$(Ii(t)),i=U($(Ii(t)),30),c=U($(7&Ii(t)),60),o=(l=a,h=[i[0]|c[0],(i[1]|c[1])>>>0],[l[0]|h[0],(l[1]|h[1])>>>0]),f=E(s=o,P(V(Y(s,v=u),v)));if(!j(R(o,f),E(R(pi,u),[0,1])))return f}var s,v,l,h}var Ei=[[987910699,495797812,364182224,414272206,318284740,990407751,383018966,270373319,840823159,24560019,536292337,512266505,189156120,730249596,143776328,51606627,140166561,366354223,1003410265,700563762,981890670,913149062,526082594,1021425055,784300257,667753350,630144451,949649812,48546892,415514493,258888527,511570777,89983870,283659902,308386020,242688715,482270760,865188196,1027664170,207196989,193777847,619708188,671350186,149669678,257044018,87658204,558145612,183450813,28133145,901332182,710253903,510646120,652377910,409934019,801085050],0];var Li=[Oi,function(){return Oi(S())},Ti,Ii,function(r,n){if(n>1073741823||n<=0)throw[e,"Random.int"];for(var t=r,u=n;;){var a=Ii(t),i=a%u;if(!((a-i|0)>(1+(1073741823-u|0)|0)))return i}},qi,function(r,n){return 0|Di(r,$(n))[1]},Di,function(r,n){return(Ii(e=r)/1073741824+Ii(e))/1073741824*n;var e},function(r){return+(0==(1&Ii(r)))}];y(246,[function(){return Li[1](0)}]);function Pi(r,n,e){var t=l(n,l(r[0],e));return h(r[1],t,e)}function Ri(r,n){var e=r[0],t=n[0],u=r[1];return[function(r){return l(e,l(t,r))},function(r){var e=l(u,r);return function(r){return Pi(n,e,r)}}]}var Ui=[function(r,n){return l(n[0],r)},function(r,n,e){return h(r[1],n,e)},Pi,function(r,n){return Ri(n,r)},Ri,function(r,n){return[function(e){return[l(r[0],e[0]),l(n[0],e[1])]},function(e,t){return[h(r[1],e[0],t[0]),h(n[1],e[1],t[1])]}]},function(r,n){return function(e){return Pi(r,function(r){return n+r|0},e)}},function(r,n){return function(e){return Pi(r,function(r){return n-r|0},e)}}];function Bi(r){return y(0,[r])}function Vi(r,n){return y(1,[r,function(r){return l(n,r[0])},[0]])}function Xi(r,n,e,t){var u=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return 0;switch(0|e.tag){case 0:var a=e[0];return a?Or(function(r){return function(n){return u(r,n)}}(t),a):0;case 1:return e[2][0]=[l(e[1],t)],0;case 2:var i=l(e[0],t);n=e[1],r=i;continue}}},a=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return 0;switch(0|e.tag){case 0:var u=e[0];return u?Or(function(r){return function(n){return a(r,n)}}(t),u):0;case 1:var i=e[2],c=i[0];return c?(i[0]=0,l(c[0],0)):0;case 2:var o=l(e[0],t);n=e[1],r=o;continue}}},i=0;if("number"==typeof e){if("number"==typeof t)return t;i=1}else switch(0|e.tag){case 0:if("number"==typeof t)i=1;else{if(!t.tag){return function(e,t){for(;;){var i=t,c=e;if(c){var o=c[1],f=c[0];if(i){Xi(r,n,f,i[0]),t=i[1],e=o;continue}a(r,f),t=0,e=o}else{if(!i)return 0;u(n,i[0]),t=i[1],e=0}}}(e[0],t[0]),t}i=1}break;case 1:if("number"==typeof t)i=1;else if(1===t.tag){if(e[0]===t[0])return t[2][0]=e[2][0],t;i=1}else i=1;break;case 2:if("number"==typeof t)i=1;else{if(2===t.tag)return Xi(l(e[0],r),l(t[0],n),e[1],t[1]),t;i=1}}if(1===i)return a(r,e),u(n,t),t}var Gi=0;var Ki=function(r){var n=typeof r;return"string"===n?y(0,[r]):"number"===n?y(1,[r]):"boolean"===n?!0===r?1:0:null===r?2:Array.isArray(r)?y(3,[r]):y(2,[r])};function ji(r,n){return n.tag?n:r}function Ji(r){return r?r[4]:0}function Zi(r,n,e,t){var u=Ji(r),a=Ji(t);return[r,n,e,t,u>=a?u+1|0:a+1|0]}function zi(r,n){return[0,r,n,0,1]}function Hi(r,n,t,u){var a=r?r[4]:0,i=u?u[4]:0;if(a>(i+2|0)){if(r){var c=r[3],o=r[2],f=r[1],s=r[0];if(Ji(s)>=Ji(c))return Zi(s,f,o,Zi(c,n,t,u));if(c)return Zi(Zi(s,f,o,c[0]),c[1],c[2],Zi(c[3],n,t,u));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(i>(a+2|0)){if(u){var v=u[3],l=u[2],h=u[1],g=u[0];if(Ji(v)>=Ji(g))return Zi(Zi(r,n,t,g),h,l,v);if(g)return Zi(Zi(r,n,t,g[0]),g[1],g[2],Zi(g[3],h,l,v));throw[e,"Map.bal"]}throw[e,"Map.bal"]}return[r,n,t,u,a>=i?a+1|0:i+1|0]}function Wi(r,n,e){if(e){var t=e[3],u=e[2],a=e[1],i=e[0],c=sr(r,a);return c?c<0?Hi(Wi(r,n,i),a,u,t):Hi(i,a,u,Wi(r,n,t)):[i,r,n,t,e[4]]}return[0,r,n,0,1]}function Yi(r){for(;;){var n=r;if(n){var e=n[0];if(e){r=e;continue}return[n[1],n[2]]}throw u}}function Qi(r){if(r){var n=r[0];return n?Hi(Qi(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]}function $i(r,n,e,t){if(r){if(t){var u=t[4],a=r[4];return a>(u+2|0)?Hi(r[0],r[1],r[2],$i(r[3],n,e,t)):u>(a+2|0)?Hi($i(r,n,e,t[0]),t[1],t[2],t[3]):Zi(r,n,e,t)}return function r(n,e,t){return t?Hi(t[0],t[1],t[2],r(n,e,t[3])):zi(n,e)}(n,e,r)}return function r(n,e,t){return t?Hi(r(n,e,t[0]),t[1],t[2],t[3]):zi(n,e)}(n,e,t)}function rc(r,n){if(r){if(n){var e=Yi(n);return $i(r,e[0],e[1],Qi(n))}return r}return n}function nc(r,n,e,t){return e?$i(r,n,e[0],t):rc(r,t)}function ec(r,n){if(n){var e=n[3],t=n[2],u=n[1],a=n[0],i=sr(r,u);if(i){if(i<0){var c=ec(r,a);return[c[0],c[1],$i(c[2],u,t,e)]}var o=ec(r,e);return[$i(a,u,t,o[0]),o[1],o[2]]}return[a,[t],e]}return[0,0,0]}function tc(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}}var uc=[0,function(r){return r?0:1},function(r,n){for(;;){var e=n;if(e){var t=sr(r,e[1]);if(t){n=t<0?e[0]:e[3];continue}return 1}return 0}},Wi,zi,function r(n,e){if(e){var t=e[3],u=e[2],a=e[1],i=e[0],c=sr(n,a);if(c)return c<0?Hi(r(n,i),a,u,t):Hi(i,a,u,r(n,t));var o=i,f=t;if(o){if(f){var s=Yi(f);return Hi(o,s[0],s[1],Qi(f))}return o}return f}return 0},function r(n,e,t){var u=0;if(e){var a=e[1];if(e[4]>=Ji(t)){var c=ec(a,t);return nc(r(n,e[0],c[0]),a,g(n,a,[e[2]],c[1]),r(n,e[3],c[2]))}u=1}else{if(!t)return 0;u=1}if(1===u){if(t){var o=t[1],f=ec(o,e);return nc(r(n,f[0],t[0]),o,g(n,o,f[1],[t[2]]),r(n,f[2],t[3]))}throw[i,["map.ml",270,10]]}},function(r,n,e){for(var t=tc(n,0),u=tc(e,0);;){var a=u,i=t;if(i){if(a){var c=sr(i[0],a[0]);if(0!==c)return c;var o=h(r,i[1],a[1]);if(0!==o)return o;u=tc(a[2],a[3]),t=tc(i[2],i[3]);continue}return 1}return a?-1:0}},function(r,n,e){for(var t=tc(n,0),u=tc(e,0);;){var a=u,i=t;if(i){if(a){if(sr(i[0],a[0]))return 0;if(h(r,i[1],a[1])){u=tc(a[2],a[3]),t=tc(i[2],i[3]);continue}return 0}return 0}return a?0:1}},function r(n,e){for(;;){var t=e;if(!t)return 0;r(n,t[0]),h(n,t[1],t[2]),e=t[3]}},function r(n,e,t){for(;;){var u=t,a=e;if(!a)return u;t=g(n,a[1],a[2],r(n,a[0],u)),e=a[3]}},function r(n,e){for(;;){var t=e;if(t){if(h(n,t[1],t[2])){if(r(n,t[0])){e=t[3];continue}return 0}return 0}return 1}},function r(n,e){for(;;){var t=e;if(!t)return 0;if(h(n,t[1],t[2]))return 1;if(r(n,t[0]))return 1;e=t[3]}},function r(n,e){if(e){var t=e[2],u=e[1],a=r(n,e[0]),i=h(n,u,t),c=r(n,e[3]);return i?$i(a,u,t,c):rc(a,c)}return 0},function r(n,e){if(e){var t=e[2],u=e[1],a=r(n,e[0]),i=a[1],c=a[0],o=h(n,u,t),f=r(n,e[3]),s=f[1],v=f[0];return o?[$i(c,u,t,v),rc(i,s)]:[rc(c,v),$i(i,u,t,s)]}return[0,0]},function r(n){return n?(r(n[0])+1|0)+r(n[3])|0:0},function(r){return function r(n,e){for(;;){var t=e,u=n;if(!t)return u;e=t[0],n=[[t[1],t[2]],r(u,t[3])]}}(0,r)},Yi,function(r){for(;;){var n=r;if(n){var e=n[3];if(e){r=e;continue}return[n[1],n[2]]}throw u}},Yi,ec,function(r,n){for(;;){var e=n;if(e){var t=sr(r,e[1]);if(t){n=t<0?e[0]:e[3];continue}return e[2]}throw u}},function r(n,e){if(e){var t=r(n,e[0]),u=l(n,e[2]),a=r(n,e[3]);return[t,e[1],u,a,e[4]]}return 0},function r(n,e){if(e){var t=e[1];return[r(n,e[0]),t,h(n,t,e[2]),r(n,e[3]),e[4]]}return 0}],ac=wr("Tea_json.Decoder.ParseFail");function ic(r){return[function(n){var e=Ki(n);return"number"==typeof e&&e>=2?y(0,[r]):y(1,["Non-null value"])}]}function cc(r,n){var e=n[0];return[function(n){var t=Ki(n);if("number"==typeof t)return y(1,["Non-fieldable value"]);if(2===t.tag){var u=t[0][r];if(void 0!==u){var a=l(e,u);return a.tag?y(1,["field `"+r+"` -> "+a[0]]):a}return y(1,["Field Value is undefined: "+r])}return y(1,["Non-fieldable value"])}]}function oc(r){return[function(n){var e=function(r,n){for(;;){var t=n;if(!t)return y(1,["No one-of's matched"]);var u=t[1];try{var a=l(t[0][0],r);return a.tag?e(r,u):a}catch(r){n=u;continue}}};return e(n,r)}]}function fc(r,n){var e=n[0];return[function(n){var t=l(e,n);return t.tag?y(1,["map "+t[0]]):y(0,[l(r,t[0])])}]}function sc(r,n){var e=n[0];return[function(n){var t=l(e,n);return t.tag?t:l(l(r,t[0])[0],n)}]}function vc(r,n){try{return l(r[0],n)}catch(r){var e=Vn(r);return e[0]===ac?y(1,[e[1]]):y(1,["Unknown JSON parsing error"])}}var lc=[uc,ac,[function(r){var n=Ki(r);return"number"==typeof n?y(1,["Non-string value"]):n.tag?y(1,["Non-string value"]):y(0,[n[0]])}],[function(r){var n=Ki(r);if("number"==typeof n)return y(1,["Non-int value"]);if(1===n.tag){var e=n[0];return e>-2147483648&&e<2147483647?y(0,[0|e]):y(1,["number out of int range"])}return y(1,["Non-int value"])}],[function(r){var n=Ki(r);return"number"==typeof n?y(1,["Non-float-value"]):1===n.tag?y(0,[n[0]]):y(1,["Non-float-value"])}],[function(r){var n=Ki(r);if("number"!=typeof n)return y(1,["Non-boolean value"]);switch(n){case 0:return y(0,[0]);case 1:return y(0,[1]);case 2:return y(1,["Non-boolean value"])}}],ic,function(r){var n=r[0];return[function(r){var e=Ki(r);if("number"==typeof e)return y(1,["Non-list value"]);if(3!==e.tag)return y(1,["Non-list value"]);try{return y(0,[xr(function(r){var e=l(n,r);if(e.tag)throw[ac,e[0]];return e[0]},Jn(e[0]))])}catch(r){var t=Vn(r);if(t[0]===ac)return y(1,["list -> "+t[1]]);throw t}}]},function(r){var n=r[0];return[function(r){var e=Ki(r);if("number"==typeof e)return y(1,["Non-array value"]);if(3!==e.tag)return y(1,["Non-array value"]);try{return y(0,[Kn(function(r){var e=l(n,r);if(e.tag)throw[ac,e[0]];return e[0]},e[0])])}catch(r){var t=Vn(r);if(t[0]===ac)return y(1,["array -> "+t[1]]);throw t}}]},function(r){var n=r[0];return[function(r){var e=Ki(r);if("number"==typeof e)return y(1,["Non-keyValuePair value"]);if(2!==e.tag)return y(1,["Non-keyValuePair value"]);var t=e[0],u=Object.keys(t);try{return y(0,[Zn(function(r,e){var u=t[r];if(void 0!==u){var a=l(n,u);if(a.tag)throw[ac,a[0]];return[[r,a[0]],e]}throw[ac,"Key is undefined: "+r]},u,0)])}catch(r){var a=Vn(r);if(a[0]===ac)return y(1,["Invalid keyValuePair parsing: "+a[1]]);throw a}}]},function(r){var n=r[0];return[function(r){var e=Ki(r);if("number"==typeof e)return y(1,["Non-dict value"]);if(2!==e.tag)return y(1,["Non-dict value"]);var t=e[0],u=Object.keys(t);try{return y(0,[Zn(function(r,e){var u=t[r];if(void 0!==u){var a=l(n,u);if(a.tag)throw[ac,a[0]];return Wi(r,a[0],e)}throw[ac,"Key is undefined: "+r]},u,0)])}catch(r){var a=Vn(r);if(a[0]===ac)return y(1,["Invalid dict parsing: "+a[1]]);throw a}}]},cc,function(r,n){return function r(n,e,t){return e?h(n,e[0],r(n,e[1],t)):t}(cc,r,n)},function(r,n){var e=n[0];return[function(n){var t=Ki(n);if("number"==typeof t)return y(1,["Non-array value"]);if(3===t.tag){var u=t[0];return r<0||r>u.length?y(1,["Array index out of range: "+r]):l(e,f(u,r))}return y(1,["Non-array value"])}]},function(r){var n=r[0];return[function(r){var e=l(n,r);return e.tag?y(0,[0]):y(0,[[e[0]]])}]},oc,fc,function(r,e,t){var u=t[0],a=e[0];return[function(e){var t,i,c,o=l(a,e),f=l(u,e),s=0;if(o.tag)s=1;else{if(!f.tag)return y(0,[h(r,o[0],f[0])]);s=1}if(1===s){var v=(t=o,(i=f).tag?[i[0]]:(c=t).tag?[c[0]]:0);if(v)return y(1,["map2 -> "+v[0]]);throw[n,"Impossible case"]}}]},function(r,e,t,u){var a=u[0],i=t[0],c=e[0];return[function(e){var t=l(c,e),u=l(i,e),o=l(a,e),f=0;if(t.tag)f=1;else if(u.tag)f=1;else{if(!o.tag)return y(0,[g(r,t[0],u[0],o[0])]);f=1}if(1===f){var s=ji(o,ji(u,t));if(s.tag)return y(1,["map3 -> "+s[0]]);throw[n,"Impossible case"]}}]},function(r,e,t,u,a){var i=a[0],c=u[0],o=t[0],f=e[0];return[function(e){var t=l(f,e),u=l(o,e),a=l(c,e),s=l(i,e),v=0;if(t.tag)v=1;else if(u.tag)v=1;else if(a.tag)v=1;else{if(!s.tag)return y(0,[m(r,t[0],u[0],a[0],s[0])]);v=1}if(1===v){var h=ji(s,ji(a,ji(u,t)));if(h.tag)return y(1,["map4 -> "+h[0]]);throw[n,"Impossible case"]}}]},function(r,e,t,u,a,i){var c=i[0],o=a[0],f=u[0],s=t[0],v=e[0];return[function(e){var t=l(v,e),u=l(s,e),a=l(f,e),i=l(o,e),h=l(c,e),g=0;if(t.tag)g=1;else if(u.tag)g=1;else if(a.tag)g=1;else if(i.tag)g=1;else{if(!h.tag)return y(0,[b(r,t[0],u[0],a[0],i[0],h[0])]);g=1}if(1===g){var m=ji(h,ji(i,ji(a,ji(u,t))));if(m.tag)return y(1,["map5 -> "+m[0]]);throw[n,"Impossible case"]}}]},function(r,e,t,u,a,i,c){var o=c[0],f=i[0],s=a[0],v=u[0],h=t[0],g=e[0];return[function(e){var t=l(g,e),u=l(h,e),a=l(v,e),i=l(s,e),c=l(f,e),m=l(o,e),b=0;if(t.tag)b=1;else if(u.tag)b=1;else if(a.tag)b=1;else if(i.tag)b=1;else if(c.tag)b=1;else{if(!m.tag)return y(0,[w(r,t[0],u[0],a[0],i[0],c[0],m[0])]);b=1}if(1===b){var p=ji(m,ji(c,ji(i,ji(a,ji(u,t)))));if(p.tag)return y(1,["map6 -> "+p[0]]);throw[n,"Impossible case"]}}]},function(r,e,t,u,a,i,c,o){var f=o[0],s=c[0],v=i[0],h=a[0],g=u[0],m=t[0],b=e[0];return[function(e){var t=l(b,e),u=l(m,e),a=l(g,e),i=l(h,e),c=l(v,e),o=l(s,e),w=l(f,e),d=0;if(t.tag)d=1;else if(u.tag)d=1;else if(a.tag)d=1;else if(i.tag)d=1;else if(c.tag)d=1;else if(o.tag)d=1;else{if(!w.tag)return y(0,[p(r,t[0],u[0],a[0],i[0],c[0],o[0],w[0])]);d=1}if(1===d){var k=ji(w,ji(o,ji(c,ji(i,ji(a,ji(u,t))))));if(k.tag)return y(1,["map7 -> "+k[0]]);throw[n,"Impossible case"]}}]},function(r,e,t,u,a,i,c,o,f){var s=f[0],v=o[0],h=c[0],g=i[0],m=a[0],b=u[0],w=t[0],p=e[0];return[function(e){var t=l(p,e),u=l(w,e),a=l(b,e),i=l(m,e),c=l(g,e),o=l(h,e),f=l(v,e),k=l(s,e),_=0;if(t.tag)_=1;else if(u.tag)_=1;else if(a.tag)_=1;else if(i.tag)_=1;else if(c.tag)_=1;else if(o.tag)_=1;else if(f.tag)_=1;else{if(!k.tag)return y(0,[d(r,t[0],u[0],a[0],i[0],c[0],o[0],f[0],k[0])]);_=1}if(1===_){var C=ji(k,ji(f,ji(o,ji(c,ji(i,ji(a,ji(u,t)))))));if(C.tag)return y(1,["map8 -> "+C[0]]);throw[n,"Impossible case"]}}]},function(r){return[function(){return y(0,[r])}]},function(r){return[function(){return y(1,[r])}]},[function(r){return y(0,[r])}],sc,function(r){return sc(r,[function(){return y(0,[0])}])},function(r){return oc([ic(0),[fc(function(r){return[r]},r),0]])},vc,function(r,n){try{return l(r[0],n)}catch(r){var e=Vn(r);return e[0]===ac?y(1,[e[1]]):y(1,["Unknown JSON parsing error"])}},function(r,n){try{return vc(r,JSON.parse(n))}catch(r){return y(1,["Invalid JSON string"])}}],hc=lc[17](function(r,n){return[r,n]},lc[11]("pageX",lc[3]),lc[11]("pageY",lc[3]));function gc(r,n,e){return Vi(n,function(t){var u=[t],a=y(0,[n,function(r){var n=lc[31](hc,r);return n.tag?0:[l(e,n[0])]}]),i=document,c=Uu(u,i,r,a);return function(){return Bu(i,r,c),0}})}function mc(r,n){return lc[17](function(r,n){return[r,n]},lc[11](r,lc[3]),lc[11](n,lc[3]))}mc("pageX","pageY");var bc=lc[11]("clientWidth",lc[3]),wc=lc[18](function(r,n,e){return[r,n,e]},mc("offsetX","offsetY"),mc("pageX","pageY"),lc[11]("target",bc)),pc=lc[31];function dc(r){return pc(wc,r)}var yc=ea(0,0,[ya(y(0,[0])),0],[Hu("Flip board"),0]);function kc(r,n){return[(t=r,u=n,"number"==typeof u?u?[[4,ot(t)],[2,ot(t)]]:[[4,ot(t)],[6,ot(t)]]:u.tag?[[u[1],(i=t,0!==i?6:1)],[u[2],(a=t,0!==a?7:0)]]:[[u[0],u[1]],[u[2],u[3]]]),(e=n,"number"==typeof e?[e]:1===e.tag?0:[e])];var e,t,u,a,i}function _c(r){if(r){var n=r[1],e=r[0];return[[e,function(r,t,u){var a,i,c=u[1];return y(0,[y(0,[[e,[r,t],0,(a=[r,t],i=xr(function(r){return kc(e,r)},n),xr(function(r){return[r[0][1],r[1]]},Dr(function(r){return C(r[0][0],a)})(i))),c,u[0],c,u[2]]])])}]]}return 0}function Cc(r,n,e){var t=0!==e[0]?[[0,[1,[2,[3,[4,[5,[6,[7,0]]]]]]]],[7,[6,[5,[4,[3,[2,[1,[0,0]]]]]]]]]:[[7,[6,[5,[4,[3,[2,[1,[0,0]]]]]]]],[0,[1,[2,[3,[4,[5,[6,[7,0]]]]]]]]],u=t[0],a=function(r,n){return function(r,n){for(;;){var e=n;if(!e)return 0;if(l(r,e[0]))return 1;n=e[1]}}(function(r){return C(r[0],n)},r[3])},i=e[1];return Wu(0,"cb-board",0,0,["number"==typeof i||i.tag?Na:la("dragging"),0],xr(function(t){return Wu(0,"cb-row",0,0,0,xr(function(u){var i,c,o=t,s=u,v=f(f(n,s),o);if(v){var g,m=v[0],b=m[1],w=e[1];if("number"==typeof w)g=[0,Na];else if(w.tag)g=[0,Na];else{var p=w[0];g=C([s,o],p[1])?[1,(c=p,ma("transform",h(xe([y(11,["translate(",y(4,[0,0,0,y(11,["px,",y(4,[0,0,0,y(11,["px)",0])])])])]),"translate(%dpx,%dpx)"]),((c[5][0]-(c[7]/2|0)|0)+c[6][0]|0)-c[4][0]|0,((c[5][1]-(c[7]/2|0)|0)+c[6][1]|0)-c[4][1]|0)))]:[0,Na]}var d,k=_c(r);if(k){var _=k[0];if(b===_[0]){var N=h(_[1],s,o);d=pa("mousedown","",function(r){return n=N,(e=l(dc,r)).tag?0:[l(n,e[0])];var n,e})}else d=Na}else d=Na;i=[Wu(0,"cb-piece",0,0,[g[1],[ha([[ct(b),1],[[it(m[0]),1],[["dragged",g[0]],0]]]),0]],0),d]}else i=[Ca,Na];var A,S,F,x,M,O,T=e[1],I=0;if("number"==typeof T)I=1;else if(T.tag)I=1;else{var q=T[0];A=[ha([["destination",a(q,[s,o])],[["hovering",(x=q,M=[s,o],O=x[2],O&&C(O[0],M)?1:0)],0]]),[(F=y(0,[y(3,[[s,o]])]),Lu("mouseenter",F)),[(S=y(0,[y(4,[[s,o]])]),Lu("mouseleave",S)),0]]]}return 1===I&&(A=[Na,[Na,[Na,0]]]),Wu(0,"cb-square",0,0,[i[1],A],[i[0],0])},u))},t[1]))}function Nc(r,n,t){var u,a,i,c,o,f,s=t[1];return Wu(0,"cb-wrap",0,0,0,["number"!=typeof s&&s.tag?(u=s[0],a=u[2],i=t[0],c=u[0],f=(o=0!==i?0!==c?[a,[0,[1,[2,[3,0]]]]]:[a,[7,[6,[5,[4,0]]]]]:0!==c?[7-a|0,[7,[6,[5,[4,0]]]]]:[7-a|0,[0,[1,[2,[3,0]]]]])[0],Wu(0,"cb-promo",0,0,[ya(y(0,[1])),0],xr(function(r){var n,e=r[1];return Wu(0,"cb-square",0,0,[ya(y(0,[y(5,[e])])),[(n=[["left",l(xe([y(4,[0,0,0,y(11,["px",0])]),"%dpx"]),F(f,u[3]))],[["top",l(xe([y(4,[0,0,0,y(11,["px",0])]),"%dpx"]),F(r[0],u[3]))],0]],y(4,[n])),0]],[Wu(0,"cb-piece",0,0,[ha([[ct(u[0]),1],[[it(e),1],0]]),0],0),0])},function r(n,t){if(n){if(t)return[[n[0],t[0]],r(n[1],t[1])];throw[e,"List.combine"]}if(t)throw[e,"List.combine"];return 0}(o[1],[1,[4,[2,[3,0]]]])))):Ca,[Cc(r,n,t),0]])}function Ac(r){var n,e,t,u,a=r[1];return"number"==typeof a||a.tag?Gi:Bi([(t=0,u=function(r){return y(0,[y(1,[r])])},gc("mousemove",t?t[0]:"",u)),[(n=0,e=function(r){return y(0,[y(2,[r])])},gc("mouseup",n?n[0]:"",e)),0]])}function Sc(r,n){var e=n[0];return y(2,[function(n){return l(e,function(e){var t=l(r,e);return t?l(n[0][0],t[0]):0})}])}function Fc(r,n){return Sc(function(n){return[l(r,n)]},n)}function xc(r,n){var e=n[0];return[function(n){return l(e,function(e){return e.tag?l(n,e):l(l(r,e[0])[0],n)})}]}function Mc(r,n){return xc(function(n){var e=l(r,n);return[function(r){return l(r,y(0,[e]))}]},n)}function Oc(r){return r?(n=function(r,n){return[r,n]},e=r[0],t=Oc(r[1]),xc(function(r){return xc(function(e){var t=h(n,r,e);return[function(r){return l(r,y(0,[t]))}]},t)},e)):[function(r){return l(r,y(0,[0]))}];var n,e,t}var Tc=[function(r){var n,e,t=(n=window,void 0!==(e=n.localStorage)?[e.clear()]:0);return l(r,t?y(0,[t[0]]):y(1,["localStorage is not available"]))}];function Ic(r){return[function(n){var e,t,u,a=(e=window,t=r,void 0!==(u=e.localStorage)?[u.removeItem(t)]:0);return l(n,a?y(0,[a[0]]):y(1,["localStorage is not available"]))}]}function qc(r,n){return[function(e){var t,u,a,i;return l(e,(t=window,u=r,a=n,void 0!==(i=t.localStorage)?[i.setItem(u,a)]:0)?y(0,[0]):y(1,["localStorage is not available"]))}]}var Dc=[[function(r){var n,e,t=(n=window,void 0!==(e=n.localStorage)?[e.length]:0);return l(r,t?y(0,[t[0]]):y(1,["localStorage is not available"]))}],Tc,function(){return Sc(function(){return 0},Tc)},function(r){return[function(n){var e,t,u,a=(e=window,t=r,void 0!==(u=e.localStorage)?[u.key(t)]:0);return l(n,a?y(0,[a[0]]):y(1,["localStorage is not available"]))}]},function(r){return[function(n){var e=function(r,n){var e=r.localStorage;if(void 0===e)return 0;try{return[e.getItem(n)]}catch(r){return 0}}(window,r);return l(n,e?y(0,[e[0]]):y(1,["localStorage is not available"]))}]},Ic,function(r){return Sc(function(){return 0},Ic(r))},qc,function(r,n){return Sc(function(){return 0},qc(r,n))}];function Ec(r){var e,t=null!==(e=r.getAllResponseHeaders())?""===e?y(1,[1]):y(0,[e]):y(1,[0]);return t.tag?t:y(0,[xr(function(r){if(2!==r.length)throw[n,"Cannot happen, already checked length"];return[r[0],r[1]]},Dr(function(r){return+(2===r.length)})(Jn(Kn(function(r){return r.split(": ",2)},t[0].split("\r\n")))))])}var Lc,Pc=(Lc=function(r){return y(0,[r])},[5,function(r){var n=r[3];return"number"==typeof n?y(1,["Non-text response returned"]):5===n.tag?l(Lc,n[0]):y(1,["Non-text response returned"])}]);function Rc(r){return[["GET",0,r,0,Pc,0,0],0]}function Uc(r,n){var t=n[1],u=n[0],a=u[4],i=a[1],c=a[0],o=u[6],f=u[5],s=u[3],v=u[2],h=u[1],g=u[0];return y(2,[function(n){var u=function(e,t){return l(n[0][0],l(r,e))},a=new XMLHttpRequest;if(t){var m=t[0],b=function(r,e){return e?l(r,l(e[0],n)):0};b(function(r){return a.onreadystatechange=r},m[0]),b(function(r){return a.onprogress=r},m[1])}var w=y(1,[1]);a.onerror=function(r){return u(w)};var p=y(1,[0]);a.ontimeout=function(r){return u(p)};var d=y(1,[2]);a.onabort=function(r){return u(d)};var k,_,C,N,A,S,F,x,M;a.onload=function(){var r,n,t,c,o,f,s=(r=function(r){return r?r[4]:0},n=function(n,e,t,u){var a=r(n),i=r(u);return[n,e,t,u,a>=i?a+1|0:i+1|0]},t=function(t,u,a,i){var c=t?t[4]:0,o=i?i[4]:0;if(c>(o+2|0)){if(t){var f=t[3],s=t[2],v=t[1],l=t[0];if(r(l)>=r(f))return n(l,v,s,n(f,u,a,i));if(f)return n(n(l,v,s,f[0]),f[1],f[2],n(f[3],u,a,i));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(o>(c+2|0)){if(i){var h=i[3],g=i[2],m=i[1],b=i[0];if(r(h)>=r(b))return n(n(t,u,a,b),m,g,h);if(b)return n(n(t,u,a,b[0]),b[1],b[2],n(b[3],m,g,h));throw[e,"Map.bal"]}throw[e,"Map.bal"]}return[t,u,a,i,c>=o?c+1|0:o+1|0]},c=function(r,n,e){if(e){var u=e[3],a=e[2],i=e[1],o=e[0],f=sr(r,i);return f?f<0?t(c(r,n,o),i,a,u):t(o,i,a,c(r,n,u)):[o,r,n,u,e[4]]}return[0,r,n,0,1]},(o=Ec(a)).tag?o:y(0,[Tr(function(r,n){return c(n[0],n[1],r)},0,o[0])]));f=s.tag?0:s[0];var v=a.responseURL,h=[a.status,a.statusText],g=[v,h,f,function(r){var n=r.response;if(null===n)return 0;var e=function(r){var n=r.responseType;switch(n){case"":return 0;case"arraybuffer":return 1;case"blob":return 2;case"document":return 3;case"json":return 4;case"text":return 5;default:return[n]}}(r);if("number"!=typeof e)return y(6,[e[0],n]);switch(e){case 0:return y(0,[n]);case 1:return y(1,[n]);case 2:return y(2,[n]);case 3:return y(3,[n]);case 4:return y(4,[n]);case 5:return y(5,[n])}}(a)];if(h[0]<200||300<=h[0]){var m=y(1,[y(1,[g])]);return u(m)}var b=l(i,g);if(b.tag){var w=y(1,[y(2,[b[0],g])]);return u(w)}var p=y(0,[b[0]]);return u(p)};try{k=g,_=v,N=0,A=0,S=a,F=(C=0)?C[0]:1,x=N?N[0]:"",M=A?A[0]:"",S.open(k,_,F,x,M)}catch(r){var O=y(1,[y(0,[v])]);u(O)}return Or(function(r){return n=r[0],e=r[1],a.setRequestHeader(n,e);var n,e},h),function(r,n){if("number"!=typeof r)return n.responseType=r[0];switch(r){case 0:return n.responseType="";case 1:return n.responseType="arraybuffer";case 2:return n.responseType="blob";case 3:return n.responseType="document";case 4:return n.responseType="json";case 5:n.responseType="text"}}(c,a),f&&(a.timeout=f[0]),a.withCredentials=o,function(r,n){if("number"==typeof r)return r?n.send(null):n.send();switch(0|r.tag){case 0:case 1:return n.send(r[0]);case 2:var e=Tr(function(r,n){var e,t;return e=n[0],t=n[1],r.append(e,t),r},new FormData,r[0]);return n.send(e);case 3:n.send(r[0])}}(s,a),0}])}function Bc(r){return y(0,[r])}var Vc="https://thingproxy.freeboard.io/fetch/";function Xc(r,n){if("number"==typeof n)return"number"==typeof r&&1!==r?[r,Uc(Bc,Rc("https://lichess.org/api/tournament/GToVqkC9"))]:[r,Qa];switch(0|n.tag){case 0:var e=n[0];if(e.tag)return[2,Qa];var t=lc[7](lc[2]),u=lc[17](function(r,n){return[r,n]},lc[11]("id",lc[2]),lc[11]("u",t)),a=lc[7](u),i=lc[11]("pairings",a),c=lc[32](i,e[0]);return[c.tag?2:[c[0]],Qa];case 1:var o=n[0];return[r,(f=function(r){return y(2,[o,r])},s=o,Uc(f,Rc(h(xe([y(2,[0,y(11,["https://lichess.org/game/export/",y(2,[0,y(11,[".pgn",0])])])]),"%shttps://lichess.org/game/export/%s.pgn"]),Vc,s))))];case 2:return[r,Qa]}var f,s}function Gc(r){var n,e,t,u;if("number"!=typeof r)return n=0,e=0,t=0,u=xr(function(r){var n,e,t,u,a=r[0];return n=0,e=0,t=0,u=[ca(0,0,0,[ra(0,0,[va(l(xe([y(11,["#/lichess/",y(2,[0,0])]),"#/lichess/%s"]),a)),0],[Hu(a),0]),0]),xr(function(r){return ca(0,0,0,[Hu(r),0])},r[1])],Du("","tr",n?n[0]:"",e?e[0]:"",t,u)},r[0]),Du("","table",n?n[0]:"",e?e[0]:"",t,u);switch(r){case 0:return $u(0,0,0,[ea(0,0,[ya(0),0],[Hu("load Lichess tournament"),0]),0]);case 1:return $u(0,0,0,[Hu("Loading tournament..."),0]);case 2:return $u(0,0,0,[Hu("Tournament could not be loaded."),[ea(0,0,[ya(0),0],[Hu("retry"),0]),0]])}}function Kc(r){return Mc(function(n){return[r,n]},Dc[4](r))}var jc=Mc(function(r){return Tr(function(r,n){try{var e=hi(n[1]);return e?g(xa[3],er(n[0]),e[0],r):r}catch(n){return r}},xa[0],r)},xc(function(r){return Oc(xr(Kc,r))},xc(function(r){return Oc(function(r,n){for(;;){var e=n,t=r;if(!(t>=0))return e;n=[Dc[3](t),e],r=t-1|0}}(r,0))},Dc[0])));function Jc(r,n){return Dc[7](r,(t=function(r){return l(xe([y(12,[123,y(2,[0,y(12,[125,0])])]),"{%s}"]),r)},u=za(function(r,n){return n},function(r){return Vr(" ",r)},function(r){return l(xe([y(12,[40,y(2,[0,y(12,[41,0])])]),"(%s)"]),r)},function(r){return r},function(r,n,e){var u=1+(r/2|0)|0,a=+(r%2==0),i=xr(t,n[2]),c=xr(t,n[3]);return Vr(" ",Nr(i,Nr(a?[l(xe([y(4,[0,0,0,y(12,[46,0])]),"%d."]),u),[n[1],c]]:[n[1],c],e)))},(e=n)[0][9]-1|0,function(r){return r+1|0},function(r){return r-1|0},fi,fi,fi,fi,e[1]),a=Vr("\n",xr(function(r){return h(xe([y(12,[91,y(2,[0,y(11,[' "',y(2,[0,y(11,['"]',0])])])])]),'[%s "%s"]']),r[0],r[1])},e[2])),g(xe([y(2,[0,y(11,["\n\n",y(2,[0,y(12,[32,y(2,[0,0])])])])]),"%s\n\n%s %s"]),a,u,vi(e[3]))));var e,t,u,a}function Zc(r,n,e,t,u,a){if(a){var i=a[0];return function(a){var c=[0],o=[t],f=[0],s=function(){var r,e,t,u;if(f[0]){var s=[l(n,o[0]),0],v=(r=a,e=i,t=c[0],u=s,zu(r,e,e.childNodes,0,t,u),u);return c[0]=v,f[0]=0,0}return 0},v=function(){for(;i.childNodes.length>0;){var r=i.firstChild;null!==r&&i.removeChild(r)}return 0},g=[0],m=function(r){var n=l(e,r);return g[0]=Xi(a,a,g[0],n),0};return[function(){return v(),Wa(a,u),m(o[0]),f[0]=[-1],s(),0},function(r){return Pu(l(n,r))},function(n,e){var t=h(r,n,e),u=t[0];return o[0]=u,Wa(a,t[1]),!f[0]&&(f[0]=[-1],s()),m(u),u},function(r){return f[0]=0,Wa(a,r),g[0]=Xi(a,a,g[0],0),c[0]=0,v(),0}]}}return function(a){var i=[0],c=function(r){var n=l(e,r);return i[0]=Xi(a,a,i[0],n),0};return[function(){return Wa(a,u),c(t),0},function(r){return Pu(l(n,r))},function(n,e){var t=h(r,n,e),u=t[0];return Wa(a,t[1]),c(u),u},function(r){return Wa(a,r),i[0]=Xi(a,a,i[0],0),0}]}}function zc(r,e,t){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var r=0,n=["ms","moz","webkit","o"],e=0;e<n.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,e){var t=(new Date).getTime(),u=Math.max(0,16-(t-r)),a=window.setTimeout(function(){n(t+u)},u);return r=t+u,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}();var u,a,i,c,o,f,s,v,g,m=l(r[0],t),b=m[0],w=null==e?0:[e],p=Zc(r[1],r[2],r[3],b,m[1],w);return u=b,a=p,i=r[4],c=[u],f=l(a,o=[[function(){return console.log("INVALID enqueue CALL!"),0}]]),s=[0],g=[v=function(r){var e=s[0];if(e)return s[0]=[[r,e[0]]],0;s[0]=[0];var t=h(f[2],c[0],r);c[0]=t;var u=s[0];if(u){var a=u[0];return a?(s[0]=0,Or(v,Fr(a))):(s[0]=0,0)}throw[n,"INVALID message queue state, should never be None during message processing!"]}],o[0]=g,l(f[0],0),{pushMsg:v,shutdown:function(){o[0]=[function(){return console.log("INVALID message enqueued when shut down"),0}];var r=l(i,c[0]);return l(f[3],r),0},getHtmlString:function(){return l(f[1],c[0])}}}var Hc,Wc=function(r,n){return y(4,[function(n){return[[function(e){return l(n[0][0],l(r,e))}]]},n])},Yc=lc[20](function(r,n,e,t,u){return[r,n,e,t,u]},lc[11]("keyCode",lc[3]),lc[11]("shiftKey",lc[5]),lc[11]("ctrlKey",lc[5]),lc[11]("altKey",lc[5]),lc[11]("metaKey",lc[5]));function Qc(r,n){var e,t,u,a=r?r[0]:"";return e="keydown",u=n,Vi(t=a,function(r){var n=[r],a=y(0,[t,function(r){var n=lc[31](Yc,r);return n.tag?0:[l(u,n[0])]}]),i=document,c=Uu(n,i,e,a);return function(){return Bu(i,e,c),0}})}function $c(r){return y(3,[r])}function ro(r){return y(4,[r])}function no(r,n){var e;switch(r[0]){case 0:e=ea(0,0,[ya(y(2,[n])),0],[Hu("move, computer!"),0]);break;case 1:e=Hu("Stockfish is thinking");break;case 2:e=Hu("loading Stockfish")}var t;return $u(0,0,0,[e,[ta(0,0,[sa("autoplay"),[ga("checkbox"),[ka(0,$c),[(t=r[3],t?y(0,["checked","checked"]):0),0]]]],0),[ua(0,0,[wa("autoplay"),0],[Hu("autoplay"),0]),[ta(0,0,[sa("depth"),[ga("number"),[ma("width","3em"),[ma("margin-left","1em"),[da(0,function(r){return Aa(er,ro,r)}),[ba(Cr(r[2])),[_a[1]("1"),[_a[0]("24"),0]]]]]]]],0),[ua(0,0,[wa("depth"),0],[Hu("strength"),0]),0]]]]])}function eo(r,n){var e=n[0];return y(2,[function(n){var t=Ti(Ei),u=l(e,t);return xi(Ei,t),l(n[0][0],l(r,u))}])}function to(r){return[r.href,r.protocol,r.host,r.hostname,r.port,r.pathname,r.search,r.hash,r.username,r.password,r.origin]}Hc=S(),Mi(Ei,Hc);var uo=[0];function ao(){var r=uo[0];if(r){var n=to(document.location);return l(r[0],n),0}return 0}function io(r){return Vi("navigation",function(n){uo[0]=[function(e){return l(n[0],l(r,e))}];var e,t,u,a=function(){return ao()};return e="popstate",t=a,u=0,window.addEventListener(e,t,u),function(){return r="popstate",n=a,e=0,window.removeEventListener(r,n,e);var r,n,e}})}function co(r){return y(2,[function(){var n,e,t,u,a,i;return n=r,e=window,t=JSON.parse("{}"),u="",a=n,void 0!==(i=e.history)&&i.replaceState(t,u,a),ao(),0}])}function oo(r){return y(2,[function(){var n,e,t,u,a,i;return n=r,e=window,t=JSON.parse("{}"),u="",a=n,void 0!==(i=e.history)&&i.pushState(t,u,a),ao(),0}])}function fo(r){return y(0,[r])}function so(r){return y(1,[r])}function vo(r){return y(2,[r])}function lo(r){return y(4,[r])}function ho(r){return y(5,[r])}function go(r){return y(6,[r])}function mo(r){return y(8,[r])}function bo(r){return y(9,[r])}var wo=[function(r){return r[0]},function(r,n){var e=n.slice();return e[0]=r,e}];function po(r,n){var e=l(xa[18],n[0])[0]+1|0;return[[g(xa[3],e,r,n[0]),Ui[3](wo,Oa[0](e)),n[2],n[3],n[4],n[5],n[6]],e]}function yo(r){var n=Jn(r[7].split("/"));if(!n)return y(0,[1]);if("#"!==n[0])return y(0,[1]);var e=n[1];if(!e)return y(0,[1]);switch(e[0]){case"":return e[1],y(0,[1]);case"game":var t=e[1];return t?t[1]?y(0,[1]):y(0,[er(t[0])]):y(0,[1]);case"lichess":var u=e[1];return u?u[1]?y(0,[1]):y(1,[u[0]]):y(0,[1]);case"tournament":return e[1]?y(0,[1]):0;default:return y(0,[1])}}function ko(r){return"number"==typeof r?"#/tournament":r.tag?l(xe([y(11,["#/lichess/",y(2,[0,0])]),"#/lichess/%s"]),r[0]):l(xe([y(11,["#/game/",y(4,[0,0,0,0])]),"#/game/%d"]),r[0])}function _o(r,n){if(C(r[2],n))return[r,Qa];if("number"==typeof n){var e=r.slice();return[(e[2]=0,e),Ha(y(2,[0]))]}if(!n.tag){var t=n[0];if(h(xa[2],t,r[0])){var a=Ui[3](wo,Oa[0](t));return[[r[0],a,n,r[3],r[4],r[5],r[6]],Qa]}var i=r.slice();return[(i[2]=y(0,[1]),i),co(ko(y(0,[1])))]}var c=n[0];try{var o=po(h(Ma[21],c,r[5]),r);return[o[0],co(ko(y(0,[o[1]])))]}catch(n){if(n===u)return[r,Ha(y(2,[y(1,[c])]))];throw n}}var Co=[g(xa[3],1,$a,xa[0]),Ui[3](wo,Oa[0](1)),y(0,[1]),[1,0],0,Ma[0],0];function No(r,n){return[Co,Fc(function(r){return y(7,[n,r])},jc)]}function Ao(r,t){var a,i,c,o,f,s,v,h=0;if("number"==typeof t)switch(t){case 0:var m,b=Ft(Ui[0](r,r[1])[0]);if("number"==typeof b)m=Qa;else if(b.tag){var w=b[0];m=eo(function(r){return y(3,[function(r,t){if(t<0)throw[e,"List.nth"];for(var u=r,a=t;;){var i=u;if(i){if(a){a=a-1|0,u=i[1];continue}return i[0]}throw[n,"nth"]}}(w,r)])},(o=0,f=Ar(w),[function(r){return o+Li[4](r,f)|0}]))}else m=Qa;return[r,m];case 1:return[Ui[1](r[1],$a,r),Qa];case 2:var p=po($a,r);return[p[0],oo(ko(y(0,[p[1]])))];case 3:return[r,Fc(mo,Oc((c=r[0],g(xa[10],function(r,n,e){return[Jc(Cr(r),n),e]},c,0))))];case 4:return[r,Dc[2](0)];case 5:var d=stockfish_loader(function(r){return y(9,[(n=r,y(0,[n]))]);var n});if(null==d)return console.log("Stockfish failed to load"),[r,Qa];var k=r.slice();return[(k[6]=[(i=d,[2,i,12,1])],k),Qa]}else switch(0|t.tag){case 0:var _=t[0];if(!_.tag){var N=function(r,n){if(n.tag)return[r,Qa];var e=n[0],t=r[1];if("number"==typeof e)return e?[[r[0],0],Qa]:[[_t(r[0]),r[1]],Qa];switch(0|e.tag){case 0:return[[r[0],y(0,[e[0]])],Qa];case 1:if("number"==typeof t)return[r,Qa];if(t.tag)return[r,Qa];var a=t[0].slice();return[[r[0],y(0,[(a[6]=e[0],a)])],Qa];case 2:if("number"==typeof t)return[r,Qa];if(t.tag)return[r,Qa];var i=t[0],c=i[2];if(!c)return[[r[0],0],Qa];var o=c[0];try{var f=qr(o,i[3]);return f?[[r[0],0],Ha(y(1,[f[0]]))]:[[r[0],y(1,[[i[0],i[1][0],o[0],i[7]]])],Qa]}catch(n){if(n===u)return[[r[0],0],Qa];throw n}break;case 3:if("number"==typeof t)return[r,Qa];if(t.tag)return[r,Qa];var s=t[0].slice();return[[r[0],y(0,[(s[2]=[e[0]],s)])],Qa];case 4:if("number"==typeof t)return[r,Qa];if(t.tag)return[r,Qa];var v=t[0].slice();return[[r[0],y(0,[(v[2]=0,v)])],Qa];case 5:if("number"==typeof t)return[r,Qa];if(t.tag){var l=t[0],h=y(1,[e[0],l[1],l[2]]);return[[r[0],0],Ha(y(1,[h]))]}return[r,Qa]}}(r[3],_),A=r.slice();return[(A[3]=N[0],A),Ya(fo,N[1])]}a=_[0],h=1;break;case 1:var S=gi(Ui[0](r,r[1]),t[0]);return[Ui[1](r[1],S[0],r),Ya(so,S[1])];case 2:var F=t[0],x=0;if("number"==typeof F)x=2;else{if(2===F.tag){var M=F[1],O=F[0];if(M.tag)return alert(l(xe([y(11,["Game ",y(2,[0,y(11,[" could not be loaded!",0])])]),"Game %s could not be loaded!"]),O)),[r,Qa];var T=hi(M[0]);if(T){var I=T[0],q=g(Ma[3],O,I,r[5]),D=r.slice(),E=po(I,(D[5]=q,D));return[E[0],co(ko(y(0,[E[1]])))]}return alert("Game could not be parsed!"),[r,Qa]}x=2}if(2===x){var L=Xc(r[4],F),P=r.slice();return[(P[4]=L[0],P),Ya(vo,L[1])]}break;case 3:a=t[0],h=1;break;case 4:var R,U=t[0],B=U[2],V=U[0],X=0;if(0!==B){var G=V-66|0;if(G>16||G<0)X=2;else switch(G){case 0:R=Ha(y(1,[0]));break;case 4:R=Ha(y(1,[1]));break;case 12:R=Ha(2);break;case 1:case 2:case 3:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:X=2;break;case 16:R=Ha(0)}}else X=2;if(2===X){var K=V-37|0;if(K>2||K<0)R=Qa;else switch(K){case 0:R=Ha(y(1,[0]));break;case 1:R=Qa;break;case 2:R=Ha(y(1,[1]))}}return[r,R];case 5:var j=t[0];return 0!==j?[r,oo(ko(y(0,[j])))]:[r,oo("#/tournament")];case 6:return _o(r,yo(t[0]));case 7:var J=t[1],Z=t[0];if(J.tag)return alert(l(xe([y(11,["games couldn't be restored because of error ",y(2,[0,0])]),"games couldn't be restored because of error %s"]),J[0])),_o(r,yo(Z));var z,H=J[0];if(C(H,xa[0]))z=r;else{var W=r.slice();W[0]=H,z=W}return _o(z,yo(Z));case 8:var Y=t[0];return Y.tag?(alert(l(xe([y(11,["games couldn't be saved because of error ",y(2,[0,0])]),"games couldn't be saved because of error %s"]),Y[0])),[r,Qa]):(alert("games successfully saved"),[r,Qa]);case 9:var Q=t[0],$=0;if("number"==typeof Q)$=2;else if(1===Q.tag)try{var rr=xu(Ui[0](r,r[1])[0],Q[0][0]),nr=gi(Ui[0](r,r[1]),y(0,[rr]));return[Ui[1](r[1],nr[0],r),Ya(so,nr[1])]}catch(n){if(n===At)return[r,Qa];throw n}else $=2;if(2===$){var er=r[6];if(er){var tr=function(r,n){if("number"==typeof n)return[r,Qa];switch(0|n.tag){case 0:var e=n[0];console.log(e);var t=pn(pn(pn(Un("bestmove"),Rn(Nn(Pn))),Un("bestmoveSan")),lu()),u=function(r){return ln(t,function(r){var n=[r];return pn(Sn(32),function(r){return vn(n,r)})},r)},a=pn(Un("Stockfish"),function(r){return vn(0,r)}),i=sn(function(r){return hn(a,u,r)},on[2](e));if(i){var c=i[0];return c?[[0,r[1],r[2],r[3]],Ha(y(1,[c[0]]))]:[[0,r[1],r[2],r[3]],Ha(0)]}return[r,Qa];case 1:return[r,Qa];case 2:return r[1].postMessage("position fen "+n[0]),r[1].postMessage(l(xe([y(11,["go depth ",y(4,[0,0,0,0])]),"go depth %d"]),r[2])),[[1,r[1],r[2],r[3]],Qa];case 3:return[[r[0],r[1],r[2],n[0]],Qa];case 4:return[[r[0],r[1],n[0],r[3]],Qa]}}(er[0],Q),ur=r.slice();return[(ur[6]=[tr[0]],ur),Ya(bo,tr[1])]}return[r,Qa]}}if(1===h){var ar=gi(Ui[0](r,r[1]),y(0,[a])),ir=ar[0],cr=r[6],or=Ft(ir[0]),fr=cr&&"number"!=typeof or&&or.tag&&cr[0][3]?Ha(y(9,[(v=kt[1](ir[0]),y(2,[v]))])):Qa;return[Ui[1](r[1],ir,r),(s=[Ya(so,ar[1]),[fr,0]],y(1,[s]))]}}function So(r,n,e){return ia(0,0,[(r?r[0]:0)?la("home"):Na,0],[ra(0,0,[va(n),0],[Hu(e),0]),0])}var Fo=fa(0,0,[sa("main-nav"),0],[aa(0,0,0,[So([1],"#/","TEA-Chess"),[So(0,"https://quernd.github.io/tutorials/tea-chess","Tutorial"),[So(0,"https://github.com/quernd/tea-chess","Code"),0]]]),0]);function xo(r){var n,e=r[2];n="number"==typeof e||e.tag?0:[e[0]];var t,u,a,i,c=Fr(g(xa[10],function(r,e,t){return[oa(0,0,[ba(Cr(r)),[_a[4](C(n,[r])),0]],[Hu(l(xe([y(11,["Game ",y(4,[0,0,0,0])]),"Game %d"]),r)),0]),t]},r[0],0));return t=0,u=0,a=[da(0,function(r){return Aa(er,ho,r)}),0],i=[oa(0,0,[ba("0"),[_a[4](+(0===r[2])),0]],[Hu("Tournament"),0]),c],Du("","select",t?t[0]:"",u?u[0]:"",a,i)}function Mo(r){var n,e=Ui[0](r,r[1]),t=e[0],u=Ft(t);n="number"!=typeof u&&u.tag?[t[1],u[0]]:0;var a,i=r[6];if(i){var c=i[0],o=0;0!==c[0]||n?o=1:a=function(r){var n,e=Ft(r);if("number"==typeof e)n="It's a draw!";else if(e.tag){var t=r[1];n=h(xe([y(11,["It is ",y(2,[0,y(11,["'s move,  ",y(4,[0,0,0,y(11,[" legal moves",0])])])])]),"It is %s's move,  %d legal moves"]),0!==t?"White":"Black",Ar(e[0]))}else n=0!==e[0]?"White wins by checkmate!":"Black wins by checkmate!";return $u(0,0,0,[Hu(n),0])}(t),1===o&&(a=Wc(bo,no(c,kt[1](e[0]))))}else a=$u(0,0,0,[Ta(5,"load Stockfish"),0]);var f,s,v,l,g,m=r[2];return f="number"==typeof m?Wc(vo,Gc(r[4])):m.tag?Ca:Wc(so,bi(e)),s=0,v=0,l=0,g=[na(0,0,[sa("board"),0],[Fo,[Wc(fo,Nc(n,t[0],r[3])),[$u(0,0,0,[Wc(fo,yc),[Ta(0,"Random move!"),[Ta(y(1,[0]),"Take back"),0]]]),[a,0]]]]),[na(0,0,[sa("game"),0],[fa(0,0,0,[aa(0,0,0,[ia(0,0,0,[xo(r),[Ta(1,"reset game"),[Ta(2,"new game"),[Ta(3,"save games"),[Ta(4,"clear storage"),0]]]]]),0]),0]),[Yu(0,0,[la("scroll"),0],[f,0]),0]]),0]],Du("","main",s?s[0]:"",v?v[0]:"",l,g)}function Oo(r){return Bi([(n=fo,e=Ac(r[3]),y(2,[function(r){return[[function(e){return l(r[0][0],l(n,e))}]]},e])),[Qc(0,lo),0]]);var n,e}var To,Io,qo,Do=(To=go,qo=[function(r){return h(Io[0],r,to(document.location))},(Io=[No,Ao,Mo,Oo,function(){return Qa}])[1],Io[2],function(r){return y(0,[[io(To),[l(Io[3],r),0]]])},Io[4]],function(r,n){return zc(qo,r,n)});return r.board_msg=fo,r.game_msg=so,r.lichess_msg=vo,r.random_button=0,r.random_move=function(r){return y(3,[r])},r.key_pressed=lo,r.reset_game=1,r.switch_game=ho,r.new_game=2,r.location_changed=go,r.save_games=3,r.clear_games=4,r.games_loaded=function(r,n){return y(7,[r,n])},r.games_saved=mo,r.load_stockfish=5,r.stockfish_msg=bo,r.games_lens=wo,r.add_game_update_lens=po,r.route_of_location=yo,r.location_of_route=ko,r.update_route=_o,r.init_model=Co,r.init=No,r.update=Ao,r.header_nav_view=Fo,r.games_picker=xo,r.view=Mo,r.subscriptions=Oo,r.main=Do,r}({});
